!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.irSpectrum=r():t.irSpectrum=r()}("undefined"!=typeof self?self:this,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(r){return t[r]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=20)}([function(t,r,e){"use strict";(function(t){var n,o,i,a;e.d(r,"a",function(){return s}),e.d(r,"b",function(){return u}),e.d(r,"c",function(){return h}),e.d(r,"d",function(){return f}),e.d(r,"j",function(){return l}),e.d(r,"f",function(){return c}),e.d(r,"g",function(){return m}),e.d(r,"e",function(){return g}),e.d(r,"h",function(){return p}),e.d(r,"i",function(){return v}),e.d(r,"k",function(){return d}),e.d(r,"l",function(){return w}),e.d(r,"m",function(){return y});var s="~",u=void 0!==t&&"function"==typeof t.from,h="function"==typeof Uint16Array,f=/\[object (HTML(.*)Element)\]/,l=/\[object (SVG(.*)Element)\]/,c=["Arguments","Array","ArrayBuffer","Boolean","DataView","Date","DocumentFragment","Error","Event","Float32Array","Float64Array","Function","Generator","GeneratorFunction","HTMLElement","Int8Array","Int16Array","Int32Array","Map","Null","Number","Object","Promise","RegExp","Set","String","Symbol","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","Undefined","WeakMap","WeakSet","Window"].reduce(function(t,r){return t["[object "+r+"]"]=r,t},{}),m=Object.keys(c).reduce(function(t,r){return t[c[r].toUpperCase()]=r,t},{}),g={"[object Map]":!0,"[object Set]":!0},p={boolean:!0,function:!0,number:!0,string:!0,undefined:!0},v=((n={})[m.ARGUMENTS]=!0,n[m.ARRAY]=!0,n),d=((o={})[m.REGEXP]=!0,o[m.SYMBOL]=!0,o),w=((i={})[m.FLOAT32ARRAY]=!0,i[m.FLOAT64ARRAY]=!0,i[m.INT8ARRAY]=!0,i[m.INT16ARRAY]=!0,i[m.INT32ARRAY]=!0,i[m.UINT8ARRAY]=!0,i[m.UINT8CLAMPEDARRAY]=!0,i[m.UINT16ARRAY]=!0,i[m.UINT32ARRAY]=!0,i),y=((a={})[m.GENERATOR]=!0,a[m.PROMISE]=!0,a[m.WEAKMAP]=!0,a[m.WEAKSET]=!0,a)}).call(this,e(17).Buffer)},function(t,r,e){"use strict";e(32);var n=e(12),o=e(7);class i extends(n(Array)){constructor(t,r){var e;if(1===arguments.length&&"number"==typeof t)return new Array(t);if(i.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(super(t),!(Number.isInteger(r)&&r>0))throw new TypeError("nColumns must be a positive integer");for(e=0;e<t;e++)this[e]=new Array(r)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const n=t;if(t=n.length,"number"!=typeof(r=n[0].length)||0===r)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),e=0;e<t;e++){if(n[e].length!==r)throw new RangeError("Inconsistent array dimensions");this[e]=[].concat(n[e])}}}return this.rows=t,this.columns=r,this}set(t,r,e){return this[t][r]=e,this}get(t,r){return this[t][r]}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(r,e,this.get(r,e));return t}removeRow(t){if(o.checkRowIndex(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,r){return void 0===r&&(r=t,t=this.rows),o.checkRowIndex(this,t,!0),r=o.checkRowVector(this,r,!0),this.splice(t,0,r),this.rows+=1,this}removeColumn(t){if(o.checkColumnIndex(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var r=0;r<this.rows;r++)this[r].splice(t,1);return this.columns-=1,this}addColumn(t,r){void 0===r&&(r=t,t=this.columns),o.checkColumnIndex(this,t,!0),r=o.checkColumnVector(this,r);for(var e=0;e<this.rows;e++)this[e].splice(t,0,r[e]);return this.columns+=1,this}}r.Matrix=i,i.abstractMatrix=n},function(t,r,e){"use strict";var n=e(12),o=e(1);t.exports=class extends(n()){constructor(t,r,e){super(),this.matrix=t,this.rows=r,this.columns=e}static get[Symbol.species](){return o.Matrix}}},function(t,r,e){"use strict";const n=Object.prototype.toString;t.exports=function(t){return n.call(t).endsWith("Array]")}},function(t,r,e){!function(t){"use strict";var r="function"==typeof Symbol?Symbol("curriable placeholder"):60881,e=function(t,e){void 0===e&&(e=t.length);var n=function t(e,n,o){return function(){var i,a=o.length,s=arguments,u=s.length,h=[],f=0,l=n;if(a)for(var c=0;c<a;c++)h[c]=i=o[c]===r&&f<u?s[f++]:o[c],i!==r&&--l;if(f<u)for(;f<u;f++)h[h.length]=i=s[f],i!==r&&f<n&&--l;return l>0?t(e,n,h):e.apply(this,h)}}(t,e,[]);return n.arity=e,n.fn=t,n};e.__=r;var n=function(t){return t.fn};e.uncurry=n,t.__=r,t.curry=e,t.uncurry=n,t.default=e,Object.defineProperty(t,"__esModule",{value:!0})}(r)},function(t,r,e){"use strict";t.exports=e(1).Matrix,t.exports.Decompositions=t.exports.DC=e(45)},function(t,r,e){"use strict";r.array=e(15),r.matrix=e(35)},function(t,r,e){"use strict";var n=e(1);r.checkRowIndex=function(t,r,e){var n=e?t.rows:t.rows-1;if(r<0||r>n)throw new RangeError("Row index out of range")},r.checkColumnIndex=function(t,r,e){var n=e?t.columns:t.columns-1;if(r<0||r>n)throw new RangeError("Column index out of range")},r.checkRowVector=function(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return r},r.checkColumnVector=function(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return r},r.checkIndices=function(t,r,e){var n=r.some(r=>r<0||r>=t.rows),o=e.some(r=>r<0||r>=t.columns);if(n||o)throw new RangeError("Indices are out of range");if("object"!=typeof r||"object"!=typeof e)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(r)||(r=Array.from(r)),Array.isArray(e)||(r=Array.from(e)),{row:r,column:e}},r.checkRange=function(t,r,e,n,o){if(5!==arguments.length)throw new TypeError("Invalid argument type");if(Array.from(arguments).slice(1).some(function(t){return"number"!=typeof t}))throw new TypeError("Invalid argument type");if(r>e||n>o||r<0||r>=t.rows||e<0||e>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")},r.getRange=function(t,r){for(var e=new Array(r-t+1),n=0;n<e.length;n++)e[n]=t+n;return e},r.sumByRow=function(t){for(var r=n.Matrix.zeros(t.rows,1),e=0;e<t.rows;++e)for(var o=0;o<t.columns;++o)r.set(e,0,r.get(e,0)+t.get(e,o));return r},r.sumByColumn=function(t){for(var r=n.Matrix.zeros(1,t.columns),e=0;e<t.rows;++e)for(var o=0;o<t.columns;++o)r.set(0,o,r.get(0,o)+t.get(e,o));return r},r.sumAll=function(t){for(var r=0,e=0;e<t.rows;e++)for(var n=0;n<t.columns;n++)r+=t.get(e,n);return r}},function(t,r,e){"use strict";r.hypotenuse=function(t,r){var e;return Math.abs(t)>Math.abs(r)?(e=r/t,Math.abs(t)*Math.sqrt(1+e*e)):0!==r?(e=t/r,Math.abs(r)*Math.sqrt(1+e*e)):0},r.getEmpty2DArray=function(t,r){for(var e=new Array(t),n=0;n<t;n++)e[n]=new Array(r);return e},r.getFilled2DArray=function(t,r,e){for(var n=new Array(t),o=0;o<t;o++){n[o]=new Array(r);for(var i=0;i<r;i++)n[o][i]=e}return n}},function(t,r,e){"use strict";(function(t){e.d(r,"a",function(){return h}),e.d(r,"b",function(){return x});var n=e(19),o=e(0),i=String.prototype.charCodeAt,a=Object.prototype.toString,s=Object.keys,u=function(){return o.a},h=function(t){for(var r,e=t.length,n=5381,o=52711;e--;)n=33*n^(r=i.call(t,e)),o=33*o^r;return 4096*(n>>>0)+(o>>>0)},f=function(t,r){return t>r},l=function(t,r){return f(t[0],r[0])},c=function(t,r){return t+"|"+r},m=function(t,r){for(var e,n,o=0;o<t.length;o++){for(n=t[o],e=o-1;~e&&r(t[e],n);e--)t[e+1]=t[e];t[e+1]=n}return t},g=function(t){return String.fromCharCode.apply(null,new Uint16Array(t))},p=function(r){return t.from(r).toString("utf8")},v=function(){return""},d=o.b?p:o.c?g:v,w=function(t,r){for(var e=0;e<t.length;e++)if(t[e]===r)return e;return-1},y=function(t,r,e){if(void 0===e){var n=typeof t;if("string"===n)return t;if(o.h[n])return c(n,t);if(null===t)return c("null",t)}var i,u=e||a.call(t);return o.i[u]?t:u===o.g.OBJECT?~w(r,t)?o.a:(r.push(t),function(t){for(var r,e=m(s(t),f),n={},o=0;o<e.length;o++)n[r=e[o]]=t[r];return n}(t)):o.k[u]?c(o.f[u],t.toString()):o.e[u]?~w(r,t)?o.a:(r.push(t),function(t){var r="function"==typeof t.get,e=[];t.forEach(function(t,n){e.push(r?[x(n),x(t)]:[x(t)])}),m(e,l);for(var n,o,i=new Array(t.size),a=0;a<t.size;a++)n=e[a],i[a]=r?"["+n[0]+","+n[1]+"]":n[0];return c((o=t.constructor).name||(o.toString().match(/^\s*function\s*([^\(]*)/i)||[])[1]||"anonymous","["+i.join(",")+"]")}(t)):u===o.g.DATE?c(o.f[u],t.getTime()):u===o.g.ERROR?c(o.f[u],t.stack):u===o.g.EVENT?{bubbles:(i=t).bubbles,cancelBubble:i.cancelBubble,cancelable:i.cancelable,composed:i.composed,currentTarget:i.currentTarget,defaultPrevented:i.defaultPrevented,eventPhase:i.eventPhase,isTrusted:i.isTrusted,returnValue:i.returnValue,target:i.target,type:i.type}:o.m[u]?c(o.f[u],"NOT_ENUMERABLE"):o.d.test(u)||o.j.test(u)?c(u.slice(8,-1),t.outerHTML):u===o.g.DOCUMENTFRAGMENT?c(o.f[u],function(t){for(var r=t.children,e="",n=0;n<r.length;n++)e+=r[n].outerHTML;return e}(t)):o.l[u]?c(o.f[u],t.join(",")):u===o.g.ARRAYBUFFER?c(o.f[u],d(t)):u===o.g.DATAVIEW?c(o.f[u],d(t.buffer)):t},b=function(t){return function(r,e){return y(e,t)}};function x(t){if(!t||"object"!=typeof t)return y(t);var r=a.call(t);return r===o.g.DATE||r===o.g.REGEXP?y(t,void 0,r):Object(n.a)(t,b([]),null,u)}}).call(this,e(17).Buffer)},function(t,r,e){"use strict";function n(t,r){return t-r}r.sum=function(t){for(var r=0,e=0;e<t.length;e++)r+=t[e];return r},r.max=function(t){for(var r=-1/0,e=t.length,n=0;n<e;n++)t[n]>r&&(r=t[n]);return r},r.min=function(t){for(var r=1/0,e=t.length,n=0;n<e;n++)t[n]<r&&(r=t[n]);return r},r.minMax=function(t){for(var r=1/0,e=-1/0,n=t.length,o=0;o<n;o++)t[o]<r&&(r=t[o]),t[o]>e&&(e=t[o]);return{min:r,max:e}},r.arithmeticMean=function(t){for(var r=0,e=t.length,n=0;n<e;n++)r+=t[n];return r/e},r.mean=r.arithmeticMean,r.geometricMean=function(t){for(var r=1,e=t.length,n=0;n<e;n++)r*=t[n];return Math.pow(r,1/e)},r.logMean=function(t){for(var r=0,e=t.length,n=0;n<e;n++)r+=Math.log(t[n]);return r/e},r.grandMean=function(t,r){for(var e=0,n=0,o=t.length,i=0;i<o;i++)e+=r[i]*t[i],n+=r[i];return e/n},r.truncatedMean=function(t,r,e){void 0===e&&(e=!1),e||(t=t.slice().sort(n));for(var o=t.length,i=Math.floor(o*r),a=0,s=i;s<o-i;s++)a+=t[s];return a/(o-2*i)},r.harmonicMean=function(t){for(var r=0,e=t.length,n=0;n<e;n++){if(0===t[n])throw new RangeError("value at index "+n+"is zero");r+=1/t[n]}return e/r},r.contraHarmonicMean=function(t){for(var r=0,e=0,n=t.length,o=0;o<n;o++)r+=t[o]*t[o],e+=t[o];if(e<0)throw new RangeError("sum of values is negative");return r/e},r.median=function(t,r){void 0===r&&(r=!1),r||(t=t.slice().sort(n));var e=t.length,o=Math.floor(e/2);return e%2==0?.5*(t[o-1]+t[o]):t[o]},r.variance=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=0,i=t.length,a=0;a<i;a++){var s=t[a]-n;o+=s*s}return e?o/(i-1):o/i},r.standardDeviation=function(t,e){return Math.sqrt(r.variance(t,e))},r.standardError=function(t){return r.standardDeviation(t)/Math.sqrt(t.length)},r.quartiles=function(t,e){void 0===e&&(e=!1),e||(t=t.slice()).sort(n);var o=t.length/4;return{q1:t[Math.ceil(o)-1],q2:r.median(t,!0),q3:t[Math.ceil(3*o)-1]}},r.pooledStandardDeviation=function(t,e){return Math.sqrt(r.pooledVariance(t,e))},r.pooledVariance=function(t,e){void 0===e&&(e=!0);for(var n=0,o=0,i=t.length,a=0;a<i;a++){var s=t[a],u=r.variance(s);n+=(s.length-1)*u,o+=e?s.length-1:s.length}return n/o},r.mode=function(t){var r,e=t.length,n=new Array(e);for(r=0;r<e;r++)n[r]=0;var o=new Array(e),i=0;for(r=0;r<e;r++){var a=o.indexOf(t[r]);a>=0?n[a]++:(o[i]=t[r],n[i]=1,i++)}var s=0,u=0;for(r=0;r<i;r++)n[r]>s&&(s=n[r],u=r);return o[u]},r.covariance=function(t,e,n){void 0===n&&(n=!0);var o=r.mean(t),i=r.mean(e);if(t.length!==e.length)throw"Vectors do not have the same dimensions";for(var a=0,s=t.length,u=0;u<s;u++){a+=(t[u]-o)*(e[u]-i)}return n?a/(s-1):a/s},r.skewness=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=0,i=0,a=t.length,s=0;s<a;s++){var u=t[s]-n;o+=u*u,i+=u*u*u}var h=o/a,f=i/a/Math.pow(h,1.5);return e?Math.sqrt(a*(a-1))/(a-2)*f:f},r.kurtosis=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=t.length,i=0,a=0,s=0;s<o;s++){var u=t[s]-n;i+=u*u,a+=u*u*u*u}var h=i/o;if(e){var f=i/(o-1);return o*(o+1)/((o-1)*(o-2)*(o-3))*(a/(f*f))-3*((o-1)*(o-1)/((o-2)*(o-3)))}return a/o/(h*h)-3},r.entropy=function(t,r){void 0===r&&(r=0);for(var e=0,n=t.length,o=0;o<n;o++)e+=t[o]*Math.log(t[o]+r);return-e},r.weightedMean=function(t,r){for(var e=0,n=t.length,o=0;o<n;o++)e+=t[o]*r[o];return e},r.weightedStandardDeviation=function(t,e){return Math.sqrt(r.weightedVariance(t,e))},r.weightedVariance=function(t,e){for(var n=r.weightedMean(t,e),o=0,i=t.length,a=0,s=0,u=0;u<i;u++){var h=t[u]-n,f=e[u];o+=f*(h*h),s+=f,a+=f*f}return o*(s/(s*s-a))},r.center=function(t,e){void 0===e&&(e=!1);var n=t;e||(n=t.slice());for(var o=r.mean(n),i=n.length,a=0;a<i;a++)n[a]-=o},r.standardize=function(t,e,n){void 0===e&&(e=r.standardDeviation(t)),void 0===n&&(n=!1);for(var o=t.length,i=n?t:new Array(o),a=0;a<o;a++)i[a]=t[a]/e;return i},r.cumulativeSum=function(t){var r=t.length,e=new Array(r);e[0]=t[0];for(var n=1;n<r;n++)e[n]=e[n-1]+t[n];return e}},function(t,r,e){"use strict";var n=e(30),o=n.Matrix.algebra,i=e(5);function a(t,r,e){var n,o,a,s,u=r.length/3,h=t.rows,f=i.zeros(t.length,1);for(o=0;o<u;o++)for(s=Math.pow(r[o+2*u][0]/2,2),n=r[o+u][0]*s,a=0;a<h;a++)f[a][0]+=n/(Math.pow(t[a][0]-r[o][0],2)+s);return f}function s(t,r,e){for(var n=r[1][0]*Math.pow(r[2][0]/2,2),o=t.rows,a=new i(t.rows,t.columns),s=0;s<o;s++)a[s][0]=n/(Math.pow(t[s][0]-r[0][0],2)+Math.pow(r[2][0]/2,2));return a}function u(t,r,e){for(var n=r[2][0]*r[2][0]/2,o=t.rows,a=new i(t.rows,t.columns),s=0;s<o;s++)a[s][0]=r[1][0]*Math.exp(-(t[s][0]-r[0][0])*(t[s][0]-r[0][0])/n);return a}function h(t,r,e){var o=l(t,(e=e||{}).percentage||0);if(null===o||o[0].rows<3)return null;var a=o[0],u=o[1],h=o[2],f=[a.rows/Math.sqrt(u.dot(u))],c=(e=Object.create(e.LMOptions||[3,100,.001,.001,.001,.01,.01,11,9,1]),Math.abs(a[0][0]-a[1][0])),m=new i([[-c/1e4],[-.001],[-c/1e4]]),g=new i([[r.x],[1],[r.width]]),p=new i([[r.x-c],[.75],[r.width/4]]),v=new i([[r.x+c],[1.25],[4*r.width]]),d=n.optimize(s,g,a,u,f,m,p,v,[],e);return[(d=d.p)[0],[d[1][0]*h],d[2]]}function f(t,r,e){var o=l(t,(e=e||{}).percentage||0);if(null===o||o[0].rows<3)return null;var a=o[0],s=o[1],h=o[2],f=[a.rows/Math.sqrt(s.dot(s))],c=(e=Object.create(e.LMOptions||[3,100,.001,.001,.001,.01,.01,11,9,1]),Math.abs(a[0][0]-a[1][0])),m=new i([[-c/1e4],[-.001],[-c/1e4]]),g=(m=new i([[-Math.abs(a[0][0]-a[1][0])/1e3],[-.001],[-r.width/1e3]]),new i([[r.x],[1],[r.width]])),p=new i([[r.x-c],[.75],[r.width/4]]),v=new i([[r.x+c],[1.25],[4*r.width]]),d=n.optimize(u,g,a,s,f,m,p,v,[],e);return[(d=d.p)[0],[d[1][0]*h],d[2]]}function l(t,r){var e,n,o,a=t.length,s=null,u=null,h=0;if(2==a){var f=t[0].length;if(s=new Array(f),u=new Array(f),e=t[0],n=t[1],"number"==typeof e[0])for(o=0;o<f;o++)s[o]=e[o],u[o]=n[o],n[o]>h&&(h=n[o]);else if("object"==typeof e[0])for(o=0;o<f;o++)s[o]=e[o][0],u[o]=n[o][0],n[o][0]>h&&(h=n[o][0])}else{f=a;for(s=new Array(f),u=new Array(f),o=0;o<f;o++)s[o]=t[o][0],u[o]=t[o][1],u[o]>h&&(h=u[o])}for(o=0;o<f;o++)u[o]/=h;if(r)for(o=f-1;o>=0;o--)u[o]<r&&(u.splice(o,1),s.splice(o,1));return s.length>0?[new i([s]).transpose(),new i([u]).transpose(),h]:null}t.exports.optimizeSingleLorentzian=h,t.exports.optimizeLorentzianSum=function(t,r,e){var s=l(t);if(null===s||s[0].rows<3)return null;var u,h=s[0],f=s[1],c=s[2],m=[h.rows/o.sqrt(f.dot(f))],g=(e=Object.create(e||[3,100,.001,.001,.001,.01,.01,11,9,1]),r.length),p=new i(3*g,1),v=new i(3*g,1),d=new i(3*g,1),w=new i(3*g,1),y=Math.abs(h[0][0]-h[1][0]);for(u=0;u<g;u++)p[u][0]=r[u].x,p[u+g][0]=1,p[u+2*g][0]=r[u].width,v[u][0]=r[u].x-y,v[u+g][0]=0,v[u+2*g][0]=r[u].width/4,d[u][0]=r[u].x+y,d[u+g][0]=1.5,d[u+2*g][0]=4*r[u].width,w[u][0]=-y/1e3,w[u+g][0]=-.001,w[u+2*g][0]=-y/1e3;w=-Math.abs(h[0][0]-h[1][0])/1e4;var b=n.optimize(a,p,h,f,m,w,v,d,[],e);b=b.p;var x=new Array(g);for(u=0;u<g;u++)x[u]=[b[u],[b[u+g][0]*c],b[u+2*g]];return x},t.exports.optimizeSingleGaussian=f,t.exports.optimizeGaussianSum=function(t,r,e){var s=l(t);if(null===s||s[0].rows<3)return null;var u,h=s[0],f=s[1],c=s[2],m=h.rows,g=new i(m,1),p=m/o.sqrt(f.dot(f));for(u=0;u<m;u++)g[u][0]=p;e=Object.create(e||[3,100,.001,.001,.001,.01,.01,11,9,2]);var v=r.length,d=new i(3*v,1),w=new i(3*v,1),y=new i(3*v,1),b=new i(3*v,1),x=Math.abs(h[0][0]-h[1][0]);for(u=0;u<v;u++)d[u][0]=r[u].x,d[u+v][0]=r[u].y/c,d[u+2*v][0]=r[u].width,w[u][0]=r[u].x-x,w[u+v][0]=.8*r[u].y/c,w[u+2*v][0]=r[u].width/2,y[u][0]=r[u].x+x,y[u+v][0]=1.2*r[u].y/c,y[u+2*v][0]=2*r[u].width,b[u][0]=-x/1e3,b[u+v][0]=-.001,b[u+2*v][0]=-x/1e3;var M=n.optimize(a,d,h,f,g,b,w,y,[],e);M=M.p;var A=new Array(v);for(u=0;u<v;u++)A[u]=[M[u],[M[u+v][0]*c],M[u+2*v]];return A},t.exports.singleGaussian=u,t.exports.singleLorentzian=s,t.exports.optimizeGaussianTrain=function(t,r,e){var n=l(t);if(null===n||n[0].rows<3)return null;for(var o,i,a,s,u=n[0],h=n[1],c=n[2],m=0,g=u.length,p=[],v=0;v<r.length;v++){for(o=r[v].x-1.5*r[v].width;u[m++]<o&&m<g;);for(o=r[v].x+1.5*r[v].width,i=[],a=[];u[m]<=o&&m<g;)i.push(u[m][0]),a.push(h[m][0]*c),m++;(s=f([i,a],r[v],e))?p.push({x:s[0][0],y:s[1][0],width:s[2][0],opt:!0}):p.push({x:r[v].x,y:r[v].y,width:r[v].width,opt:!1})}return p},t.exports.optimizeLorentzianTrain=function(t,r,e){var n=l(t);if(null===n||n[0].rows<3)return null;for(var o,i,a,s,u=n[0],f=n[1],c=n[2],m=0,g=u.length,p=[],v=0;v<r.length;v++){for(o=r[v].x-1.5*r[v].width;u[m++]<o&&m<g;);for(o=r[v].x+1.5*r[v].width,i=[],a=[];u[m]<=o&&m<g;)i.push(u[m][0]),a.push(f[m][0]*c),m++;(s=h([i,a],r[v],e))?p.push({x:s[0][0],y:s[1][0],width:s[2][0],opt:!0}):p.push({x:r[v].x,y:r[v].y,width:r[v].width,opt:!1})}return p}},function(module,exports,__webpack_require__){"use strict";module.exports=abstractMatrix;var LuDecomposition=__webpack_require__(13),SvDecomposition=__webpack_require__(14),arrayUtils=__webpack_require__(33),util=__webpack_require__(7),MatrixTransposeView=__webpack_require__(38),MatrixRowView=__webpack_require__(39),MatrixSubView=__webpack_require__(40),MatrixSelectionView=__webpack_require__(41),MatrixColumnView=__webpack_require__(42),MatrixFlipRowView=__webpack_require__(43),MatrixFlipColumnView=__webpack_require__(44);function abstractMatrix(superCtor){void 0===superCtor&&(superCtor=Object);class Matrix extends superCtor{static get[Symbol.species](){return this}static from1DArray(t,r,e){if(t*r!==e.length)throw new RangeError("Data length does not match given dimensions");for(var n=new this(t,r),o=0;o<t;o++)for(var i=0;i<r;i++)n.set(o,i,e[o*r+i]);return n}static rowVector(t){for(var r=new this(1,t.length),e=0;e<t.length;e++)r.set(0,e,t[e]);return r}static columnVector(t){for(var r=new this(t.length,1),e=0;e<t.length;e++)r.set(e,0,t[e]);return r}static empty(t,r){return new this(t,r)}static zeros(t,r){return this.empty(t,r).fill(0)}static ones(t,r){return this.empty(t,r).fill(1)}static rand(t,r,e){void 0===e&&(e=Math.random);for(var n=this.empty(t,r),o=0;o<t;o++)for(var i=0;i<r;i++)n.set(o,i,e());return n}static randInt(t,r,e,n){void 0===e&&(e=1e3),void 0===n&&(n=Math.random);for(var o=this.empty(t,r),i=0;i<t;i++)for(var a=0;a<r;a++){var s=Math.floor(n()*e);o.set(i,a,s)}return o}static eye(t,r,e){void 0===r&&(r=t),void 0===e&&(e=1);for(var n=Math.min(t,r),o=this.zeros(t,r),i=0;i<n;i++)o.set(i,i,e);return o}static diag(t,r,e){var n=t.length;void 0===r&&(r=n),void 0===e&&(e=r);for(var o=Math.min(n,r,e),i=this.zeros(r,e),a=0;a<o;a++)i.set(a,a,t[a]);return i}static min(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,n=t.columns,o=new this(e,n),i=0;i<e;i++)for(var a=0;a<n;a++)o.set(i,a,Math.min(t.get(i,a),r.get(i,a)));return o}static max(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,n=t.columns,o=new this(e,n),i=0;i<e;i++)for(var a=0;a<n;a++)o.set(i,a,Math.max(t.get(i,a),r.get(i,a)));return o}static checkMatrix(t){return Matrix.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var r=this.rows,e=this.columns,n=0;n<r;n++)for(var o=0;o<e;o++)t.call(this,n,o);return this}to1DArray(){for(var t=new Array(this.size),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t[r*this.columns+e]=this.get(r,e);return t}to2DArray(){for(var t=new Array(this.rows),r=0;r<this.rows;r++){t[r]=new Array(this.columns);for(var e=0;e<this.columns;e++)t[r][e]=this.get(r,e)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var r=0;r<=t;r++)if(this.get(t,r)!==this.get(r,t))return!1;return!0}return!1}set(t,r,e){throw new Error("set method is unimplemented")}get(t,r){throw new Error("get method is unimplemented")}repeat(t,r){t=t||1,r=r||1;for(var e=new this.constructor[Symbol.species](this.rows*t,this.columns*r),n=0;n<t;n++)for(var o=0;o<r;o++)e.setSubMatrix(this,this.rows*n,this.columns*o);return e}fill(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,t);return this}neg(){return this.mulS(-1)}getRow(t){util.checkRowIndex(this,t);for(var r=new Array(this.columns),e=0;e<this.columns;e++)r[e]=this.get(t,e);return r}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,r){util.checkRowIndex(this,t),r=util.checkRowVector(this,r);for(var e=0;e<this.columns;e++)this.set(t,e,r[e]);return this}swapRows(t,r){util.checkRowIndex(this,t),util.checkRowIndex(this,r);for(var e=0;e<this.columns;e++){var n=this.get(t,e);this.set(t,e,this.get(r,e)),this.set(r,e,n)}return this}getColumn(t){util.checkColumnIndex(this,t);for(var r=new Array(this.rows),e=0;e<this.rows;e++)r[e]=this.get(e,t);return r}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,r){util.checkColumnIndex(this,t),r=util.checkColumnVector(this,r);for(var e=0;e<this.rows;e++)this.set(e,t,r[e]);return this}swapColumns(t,r){util.checkColumnIndex(this,t),util.checkColumnIndex(this,r);for(var e=0;e<this.rows;e++){var n=this.get(e,t);this.set(e,t,this.get(e,r)),this.set(e,r,n)}return this}addRowVector(t){t=util.checkRowVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[e]);return this}subRowVector(t){t=util.checkRowVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[e]);return this}mulRowVector(t){t=util.checkRowVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[e]);return this}divRowVector(t){t=util.checkRowVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[e]);return this}addColumnVector(t){t=util.checkColumnVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[r]);return this}subColumnVector(t){t=util.checkColumnVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[r]);return this}mulColumnVector(t){t=util.checkColumnVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[r]);return this}divColumnVector(t){t=util.checkColumnVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[r]);return this}mulRow(t,r){util.checkRowIndex(this,t);for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r);return this}mulColumn(t,r){util.checkColumnIndex(this,t);for(var e=0;e<this.rows;e++)this.set(e,t,this.get(e,t)*r);return this}max(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)>t&&(t=this.get(r,e));return t}maxIndex(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n),r[0]=e,r[1]=n);return r}min(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)<t&&(t=this.get(r,e));return t}minIndex(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n),r[0]=e,r[1]=n);return r}maxRow(t){util.checkRowIndex(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)>r&&(r=this.get(t,e));return r}maxRowIndex(t){util.checkRowIndex(this,t);for(var r=this.get(t,0),e=[t,0],n=1;n<this.columns;n++)this.get(t,n)>r&&(r=this.get(t,n),e[1]=n);return e}minRow(t){util.checkRowIndex(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)<r&&(r=this.get(t,e));return r}minRowIndex(t){util.checkRowIndex(this,t);for(var r=this.get(t,0),e=[t,0],n=1;n<this.columns;n++)this.get(t,n)<r&&(r=this.get(t,n),e[1]=n);return e}maxColumn(t){util.checkColumnIndex(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)>r&&(r=this.get(e,t));return r}maxColumnIndex(t){util.checkColumnIndex(this,t);for(var r=this.get(0,t),e=[0,t],n=1;n<this.rows;n++)this.get(n,t)>r&&(r=this.get(n,t),e[0]=n);return e}minColumn(t){util.checkColumnIndex(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)<r&&(r=this.get(e,t));return r}minColumnIndex(t){util.checkColumnIndex(this,t);for(var r=this.get(0,t),e=[0,t],n=1;n<this.rows;n++)this.get(n,t)<r&&(r=this.get(n,t),e[0]=n);return e}diag(){for(var t=Math.min(this.rows,this.columns),r=new Array(t),e=0;e<t;e++)r[e]=this.get(e,e);return r}sum(t){switch(t){case"row":return util.sumByRow(this);case"column":return util.sumByColumn(this);default:return util.sumAll(this)}}mean(){return this.sum()/this.size}prod(){for(var t=1,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t*=this.get(r,e);return t}cumulativeSum(){for(var t=0,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t+=this.get(r,e),this.set(r,e,t);return this}dot(t){Matrix.isMatrix(t)&&(t=t.to1DArray());var r=this.to1DArray();if(r.length!==t.length)throw new RangeError("vectors do not have the same size");for(var e=0,n=0;n<r.length;n++)e+=r[n]*t[n];return e}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var r=this.rows,e=this.columns,n=t.columns,o=new this.constructor[Symbol.species](r,n),i=new Array(e),a=0;a<n;a++){for(var s=0;s<e;s++)i[s]=t.get(s,a);for(var u=0;u<r;u++){var h=0;for(s=0;s<e;s++)h+=this.get(u,s)*i[s];o.set(u,a,h)}}return o}strassen2x2(t){var r=new this.constructor[Symbol.species](2,2);const e=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),h=t.get(1,1),f=(e+u)*(n+h),l=(a+u)*n,c=e*(i-h),m=u*(s-n),g=(e+o)*h,p=f+m-g+(o-u)*(s+h),v=c+g,d=l+m,w=f-l+c+(a-e)*(n+i);return r.set(0,0,p),r.set(0,1,v),r.set(1,0,d),r.set(1,1,w),r}strassen3x3(t){var r=new this.constructor[Symbol.species](3,3);const e=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),h=this.get(2,1),f=this.get(2,2),l=t.get(0,0),c=t.get(0,1),m=t.get(0,2),g=t.get(1,0),p=t.get(1,1),v=t.get(1,2),d=t.get(2,0),w=t.get(2,1),y=t.get(2,2),b=(e-i)*(-c+p),x=(-e+i+a)*(l-c+p),M=(i+a)*(-l+c),A=e*l,E=(-e+u+h)*(l-m+v),R=(-e+u)*(m-v),S=(u+h)*(-l+m),T=(-o+h+f)*(p+d-w),_=(o-f)*(p-w),k=o*d,O=(h+f)*(-d+w),C=(-o+a+s)*(v+d-y),P=(o-s)*(v-y),I=(a+s)*(-d+y),V=A+k+n*g,N=(e+n+o-i-a-h-f)*p+x+M+A+T+k+O,D=A+E+S+(e+n+o-a-s-u-h)*v+k+C+I,z=b+a*(-l+c+g-p-v-d+y)+x+A+k+C+P,U=b+x+M+A+s*w,F=k+C+P+I+i*m,L=A+E+R+h*(-l+m+g-p-v-d+w)+T+_+k,j=T+_+k+O+u*c,Y=A+E+R+S+f*y;return r.set(0,0,V),r.set(0,1,N),r.set(0,2,D),r.set(1,0,z),r.set(1,1,U),r.set(1,2,F),r.set(2,0,L),r.set(2,1,j),r.set(2,2,Y),r}mmulStrassen(t){var r=this.clone(),e=r.rows,n=r.columns,o=t.rows,i=t.columns;function a(t,r,e){var n=t.rows,o=t.columns;if(n===r&&o===e)return t;var i=Matrix.zeros(r,e);return i=i.setSubMatrix(t,0,0)}n!==o&&console.warn("Multiplying ".concat(e," x ").concat(n," and ").concat(o," x ").concat(i," matrix: dimensions do not match."));var s=Math.max(e,o),u=Math.max(n,i);return function t(r,e,n,o){if(n<=512||o<=512)return r.mmul(e);n%2==1&&o%2==1?(r=a(r,n+1,o+1),e=a(e,n+1,o+1)):n%2==1?(r=a(r,n+1,o),e=a(e,n+1,o)):o%2==1&&(r=a(r,n,o+1),e=a(e,n,o+1));var i=parseInt(r.rows/2),s=parseInt(r.columns/2),u=r.subMatrix(0,i-1,0,s-1),h=e.subMatrix(0,i-1,0,s-1),f=r.subMatrix(0,i-1,s,r.columns-1),l=e.subMatrix(0,i-1,s,e.columns-1),c=r.subMatrix(i,r.rows-1,0,s-1),m=e.subMatrix(i,e.rows-1,0,s-1),g=r.subMatrix(i,r.rows-1,s,r.columns-1),p=e.subMatrix(i,e.rows-1,s,e.columns-1),v=t(Matrix.add(u,g),Matrix.add(h,p),i,s),d=t(Matrix.add(c,g),h,i,s),w=t(u,Matrix.sub(l,p),i,s),y=t(g,Matrix.sub(m,h),i,s),b=t(Matrix.add(u,f),p,i,s),x=t(Matrix.sub(c,u),Matrix.add(h,l),i,s),M=t(Matrix.sub(f,g),Matrix.add(m,p),i,s),A=Matrix.add(v,y);A.sub(b),A.add(M);var E=Matrix.add(w,b),R=Matrix.add(d,y),S=Matrix.sub(v,d);S.add(w),S.add(x);var T=Matrix.zeros(2*A.rows,2*A.columns);return(T=(T=(T=(T=T.setSubMatrix(A,0,0)).setSubMatrix(E,A.rows,0)).setSubMatrix(R,0,A.columns)).setSubMatrix(S,A.rows,A.columns)).subMatrix(0,n-1,0,o-1)}(r=a(r,s,u),t=a(t,s,u),s,u)}scaleRows(t,r){if((t=void 0===t?0:t)>=(r=void 0===r?1:r))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),n=0;n<this.rows;n++){var o=arrayUtils.scale(this.getRow(n),{min:t,max:r});e.setRow(n,o)}return e}scaleColumns(t,r){if((t=void 0===t?0:t)>=(r=void 0===r?1:r))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),n=0;n<this.columns;n++){var o=arrayUtils.scale(this.getColumn(n),{min:t,max:r});e.setColumn(n,o)}return e}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var r=this.rows,e=this.columns,n=t.rows,o=t.columns,i=new this.constructor[Symbol.species](r*n,e*o),a=0;a<r;a++)for(var s=0;s<e;s++)for(var u=0;u<n;u++)for(var h=0;h<o;h++)i[n*a+u][o*s+h]=this.get(a,s)*t.get(u,h);return i}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(e,r,this.get(r,e));return t}sortRows(t){void 0===t&&(t=compareNumbers);for(var r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(t));return this}sortColumns(t){void 0===t&&(t=compareNumbers);for(var r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(t));return this}subMatrix(t,r,e,n){util.checkRange(this,t,r,e,n);for(var o=new this.constructor[Symbol.species](r-t+1,n-e+1),i=t;i<=r;i++)for(var a=e;a<=n;a++)o[i-t][a-e]=this.get(i,a);return o}subMatrixRow(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.columns-1),r>e||r<0||r>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](t.length,e-r+1),o=0;o<t.length;o++)for(var i=r;i<=e;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError("Row index out of range: "+t[o]);n.set(o,i-r,this.get(t[o],i))}return n}subMatrixColumn(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.rows-1),r>e||r<0||r>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](e-r+1,t.length),o=0;o<t.length;o++)for(var i=r;i<=e;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError("Column index out of range: "+t[o]);n.set(i-r,o,this.get(i,t[o]))}return n}setSubMatrix(t,r,e){var n=r+(t=this.constructor.checkMatrix(t)).rows-1,o=e+t.columns-1;util.checkRange(this,r,n,e,o);for(var i=0;i<t.rows;i++)for(var a=0;a<t.columns;a++)this[r+i][e+a]=t.get(i,a);return this}selection(t,r){for(var e=util.checkIndices(this,t,r),n=new this.constructor[Symbol.species](t.length,r.length),o=0;o<e.row.length;o++)for(var i=e.row[o],a=0;a<e.column.length;a++){var s=e.column[a];n[o][a]=this.get(i,s)}return n}trace(){for(var t=Math.min(this.rows,this.columns),r=0,e=0;e<t;e++)r+=this.get(e,e);return r}transposeView(){return new MatrixTransposeView(this)}rowView(t){return util.checkRowIndex(this,t),new MatrixRowView(this,t)}columnView(t){return util.checkColumnIndex(this,t),new MatrixColumnView(this,t)}flipRowView(){return new MatrixFlipRowView(this)}flipColumnView(){return new MatrixFlipColumnView(this)}subMatrixView(t,r,e,n){return new MatrixSubView(this,t,r,e,n)}selectionView(t,r){return new MatrixSelectionView(this,t,r)}det(){var t,r,e,n,o,i;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),r=this.get(0,1),e=this.get(1,0),t*this.get(1,1)-r*e):3===this.columns?(n=this.selectionView([1,2],[1,2]),o=this.selectionView([1,2],[0,2]),i=this.selectionView([1,2],[0,1]),t=this.get(0,0),r=this.get(0,1),e=this.get(0,2),t*n.det()-r*o.det()+e*i.det()):new LuDecomposition(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=Number.EPSILON);for(var r=new SvDecomposition(this,{autoTranspose:!0}),e=r.leftSingularVectors,n=r.rightSingularVectors,o=r.diagonal,i=0;i<o.length;i++)Math.abs(o[i])>t?o[i]=1/o[i]:o[i]=0;return o=this.constructor[Symbol.species].diag(o),n.mmul(o.mmul(e.transposeView()))}}function checkDimensions(t,r){if(t.rows!==r.rows||t.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal")}function compareNumbers(t,r){return t-r}Matrix.prototype.klass="Matrix",Matrix.random=Matrix.rand,Matrix.diagonal=Matrix.diag,Matrix.prototype.diagonal=Matrix.prototype.diag,Matrix.identity=Matrix.eye,Matrix.prototype.negate=Matrix.prototype.neg,Matrix.prototype.tensorProduct=Matrix.prototype.kroneckerProduct,Matrix.prototype.determinant=Matrix.prototype.det;var inplaceOperator="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",inplaceOperatorScalar="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",inplaceOperatorMatrix="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",staticOperator="\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",inplaceMethod="\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",staticMethod="\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",inplaceMethodWithArgs="\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",staticMethodWithArgs="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",inplaceMethodWithOneArgScalar="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",inplaceMethodWithOneArgMatrix="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",inplaceMethodWithOneArg="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",staticMethodWithOneArg=staticMethodWithArgs,operators=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],i;for(var operator of operators){var inplaceOp=eval(fillTemplateFunction(inplaceOperator,{name:operator[1],op:operator[0]})),inplaceOpS=eval(fillTemplateFunction(inplaceOperatorScalar,{name:operator[1]+"S",op:operator[0]})),inplaceOpM=eval(fillTemplateFunction(inplaceOperatorMatrix,{name:operator[1]+"M",op:operator[0]})),staticOp=eval(fillTemplateFunction(staticOperator,{name:operator[1]}));for(i=1;i<operator.length;i++)Matrix.prototype[operator[i]]=inplaceOp,Matrix.prototype[operator[i]+"S"]=inplaceOpS,Matrix.prototype[operator[i]+"M"]=inplaceOpM,Matrix[operator[i]]=staticOp}var methods=[["~","not"]];for(var method of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){methods.push(["Math."+t,t])}),methods)){var inplaceMeth=eval(fillTemplateFunction(inplaceMethod,{name:method[1],method:method[0]})),staticMeth=eval(fillTemplateFunction(staticMethod,{name:method[1]}));for(i=1;i<method.length;i++)Matrix.prototype[method[i]]=inplaceMeth,Matrix[method[i]]=staticMeth}var methodsWithArgs=[["Math.pow",1,"pow"]];for(var methodWithArg of methodsWithArgs){var args="arg0";for(i=1;i<methodWithArg[1];i++)args+=", arg".concat(i);if(1!==methodWithArg[1]){var inplaceMethWithArgs=eval(fillTemplateFunction(inplaceMethodWithArgs,{name:methodWithArg[2],method:methodWithArg[0],args:args})),staticMethWithArgs=eval(fillTemplateFunction(staticMethodWithArgs,{name:methodWithArg[2],args:args}));for(i=2;i<methodWithArg.length;i++)Matrix.prototype[methodWithArg[i]]=inplaceMethWithArgs,Matrix[methodWithArg[i]]=staticMethWithArgs}else{var tmplVar={name:methodWithArg[2],args:args,method:methodWithArg[0]},inplaceMethod2=eval(fillTemplateFunction(inplaceMethodWithOneArg,tmplVar)),inplaceMethodS=eval(fillTemplateFunction(inplaceMethodWithOneArgScalar,tmplVar)),inplaceMethodM=eval(fillTemplateFunction(inplaceMethodWithOneArgMatrix,tmplVar)),staticMethod2=eval(fillTemplateFunction(staticMethodWithOneArg,tmplVar));for(i=2;i<methodWithArg.length;i++)Matrix.prototype[methodWithArg[i]]=inplaceMethod2,Matrix.prototype[methodWithArg[i]+"M"]=inplaceMethodM,Matrix.prototype[methodWithArg[i]+"S"]=inplaceMethodS,Matrix[methodWithArg[i]]=staticMethod2}}function fillTemplateFunction(t,r){for(var e in r)t=t.replace(new RegExp("%"+e+"%","g"),r[e]);return t}return Matrix}},function(t,r,e){"use strict";var n=e(1);function o(t){if(!(this instanceof o))return new o(t);var r,e,i,a,s,u,h,f,l,c,m=(t=n.Matrix.checkMatrix(t)).clone(),g=m.rows,p=m.columns,v=new Array(g),d=1;for(r=0;r<g;r++)v[r]=r;for(l=new Array(g),e=0;e<p;e++){for(r=0;r<g;r++)l[r]=m[r][e];for(r=0;r<g;r++){for(f=m[r],c=Math.min(r,e),s=0,i=0;i<c;i++)s+=f[i]*l[i];f[e]=l[r]-=s}for(a=e,r=e+1;r<g;r++)Math.abs(l[r])>Math.abs(l[a])&&(a=r);if(a!==e){for(i=0;i<p;i++)u=m[a][i],m[a][i]=m[e][i],m[e][i]=u;h=v[a],v[a]=v[e],v[e]=h,d=-d}if(e<g&&0!==m[e][e])for(r=e+1;r<g;r++)m[r][e]/=m[e][e]}this.LU=m,this.pivotVector=v,this.pivotSign=d}o.prototype={isSingular:function(){for(var t=this.LU,r=t.columns,e=0;e<r;e++)if(0===t[e][e])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var r=this.pivotSign,e=t.columns,n=0;n<e;n++)r*=t[n][n];return r},get lowerTriangularMatrix(){for(var t=this.LU,r=t.rows,e=t.columns,o=new n.Matrix(r,e),i=0;i<r;i++)for(var a=0;a<e;a++)o[i][a]=i>a?t[i][a]:i===a?1:0;return o},get upperTriangularMatrix(){for(var t=this.LU,r=t.rows,e=t.columns,o=new n.Matrix(r,e),i=0;i<r;i++)for(var a=0;a<e;a++)o[i][a]=i<=a?t[i][a]:0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=n.Matrix.checkMatrix(t);var r=this.LU;if(r.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var e,o,i,a=t.columns,s=t.subMatrixRow(this.pivotVector,0,a-1),u=r.columns;for(i=0;i<u;i++)for(e=i+1;e<u;e++)for(o=0;o<a;o++)s[e][o]-=s[i][o]*r[e][i];for(i=u-1;i>=0;i--){for(o=0;o<a;o++)s[i][o]/=r[i][i];for(e=0;e<i;e++)for(o=0;o<a;o++)s[e][o]-=s[i][o]*r[e][i]}return s}},t.exports=o},function(t,r,e){"use strict";var n=e(1),o=e(8),i=o.hypotenuse,a=o.getFilled2DArray;function s(t,r){if(!(this instanceof s))return new s(t,r);r=r||{};var e=(t=n.Matrix.checkMatrix(t)).rows,o=t.columns,u=Math.min(e,o),h=!0,f=!0;!1===r.computeLeftSingularVectors&&(h=!1),!1===r.computeRightSingularVectors&&(f=!1);var l,c=!0===r.autoTranspose,m=!1;if(e<o)if(c){e=(l=t.transpose()).rows,o=l.columns,m=!0;var g=h;h=f,f=g}else l=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else l=t.clone();var p,v,d,w,y,b,x,M,A,E,R,S,T,_,k,O,C,P,I,V,N,D=new Array(Math.min(e+1,o)),z=a(e,u,0),U=a(o,o,0),F=new Array(o),L=new Array(e),j=Math.min(e-1,o),Y=Math.max(0,Math.min(o-2,e));for(d=0,E=Math.max(j,Y);d<E;d++){if(d<j){for(D[d]=0,p=d;p<e;p++)D[d]=i(D[d],l[p][d]);if(0!==D[d]){for(l[d][d]<0&&(D[d]=-D[d]),p=d;p<e;p++)l[p][d]/=D[d];l[d][d]+=1}D[d]=-D[d]}for(v=d+1;v<o;v++){if(d<j&&0!==D[d]){for(y=0,p=d;p<e;p++)y+=l[p][d]*l[p][v];for(y=-y/l[d][d],p=d;p<e;p++)l[p][v]+=y*l[p][d]}F[v]=l[d][v]}if(h&&d<j)for(p=d;p<e;p++)z[p][d]=l[p][d];if(d<Y){for(F[d]=0,p=d+1;p<o;p++)F[d]=i(F[d],F[p]);if(0!==F[d]){for(F[d+1]<0&&(F[d]=0-F[d]),p=d+1;p<o;p++)F[p]/=F[d];F[d+1]+=1}if(F[d]=-F[d],d+1<e&&0!==F[d]){for(p=d+1;p<e;p++)L[p]=0;for(v=d+1;v<o;v++)for(p=d+1;p<e;p++)L[p]+=F[v]*l[p][v];for(v=d+1;v<o;v++)for(y=-F[v]/F[d+1],p=d+1;p<e;p++)l[p][v]+=y*L[p]}if(f)for(p=d+1;p<o;p++)U[p][d]=F[p]}}if(w=Math.min(o,e+1),j<o&&(D[j]=l[j][j]),e<w&&(D[w-1]=0),Y+1<w&&(F[Y]=l[Y][w-1]),F[w-1]=0,h){for(v=j;v<u;v++){for(p=0;p<e;p++)z[p][v]=0;z[v][v]=1}for(d=j-1;d>=0;d--)if(0!==D[d]){for(v=d+1;v<u;v++){for(y=0,p=d;p<e;p++)y+=z[p][d]*z[p][v];for(y=-y/z[d][d],p=d;p<e;p++)z[p][v]+=y*z[p][d]}for(p=d;p<e;p++)z[p][d]=-z[p][d];for(z[d][d]=1+z[d][d],p=0;p<d-1;p++)z[p][d]=0}else{for(p=0;p<e;p++)z[p][d]=0;z[d][d]=1}}if(f)for(d=o-1;d>=0;d--){if(d<Y&&0!==F[d])for(v=d+1;v<o;v++){for(y=0,p=d+1;p<o;p++)y+=U[p][d]*U[p][v];for(y=-y/U[d+1][d],p=d+1;p<o;p++)U[p][v]+=y*U[p][d]}for(p=0;p<o;p++)U[p][d]=0;U[d][d]=1}for(var q=w-1,B=Math.pow(2,-52);w>0;){for(d=w-2;d>=-1&&-1!==d;d--)if(Math.abs(F[d])<=B*(Math.abs(D[d])+Math.abs(D[d+1]))){F[d]=0;break}if(d===w-2)R=4;else{for(b=w-1;b>=d&&b!==d;b--)if(y=(b!==w?Math.abs(F[b]):0)+(b!==d+1?Math.abs(F[b-1]):0),Math.abs(D[b])<=B*y){D[b]=0;break}b===d?R=3:b===w-1?R=1:(R=2,d=b)}switch(d++,R){case 1:for(x=F[w-2],F[w-2]=0,v=w-2;v>=d;v--)if(y=i(D[v],x),M=D[v]/y,A=x/y,D[v]=y,v!==d&&(x=-A*F[v-1],F[v-1]=M*F[v-1]),f)for(p=0;p<o;p++)y=M*U[p][v]+A*U[p][w-1],U[p][w-1]=-A*U[p][v]+M*U[p][w-1],U[p][v]=y;break;case 2:for(x=F[d-1],F[d-1]=0,v=d;v<w;v++)if(y=i(D[v],x),M=D[v]/y,A=x/y,D[v]=y,x=-A*F[v],F[v]=M*F[v],h)for(p=0;p<e;p++)y=M*z[p][v]+A*z[p][d-1],z[p][d-1]=-A*z[p][v]+M*z[p][d-1],z[p][v]=y;break;case 3:for(S=Math.max(Math.max(Math.max(Math.max(Math.abs(D[w-1]),Math.abs(D[w-2])),Math.abs(F[w-2])),Math.abs(D[d])),Math.abs(F[d])),T=D[w-1]/S,_=D[w-2]/S,k=F[w-2]/S,O=D[d]/S,C=F[d]/S,I=T*k*(T*k),V=0,0===(P=((_+T)*(_-T)+k*k)/2)&&0===I||(V=Math.sqrt(P*P+I),P<0&&(V=-V),V=I/(P+V)),x=(O+T)*(O-T)+V,N=O*C,v=d;v<w-1;v++){if(M=x/(y=i(x,N)),A=N/y,v!==d&&(F[v-1]=y),x=M*D[v]+A*F[v],F[v]=M*F[v]-A*D[v],N=A*D[v+1],D[v+1]=M*D[v+1],f)for(p=0;p<o;p++)y=M*U[p][v]+A*U[p][v+1],U[p][v+1]=-A*U[p][v]+M*U[p][v+1],U[p][v]=y;if(M=x/(y=i(x,N)),A=N/y,D[v]=y,x=M*F[v]+A*D[v+1],D[v+1]=-A*F[v]+M*D[v+1],N=A*F[v+1],F[v+1]=M*F[v+1],h&&v<e-1)for(p=0;p<e;p++)y=M*z[p][v]+A*z[p][v+1],z[p][v+1]=-A*z[p][v]+M*z[p][v+1],z[p][v]=y}F[w-2]=x,1;break;case 4:if(D[d]<=0&&(D[d]=D[d]<0?-D[d]:0,f))for(p=0;p<=q;p++)U[p][d]=-U[p][d];for(;d<q&&!(D[d]>=D[d+1]);){if(y=D[d],D[d]=D[d+1],D[d+1]=y,f&&d<o-1)for(p=0;p<o;p++)y=U[p][d+1],U[p][d+1]=U[p][d],U[p][d]=y;if(h&&d<e-1)for(p=0;p<e;p++)y=z[p][d+1],z[p][d+1]=z[p][d],z[p][d]=y;d++}0,w--}}if(m){var X=U;U=z,z=X}this.m=e,this.n=o,this.s=D,this.U=z,this.V=U}s.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=Math.pow(2,-52),r=Math.max(this.m,this.n)*this.s[0]*t,e=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>r&&e++;return e},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return n.Matrix.isMatrix(this.U)||(this.U=new n.Matrix(this.U)),this.U},get rightSingularVectors(){return n.Matrix.isMatrix(this.V)||(this.V=new n.Matrix(this.V)),this.V},get diagonalMatrix(){return n.Matrix.diag(this.s)},solve:function(t){var r,e=t,o=this.threshold,i=this.s.length,a=n.Matrix.zeros(i,i);for(r=0;r<i;r++)Math.abs(this.s[r])<=o?a[r][r]=0:a[r][r]=1/this.s[r];var s,u,h,f=this.U,l=this.rightSingularVectors,c=l.mmul(a),m=l.rows,g=f.length,p=n.Matrix.zeros(m,g);for(r=0;r<m;r++)for(s=0;s<g;s++){for(h=0,u=0;u<i;u++)h+=c[r][u]*f[s][u];p[r][s]=h}return p.mmul(e)},solveForDiagonal:function(t){return this.solve(n.Matrix.diag(t))},inverse:function(){var t,r,e=this.V,o=this.threshold,i=e.length,a=e[0].length,s=new n.Matrix(i,this.s.length);for(t=0;t<i;t++)for(r=0;r<a;r++)Math.abs(this.s[r])>o?s[t][r]=e[t][r]/this.s[r]:s[t][r]=0;var u,h,f=this.U,l=f.length,c=f[0].length,m=new n.Matrix(i,l);for(t=0;t<i;t++)for(r=0;r<l;r++){for(h=0,u=0;u<c;u++)h+=s[t][u]*f[r][u];m[t][r]=h}return m}},t.exports=s},function(t,r,e){"use strict";function n(t,r){return t-r}r.sum=function(t){for(var r=0,e=0;e<t.length;e++)r+=t[e];return r},r.max=function(t){for(var r=t[0],e=t.length,n=1;n<e;n++)t[n]>r&&(r=t[n]);return r},r.min=function(t){for(var r=t[0],e=t.length,n=1;n<e;n++)t[n]<r&&(r=t[n]);return r},r.minMax=function(t){for(var r=t[0],e=t[0],n=t.length,o=1;o<n;o++)t[o]<r&&(r=t[o]),t[o]>e&&(e=t[o]);return{min:r,max:e}},r.arithmeticMean=function(t){for(var r=0,e=t.length,n=0;n<e;n++)r+=t[n];return r/e},r.mean=r.arithmeticMean,r.geometricMean=function(t){for(var r=1,e=t.length,n=0;n<e;n++)r*=t[n];return Math.pow(r,1/e)},r.logMean=function(t){for(var r=0,e=t.length,n=0;n<e;n++)r+=Math.log(t[n]);return r/e},r.grandMean=function(t,r){for(var e=0,n=0,o=t.length,i=0;i<o;i++)e+=r[i]*t[i],n+=r[i];return e/n},r.truncatedMean=function(t,r,e){void 0===e&&(e=!1),e||(t=[].concat(t).sort(n));for(var o=t.length,i=Math.floor(o*r),a=0,s=i;s<o-i;s++)a+=t[s];return a/(o-2*i)},r.harmonicMean=function(t){for(var r=0,e=t.length,n=0;n<e;n++){if(0===t[n])throw new RangeError("value at index "+n+"is zero");r+=1/t[n]}return e/r},r.contraHarmonicMean=function(t){for(var r=0,e=0,n=t.length,o=0;o<n;o++)r+=t[o]*t[o],e+=t[o];if(e<0)throw new RangeError("sum of values is negative");return r/e},r.median=function(t,r){void 0===r&&(r=!1),r||(t=[].concat(t).sort(n));var e=t.length,o=Math.floor(e/2);return e%2==0?.5*(t[o-1]+t[o]):t[o]},r.variance=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=0,i=t.length,a=0;a<i;a++){var s=t[a]-n;o+=s*s}return e?o/(i-1):o/i},r.standardDeviation=function(t,e){return Math.sqrt(r.variance(t,e))},r.standardError=function(t){return r.standardDeviation(t)/Math.sqrt(t.length)},r.robustMeanAndStdev=function(t){var r=0,e=t.length,o=0;for(o=0;o<e;o++)r+=t[o];r/=e;var i=new Array(e);for(o=0;o<e;o++)i[o]=Math.abs(t[o]-r);return i.sort(n),{mean:r,stdev:e%2==1?i[(e-1)/2]/.6745:.5*(i[e/2]+i[e/2-1])/.6745}},r.quartiles=function(t,e){void 0===e&&(e=!1),e||(t=[].concat(t).sort(n));var o=t.length/4;return{q1:t[Math.ceil(o)-1],q2:r.median(t,!0),q3:t[Math.ceil(3*o)-1]}},r.pooledStandardDeviation=function(t,e){return Math.sqrt(r.pooledVariance(t,e))},r.pooledVariance=function(t,e){void 0===e&&(e=!0);for(var n=0,o=0,i=t.length,a=0;a<i;a++){var s=t[a],u=r.variance(s);n+=(s.length-1)*u,o+=e?s.length-1:s.length}return n/o},r.mode=function(t){var r,e=t.length,n=new Array(e);for(r=0;r<e;r++)n[r]=0;var o=new Array(e),i=0;for(r=0;r<e;r++){var a=o.indexOf(t[r]);a>=0?n[a]++:(o[i]=t[r],n[i]=1,i++)}var s=0,u=0;for(r=0;r<i;r++)n[r]>s&&(s=n[r],u=r);return o[u]},r.covariance=function(t,e,n){void 0===n&&(n=!0);var o=r.mean(t),i=r.mean(e);if(t.length!==e.length)throw"Vectors do not have the same dimensions";for(var a=0,s=t.length,u=0;u<s;u++){a+=(t[u]-o)*(e[u]-i)}return n?a/(s-1):a/s},r.skewness=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=0,i=0,a=t.length,s=0;s<a;s++){var u=t[s]-n;o+=u*u,i+=u*u*u}var h=o/a,f=i/a/Math.pow(h,1.5);return e?Math.sqrt(a*(a-1))/(a-2)*f:f},r.kurtosis=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=t.length,i=0,a=0,s=0;s<o;s++){var u=t[s]-n;i+=u*u,a+=u*u*u*u}var h=i/o;if(e){var f=i/(o-1);return o*(o+1)/((o-1)*(o-2)*(o-3))*(a/(f*f))-3*((o-1)*(o-1)/((o-2)*(o-3)))}return a/o/(h*h)-3},r.entropy=function(t,r){void 0===r&&(r=0);for(var e=0,n=t.length,o=0;o<n;o++)e+=t[o]*Math.log(t[o]+r);return-e},r.weightedMean=function(t,r){for(var e=0,n=t.length,o=0;o<n;o++)e+=t[o]*r[o];return e},r.weightedStandardDeviation=function(t,e){return Math.sqrt(r.weightedVariance(t,e))},r.weightedVariance=function(t,e){for(var n=r.weightedMean(t,e),o=0,i=t.length,a=0,s=0,u=0;u<i;u++){var h=t[u]-n,f=e[u];o+=f*(h*h),s+=f,a+=f*f}return o*(s/(s*s-a))},r.center=function(t,e){void 0===e&&(e=!1);var n=t;e||(n=[].concat(t));for(var o=r.mean(n),i=n.length,a=0;a<i;a++)n[a]-=o},r.standardize=function(t,e,n){void 0===e&&(e=r.standardDeviation(t)),void 0===n&&(n=!1);for(var o=t.length,i=n?t:new Array(o),a=0;a<o;a++)i[a]=t[a]/e;return i},r.cumulativeSum=function(t){var r=t.length,e=new Array(r);e[0]=t[0];for(var n=1;n<r;n++)e[n]=e[n-1]+t[n];return e}},function(t,r,e){"use strict";var n=e(5);t.exports={transpose:function(t){return"number"==typeof t?t:t.clone().transpose()},add:function(t,r){return"number"==typeof t&&"number"==typeof r?t+r:"number"==typeof t?this.add(r,t):t.clone().add(r)},subtract:function(t,r){return"number"==typeof t&&"number"==typeof r?t-r:"number"==typeof t?this.subtract(r,t):t.clone().sub(r)},multiply:function(t,r){if("number"==typeof t&&"number"==typeof r)return t*r;if("number"==typeof t)return this.multiply(r,t);var e=t.clone();return"number"==typeof r?e.mul(r):e=e.mmul(r),1==e.rows&&1==e.columns?e[0][0]:e},dotMultiply:function(t,r){return t.clone().mul(r)},dotDivide:function(t,r){return t.clone().div(r)},diag:function(t){var r,e,o=null,i=t.rows,a=t.columns;if(void 0===a&&"object"==typeof t)if(t[0]&&t[0].length)for(i=t.length,a=t[0].length,e=Math.min(i,a),o=n.zeros(a,a),r=0;r<a;r++)o[r][r]=t[r][r];else for(a=t.length,o=n.zeros(a,a),r=0;r<a;r++)o[r][r]=t[r];if(1==i)for(o=n.zeros(a,a),r=0;r<a;r++)o[r][r]=t[0][r];else if(i>0&&a>0)for(e=Math.min(i,a),o=new Array(e),r=0;r<e;r++)o[r]=t[r][r];return o},min:function(t,r){if("number"==typeof t&&"number"==typeof r)return Math.min(t,r);for(var e=t.rows,o=t.columns,i=new n(e,o),a=0;a<e;a++)for(var s=0;s<o;s++)t[a][s]<r[a][s]?i[a][s]=t[a][s]:i[a][s]=r[a][s];return i},max:function(t,r){if("number"==typeof t&&"number"==typeof r)return Math.max(t,r);for(var e=t.rows,o=t.columns,i=new n(e,o),a=0;a<e;a++)for(var s=0;s<o;s++)t[a][s]>r[a][s]?i[a][s]=t[a][s]:i[a][s]=r[a][s];return i},solve:function(t,r){return t.solve(r)},inv:function(t){return"number"==typeof t?1/t:t.inverse()},sqrt:function(t){if("number"==typeof t)return Math.sqrt(t);for(var r=t.rows,e=t.columns,o=new n(r,e),i=0;i<r;i++)for(var a=0;a<e;a++)o[i][a]=Math.sqrt(t[i][a]);return o},exp:function(t){if("number"==typeof t)return Math.sqrt(t);for(var r=t.rows,e=t.columns,o=new n(r,e),i=0;i<r;i++)for(var a=0;a<e;a++)o[i][a]=Math.exp(t[i][a]);return o},dotPow:function(t,r){if("number"==typeof t)return Math.pow(t,r);for(var e=t.rows,o=t.columns,i=new n(e,o),a=0;a<e;a++)for(var s=0;s<o;s++)i[a][s]=Math.pow(t[a][s],r);return i},abs:function(t){if("number"==typeof t)return Math.abs(t);for(var r=t.rows,e=t.columns,o=new n(r,e),i=0;i<r;i++)for(var a=0;a<e;a++)o[i][a]=Math.abs(t[i][a]);return o},matrix:function(t,r){return new n(t,r)},ones:function(t,r){return n.ones(t,r)},zeros:function(t,r){return n.zeros(t,r)},random:function(t,r){return n.rand(t,r)},eye:function(t,r){return n.eye(t,r)}}},function(t,r,e){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=e(57),o=e(58),i=e(59);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,r){if(a()<r)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=u.prototype:(null===t&&(t=new u(r)),t.length=r),t}function u(t,r,e){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return h(this,t,r,e)}function h(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?function(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n);u.TYPED_ARRAY_SUPPORT?(t=r).__proto__=u.prototype:t=c(t,r);return t}(t,r,e,n):"string"==typeof r?function(t,r,e){"string"==typeof e&&""!==e||(e="utf8");if(!u.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|g(r,e),o=(t=s(t,n)).write(r,e);o!==n&&(t=t.slice(0,o));return t}(t,r,e):function(t,r){if(u.isBuffer(r)){var e=0|m(r.length);return 0===(t=s(t,e)).length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||(n=r.length)!=n?s(t,0):c(t,r);if("Buffer"===r.type&&i(r.data))return c(t,r.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,r)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,r){if(f(r),t=s(t,r<0?0:0|m(r)),!u.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t}function c(t,r){var e=r.length<0?0:0|m(r.length);t=s(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t}function m(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function g(t,r){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return j(t).length;default:if(n)return L(t).length;r=(""+r).toLowerCase(),n=!0}}function p(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function v(t,r,e,n,o){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=o?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(o)return-1;e=t.length-1}else if(e<0){if(!o)return-1;e=0}if("string"==typeof r&&(r=u.from(r,n)),u.isBuffer(r))return 0===r.length?-1:d(t,r,e,n,o);if("number"==typeof r)return r&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):d(t,[r],e,n,o);throw new TypeError("val must be string, number or Buffer")}function d(t,r,e,n,o){var i,a=1,s=t.length,u=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;a=2,s/=2,u/=2,e/=2}function h(t,r){return 1===a?t[r]:t.readUInt16BE(r*a)}if(o){var f=-1;for(i=e;i<s;i++)if(h(t,i)===h(r,-1===f?0:i-f)){if(-1===f&&(f=i),i-f+1===u)return f*a}else-1!==f&&(i-=i-f),f=-1}else for(e+u>s&&(e=s-u),i=e;i>=0;i--){for(var l=!0,c=0;c<u;c++)if(h(t,i+c)!==h(r,c)){l=!1;break}if(l)return i}return-1}function w(t,r,e,n){e=Number(e)||0;var o=t.length-e;n?(n=Number(n))>o&&(n=o):n=o;var i=r.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var a=0;a<n;++a){var s=parseInt(r.substr(2*a,2),16);if(isNaN(s))return a;t[e+a]=s}return a}function y(t,r,e,n){return Y(L(r,t.length-e),t,e,n)}function b(t,r,e,n){return Y(function(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}(r),t,e,n)}function x(t,r,e,n){return b(t,r,e,n)}function M(t,r,e,n){return Y(j(r),t,e,n)}function A(t,r,e,n){return Y(function(t,r){for(var e,n,o,i=[],a=0;a<t.length&&!((r-=2)<0);++a)e=t.charCodeAt(a),n=e>>8,o=e%256,i.push(o),i.push(n);return i}(r,t.length-e),t,e,n)}function E(t,r,e){return 0===r&&e===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(r,e))}function R(t,r,e){e=Math.min(t.length,e);for(var n=[],o=r;o<e;){var i,a,s,u,h=t[o],f=null,l=h>239?4:h>223?3:h>191?2:1;if(o+l<=e)switch(l){case 1:h<128&&(f=h);break;case 2:128==(192&(i=t[o+1]))&&(u=(31&h)<<6|63&i)>127&&(f=u);break;case 3:i=t[o+1],a=t[o+2],128==(192&i)&&128==(192&a)&&(u=(15&h)<<12|(63&i)<<6|63&a)>2047&&(u<55296||u>57343)&&(f=u);break;case 4:i=t[o+1],a=t[o+2],s=t[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(u=(15&h)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(f=u)}null===f?(f=65533,l=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),o+=l}return function(t){var r=t.length;if(r<=S)return String.fromCharCode.apply(String,t);var e="",n=0;for(;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=S));return e}(n)}r.Buffer=u,r.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},r.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),r.kMaxLength=a(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,r,e){return h(null,t,r,e)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,r,e){return function(t,r,e,n){return f(r),r<=0?s(t,r):void 0!==e?"string"==typeof n?s(t,r).fill(e,n):s(t,r).fill(e):s(t,r)}(null,t,r,e)},u.allocUnsafe=function(t){return l(null,t)},u.allocUnsafeSlow=function(t){return l(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,r){if(!u.isBuffer(t)||!u.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,o=0,i=Math.min(e,n);o<i;++o)if(t[o]!==r[o]){e=t[o],n=r[o];break}return e<n?-1:n<e?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,r){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var n=u.allocUnsafe(r),o=0;for(e=0;e<t.length;++e){var a=t[e];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,o),o+=a.length}return n},u.byteLength=g,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)p(this,r,r+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)p(this,r,r+3),p(this,r+1,r+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)p(this,r,r+7),p(this,r+1,r+6),p(this,r+2,r+5),p(this,r+3,r+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?R(this,0,t):function(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,r,e);case"utf8":case"utf-8":return R(this,r,e);case"ascii":return T(this,r,e);case"latin1":case"binary":return _(this,r,e);case"base64":return E(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",e=r.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,r,e,n,o){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),r<0||e>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&r>=e)return 0;if(n>=o)return-1;if(r>=e)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(n>>>=0),a=(e>>>=0)-(r>>>=0),s=Math.min(i,a),h=this.slice(n,o),f=t.slice(r,e),l=0;l<s;++l)if(h[l]!==f[l]){i=h[l],a=f[l];break}return i<a?-1:a<i?1:0},u.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},u.prototype.indexOf=function(t,r,e){return v(this,t,r,e,!0)},u.prototype.lastIndexOf=function(t,r,e){return v(this,t,r,e,!1)},u.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var o=this.length-r;if((void 0===e||e>o)&&(e=o),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return w(this,t,r,e);case"utf8":case"utf-8":return y(this,t,r,e);case"ascii":return b(this,t,r,e);case"latin1":case"binary":return x(this,t,r,e);case"base64":return M(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,r,e);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function T(t,r,e){var n="";e=Math.min(t.length,e);for(var o=r;o<e;++o)n+=String.fromCharCode(127&t[o]);return n}function _(t,r,e){var n="";e=Math.min(t.length,e);for(var o=r;o<e;++o)n+=String.fromCharCode(t[o]);return n}function k(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var o="",i=r;i<e;++i)o+=F(t[i]);return o}function O(t,r,e){for(var n=t.slice(r,e),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function C(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function P(t,r,e,n,o,i){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>o||r<i)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function I(t,r,e,n){r<0&&(r=65535+r+1);for(var o=0,i=Math.min(t.length-e,2);o<i;++o)t[e+o]=(r&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function V(t,r,e,n){r<0&&(r=4294967295+r+1);for(var o=0,i=Math.min(t.length-e,4);o<i;++o)t[e+o]=r>>>8*(n?o:3-o)&255}function N(t,r,e,n,o,i){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function D(t,r,e,n,i){return i||N(t,0,e,4),o.write(t,r,e,n,23,4),e+4}function z(t,r,e,n,i){return i||N(t,0,e,8),o.write(t,r,e,n,52,8),e+8}u.prototype.slice=function(t,r){var e,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t),u.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,r)).__proto__=u.prototype;else{var o=r-t;e=new u(o,void 0);for(var i=0;i<o;++i)e[i]=this[i+t]}return e},u.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||C(t,r,this.length);for(var n=this[t],o=1,i=0;++i<r&&(o*=256);)n+=this[t+i]*o;return n},u.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||C(t,r,this.length);for(var n=this[t+--r],o=1;r>0&&(o*=256);)n+=this[t+--r]*o;return n},u.prototype.readUInt8=function(t,r){return r||C(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,r){return r||C(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,r){return r||C(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,r){return r||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,r){return r||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||C(t,r,this.length);for(var n=this[t],o=1,i=0;++i<r&&(o*=256);)n+=this[t+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*r)),n},u.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||C(t,r,this.length);for(var n=r,o=1,i=this[t+--n];n>0&&(o*=256);)i+=this[t+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*r)),i},u.prototype.readInt8=function(t,r){return r||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,r){r||C(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},u.prototype.readInt16BE=function(t,r){r||C(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},u.prototype.readInt32LE=function(t,r){return r||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,r){return r||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,r){return r||C(t,4,this.length),o.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,r){return r||C(t,4,this.length),o.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,r){return r||C(t,8,this.length),o.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,r){return r||C(t,8,this.length),o.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||P(this,t,r,e,Math.pow(2,8*e)-1,0);var o=1,i=0;for(this[r]=255&t;++i<e&&(o*=256);)this[r+i]=t/o&255;return r+e},u.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||P(this,t,r,e,Math.pow(2,8*e)-1,0);var o=e-1,i=1;for(this[r+o]=255&t;--o>=0&&(i*=256);)this[r+o]=t/i&255;return r+e},u.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||P(this,t,r,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},u.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||P(this,t,r,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):I(this,t,r,!0),r+2},u.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||P(this,t,r,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):I(this,t,r,!1),r+2},u.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||P(this,t,r,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):V(this,t,r,!0),r+4},u.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||P(this,t,r,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):V(this,t,r,!1),r+4},u.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var o=Math.pow(2,8*e-1);P(this,t,r,e,o-1,-o)}var i=0,a=1,s=0;for(this[r]=255&t;++i<e&&(a*=256);)t<0&&0===s&&0!==this[r+i-1]&&(s=1),this[r+i]=(t/a>>0)-s&255;return r+e},u.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var o=Math.pow(2,8*e-1);P(this,t,r,e,o-1,-o)}var i=e-1,a=1,s=0;for(this[r+i]=255&t;--i>=0&&(a*=256);)t<0&&0===s&&0!==this[r+i+1]&&(s=1),this[r+i]=(t/a>>0)-s&255;return r+e},u.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||P(this,t,r,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},u.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||P(this,t,r,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):I(this,t,r,!0),r+2},u.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||P(this,t,r,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):I(this,t,r,!1),r+2},u.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||P(this,t,r,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):V(this,t,r,!0),r+4},u.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||P(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):V(this,t,r,!1),r+4},u.prototype.writeFloatLE=function(t,r,e){return D(this,t,r,!0,e)},u.prototype.writeFloatBE=function(t,r,e){return D(this,t,r,!1,e)},u.prototype.writeDoubleLE=function(t,r,e){return z(this,t,r,!0,e)},u.prototype.writeDoubleBE=function(t,r,e){return z(this,t,r,!1,e)},u.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var o,i=n-e;if(this===t&&e<r&&r<n)for(o=i-1;o>=0;--o)t[o+r]=this[o+e];else if(i<1e3||!u.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+r]=this[o+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+i),r);return i},u.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var i;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(i=r;i<e;++i)this[i]=t;else{var a=u.isBuffer(t)?t:L(new u(t,n).toString()),s=a.length;for(i=0;i<e-r;++i)this[i+r]=a[i%s]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function F(t){return t<16?"0"+t.toString(16):t.toString(16)}function L(t,r){var e;r=r||1/0;for(var n=t.length,o=null,i=[],a=0;a<n;++a){if((e=t.charCodeAt(a))>55295&&e<57344){if(!o){if(e>56319){(r-=3)>-1&&i.push(239,191,189);continue}if(a+1===n){(r-=3)>-1&&i.push(239,191,189);continue}o=e;continue}if(e<56320){(r-=3)>-1&&i.push(239,191,189),o=e;continue}e=65536+(o-55296<<10|e-56320)}else o&&(r-=3)>-1&&i.push(239,191,189);if(o=null,e<128){if((r-=1)<0)break;i.push(e)}else if(e<2048){if((r-=2)<0)break;i.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;i.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;i.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return i}function j(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(U,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Y(t,r,e,n){for(var o=0;o<n&&!(o+e>=r.length||o>=t.length);++o)r[o+e]=t[o];return o}}).call(this,e(56))},function(t,r,e){"use strict";t.exports=function(t,r){if(!(t.length<2)){for(var e=t[0],n=0,o=1;o<t.length;o++)e!==t[o]&&(n++,e=t[o],t[n]=t[o],o!==n&&(r[n]=0)),o!==n&&(r[n]+=r[o]);t.length=n+1,r.length=n+1}}},function(t,r,e){"use strict";var n=function(t,r,e){return"[ref-"+e+"]"},o=function(t,r){for(var e=0;e<t.length;e++)if(t[e]===r)return e;return-1},i=function(t,r){var e,i,a=r||n,s="function"==typeof t,u=[];return function(r,n){if(u.length){if(~(e=o(u,this))?u=function(t,r){for(var e=new Array(r),n=0;n<r;n++)e[n]=t[n];return e}(u,e+1):u[u.length]=this,~(i=o(u,n)))return a.call(this,r,n,i)}else u[0]=n;return s?t.call(this,r,n):n}};function a(t,r,e,n){return JSON.stringify(t,i(r,n),e)}e.d(r,"a",function(){return a})},function(t,r,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e(21)),i=n(e(22)),a=e(23),s=n(e(62)),u=n(e(51)),h=n(e(55)),f=e(60),l=e(61);const c=1,m=2,g=3;function p(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("number"==typeof t){if(t<1||t>2)throw new Error("kind should either be 1 or 2");return t}return t.match(/abs/i)?c:m}function v(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.label=[{text:r.kind,size:"18px",anchor:"middle",color:"red",position:{x:r.wavelength,y:r.transmittance*e,dy:"23px"}}],t.position=[{x:r.wavelength,y:r.transmittance*e,dy:"10px",dx:"-1px"},{x:r.wavelength,y:r.transmittance*e,dy:"5px",dx:"1px"}]}function d(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!r.wavelength)throw new Error("addPeak: peak mush have wavelength property");if(!r.absorbance&&!r.transmittance)throw new Error("addPeak: peak mush have either absorbance of transmittance property");const e=r.wavelength,n=r.transmittance,o=void 0===n?10**-r.absorbance:n,i=r.absorbance,a=void 0===i?-Math.log10(r.transmittance):i;for(let r of t.peaks)if(Number(r.wavelength)===e)return r;return t.peaks.push({wavelength:e,transmittance:o,absorbance:a,kind:w(o,t.minTransmittance,t.maxTransmittance)}),r}function w(t,r,e){var n=(e-t)/(e-r);return n<.33?"w":n<.66?"m":"S"}function y(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=e.range,o=void 0===n?0:n,i=e.optimize,a=void 0!==i&&i;let s=function(t,r){let e={transmittance:t.transmittance[0],absorbance:t.absorbance[0],wavelength:t.wavelength[0],index:0},n=Math.abs(r-e.wavelength);for(let o=1;o<t.wavelength.length;o++){let i=Math.abs(r-t.wavelength[o]);i<n&&(n=i,b(t,e,o))}return e}(t,r);return a?function(t,r){let e,n=r.index;for(;n!==e;)e=n,n>0&&t.absorbance[n-1]>r.absorbance?b(t,r,--n):n<t.wavelength.length-1&&t.absorbance[n+1]>r.absorbance&&b(t,r,++n)}(t,s):o&&function(t,r,e,n){for(let o=0;o<t.wavelength.length;o++)Math.abs(t.wavelength[o]-e)<=n&&t.transmittance[o]<r.transmittance&&b(t,r,o)}(t,s,r,o),d(t,s)}function b(t,r,e){r.index=e,r.wavelength=t.wavelength[e],r.absorbance=t.absorbance[e],r.transmittance=t.transmittance[e]}function x(t){switch(t){case c:return"Absorbance";case m:return"Transmittance";case g:return"Transmittance [%]";default:return""}}class M{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.wavelength=t.wavelength||[],this.absorbance=t.absorbance||[],this.transmittance=t.transmittance||[],this.mode=g,this.peaks=[],this.clearCache(),function(t){t.transmittance.length>0&&0===t.absorbance.length&&(t.absorbance=t.transmittance.map(t=>-Math.log10(t)));t.absorbance.length>0&&0===t.transmittance.length&&(t.transmittance=t.absorbance.map(t=>10**-t));t.wavelength.length>0&&(t.minWavelength=o(t.wavelength));t.wavelength.length>0&&(t.maxWavelength=i(t.wavelength));t.absorbance.length>0&&(t.minAbsorbance=o(t.absorbance));t.absorbance.length>0&&(t.maxAbsorbance=i(t.absorbance));t.transmittance.length>0&&(t.minTransmittance=o(t.transmittance));t.transmittance.length>0&&(t.maxTransmittance=i(t.transmittance))}(this)}setPeaks(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.peaks=t}setMode(t){if(t<1||t>3)throw new Error("Mode should be either 1 (absorbance), 2 (transmittance) or 3 (percent transmittance)");this.mode=t}peakPicking(t){y(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}getAbsorbance(){return{x:this.wavelength,y:this.absorbance}}getTransmittance(){return{x:this.wavelength,y:this.transmittance}}getPercentTransmittance(){let t=this.getTransmittance();return{x:t.x,y:t.y.map(t=>100*t)}}clearCache(){this.cache={normalized:{hash:""}}}getYLabel(){return x(this.mode)}}M.getYLabel=x,M.prototype.toJSON=function(){return{wavelength:this.wavelength,transmittance:this.transmittance,peaks:this.peaks}},M.prototype.getAnnotations=function(t){return function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const e=r.fillColor,n=void 0===e?"green":e,o=r.strokeColor,i=void 0===o?"red":o,a=r.creationFct,s=t.peaks;return s?s.map(r=>{var e={line:1,type:"rect",strokeColor:i,strokeWidth:0,fillColor:n};switch(a&&a(e,r),t.mode){case c:!function(t,r){t.label=[{text:r.kind,size:"18px",anchor:"middle",color:"red",position:{x:r.wavelength,y:r.absorbance,dy:"-15px"}}],t.position=[{x:r.wavelength,y:r.absorbance,dy:"-10px",dx:"-1px"},{x:r.wavelength,y:r.absorbance,dy:"-5px",dx:"1px"}]}(e,r);break;case m:v(e,r,1);break;case g:v(e,r,100)}return e}):[]}(this,t)},M.prototype.getData=function(t){return function(t){switch((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).mode||t.mode){case c:return t.getAbsorbance();case m:return t.getTransmittance();case g:return t.getPercentTransmittance();default:return{}}}(this,t)},M.prototype.autoPeakPicking=function(t){return function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const e=r.noiseLevel,n=void 0===e?.001:e,o=r.minMaxRatio,i=void 0===o?.05:o,s=r.fromWavelength,u=void 0===s?0:s,h=r.toWavelength,f=void 0===h?5e3:h,l=r.replaceExisting,c=void 0===l||l;let m=a.gsd(t.wavelength,t.absorbance,{noiseLevel:n,minMaxRatio:i,realTopDetection:!0,maxCriteria:!0,smoothY:!1,sgOptions:{windowSize:7,polynomial:3}});if(m=m.filter(t=>t.x>=u&&t.x<=f),c)for(;t.peaks.length;)t.peaks.pop();t:for(let r of m){for(let e of t.peaks)if(Number(e.wavelength)===Number(r.x))continue t;d(t,{wavelength:r.x,absorbance:r.y})}}(this,t)},M.prototype.getNormalized=function(t){return function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=h(r);if(t.cache||(t.cache={}),t.cache.normalized||(t.cache.normalized={}),t.cache.normalized.hash===e)return t.cache.normalized.value;const n=r.from,o=void 0===n?800:n,i=r.to,a=void 0===i?4e3:i,f=r.numberOfPoints,l=void 0===f?1024:f,c=r.applySNV,m=void 0===c||c,g=r.exclusions,p=void 0===g?[]:g;let v=m?u.SNV(t.absorbance):t.absorbance,d=s({x:t.wavelength,y:v},{from:o,to:a,numberOfPoints:l,exclusions:p});return t.cache.normalized={hash:e,value:d},d}(this,t)};function A(t){const r=f.convert(t,{xy:!0});let e=r.spectra[0].data[0];return p(r.spectra[0].yUnit)===m?new M({wavelength:e.x,transmittance:e.y,absorbance:[]}):new M({wavelength:e.x,transmittance:[],absorbance:e.y})}r.ABSORBANCE=c,r.PERCENT_TRANSMITTANCE=g,r.Spectra=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.normalizationOptions=void 0===t.normalization?{from:800,to:4e3,numberOfPoints:1024,applySNV:!0}:t.normalization,this.data=[],this.mode=g}addSpectrum(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.getSpectrumIndex(r);void 0===n&&(n=this.data.length),this.data[n]={normalized:t.getNormalized(this.normalizationOptions),spectrum:t,id:r,meta:e}}addFromJcamp(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1===(arguments.length>3&&void 0!==arguments[3]&&arguments[3])&&this.contains(r))return;let n=A(t);this.addSpectrum(n,r,e)}removeSpectrum(t){let r=this.getSpectrumIndex(t);if(void 0!==r)return this.data.splice(r,1)}contains(t){return!isNaN(this.getSpectrumIndex(t))}getSpectrumIndex(t){if(t)for(let r=0;r<this.data.length;r++)if(this.data[r].id===t)return r}getNormalizedData(){if(!this.data||!this.data[0])return{};let t=[],r=[],e=[];for(let n of this.data)e.push(n.id),t.push(n.normalized.y),r.push(n.meta);return{ids:e,matrix:t,meta:r,x:this.data[0].normalized.x}}getChart(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=t.filter,e=void 0===r?{}:r,n=t.mode,o=void 0===n?this.mode:n;let i={title:"IR spectra superimposition",data:[]};for(let t of this.data)if(!e.ids||e.ids.includes(t.id)){let r=t.spectrum.getData({mode:o});r.styles={unselected:{lineColor:t.meta.color||"darkgrey",lineWidth:1,lineStyle:1},selected:{lineColor:t.meta.color||"darkgrey",lineWidth:3,lineStyle:1}},r.label=t.meta.id||t.id,i.data.push(r)}return i}},r.Spectrum=M,r.TRANSMITTANCE=m,r.fromJcamp=A,r.fromText=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r=Object.assign({},r,{arrayType:"xxyy"});const e=l.parseXY(t,r);return p(r.kind)===m?new M({wavelength:e[0],transmittance:e[1],absorbance:[]}):new M({wavelength:e[0],transmisttance:[],absorbance:e[1]})},r.getYLabel=x},function(t,r,e){"use strict";e.r(r);var n=e(3),o=e.n(n);r.default=function(t){if(!o()(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");for(var r=t[0],e=1;e<t.length;e++)t[e]<r&&(r=t[e]);return r}},function(t,r,e){"use strict";e.r(r);var n=e(3),o=e.n(n);r.default=function(t){if(!o()(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");for(var r=t[0],e=1;e<t.length;e++)t[e]>r&&(r=t[e]);return r}},function(t,r,e){"use strict";t.exports.gsd=e(24),t.exports.post={optimizePeaks:e(29),joinBroadPeaks:e(49),broadenPeaks:e(50)}},function(t,r,e){"use strict";const n=e(25),o={sgOptions:{windowSize:9,polynomial:3},minMaxRatio:25e-5,broadRatio:0,maxCriteria:!0,smoothY:!0,realTopDetection:!1,heightFactor:0,boundaries:!1,derivativeThreshold:-1};t.exports=function(t,r,e){let i=(e=Object.assign({},o,e)).sgOptions;const a=[].concat(r);if(!("noiseLevel"in e)){var s,u=0,h=Number.MAX_VALUE;for(let r=0;r<t.length-1;++r)(s=Math.abs(t[r+1]-t[r]))<h&&(h=s),s>u&&(u=s);e.noiseLevel=(u-h)/u<.05?function(t){var r=0,e=t.length;for(let n=0;n<e;++n)r+=t[n];r/=e;var n=new Array(e);for(let o=0;o<e;++o)n[o]=Math.abs(t[o]-r);return n.sort(),e%2==1?n[(e-1)/2]/.6745:.5*(n[e/2]+n[e/2-1])/.6745}(a):0}const f={m:1,b:e.noiseLevel};e.maxCriteria||(f.m=-1,f.b*=-1);for(let t=0;t<a.length;t++)a[t]=f.m*a[t]-f.b;for(let t=0;t<a.length;t++)a[t]<0&&(a[t]=0);let l,c,m=a;(u-h)/u<.05?(e.smoothY&&(m=n(a,t[1]-t[0],{windowSize:i.windowSize,polynomial:i.polynomial,derivative:0})),l=n(a,t[1]-t[0],{windowSize:i.windowSize,polynomial:i.polynomial,derivative:1}),c=n(a,t[1]-t[0],{windowSize:i.windowSize,polynomial:i.polynomial,derivative:2})):(e.smoothY&&(m=n(a,t,{windowSize:i.windowSize,polynomial:i.polynomial,derivative:0})),l=n(a,t,{windowSize:i.windowSize,polynomial:i.polynomial,derivative:1}),c=n(a,t,{windowSize:i.windowSize,polynomial:i.polynomial,derivative:2}));const g=t,p=t[1]-t[0];var v=0,d=0;for(let t=0;t<m.length;t++)Math.abs(c[t])>v&&(v=Math.abs(c[t])),Math.abs(m[t])>d&&(d=Math.abs(m[t]));var w=null,y=null,b=new Array(m.length-2),x=new Array(m.length),M=new Array(m.length),A=new Array(m.length-2),E=0,R=0,S=0,T=0;for(let t=1;t<m.length-1;++t)Math.abs(l[t])>e.derivativeThreshold&&((l[t]<l[t-1]&&l[t]<=l[t+1]||l[t]<=l[t-1]&&l[t]<l[t+1])&&(y={x:g[t],index:t},p>0&&null!==w&&(x[R++]=w,M[S++]=y)),(l[t]>=l[t-1]&&l[t]>l[t+1]||l[t]>l[t-1]&&l[t]>=l[t+1])&&(w={x:g[t],index:t},p<0&&null!==y&&(x[R++]=w,M[S++]=y))),c[t]<c[t-1]&&c[t]<c[t+1]&&(b[E++]=t,A[T++]=Math.abs(c[t])<=e.broadRatio*v);b.length=E,x.length=R,M.length=S,A.length=T;let _,k,O,C,P,I=new Array(b.length),V=0,N=-1;for(let t=0;t<b.length;++t){k=g[b[t]],_=-1;let r=N+1;for(C=Number.MAX_VALUE,O=0,P=!0;-1===_&&r<x.length&&P;)(O=Math.abs(k-(x[r].x+M[r].x)/2))<C?C=O:P=!1,O<Math.abs(x[r].x-M[r].x)/2&&(_=r,N=r),++r;if(-1!==_&&Math.abs(m[b[t]])>e.minMaxRatio*d&&(I[V++]={index:b[t],x:k,y:(m[b[t]]+f.b)/f.m,width:Math.abs(M[_].x-x[_].x),soft:A[t]},e.boundaries&&(I[V-1].left=x[_],I[V-1].right=M[_]),e.heightFactor)){let t=m[x[_].index],r=m[M[_].index];I[V-1].height=e.heightFactor*(I[V-1].y-(t+r)/2)}}I.length=V,e.realTopDetection&&function(t,r,e){for(var n,o,i,a,s,u=0;u<t.length;u++)s=t[u].index,e[s-1]>=e[s-2]&&e[s-1]>=e[s]?s--:e[s+1]>=e[s]&&e[s+1]>=e[s+2]?s++:e[s-2]>=e[s-3]&&e[s-2]>=e[s-1]?s-=2:e[s+2]>=e[s+1]&&e[s+2]>=e[s+3]&&(s+=2),e[s-1]>0&&e[s+1]>0&&e[s]>=e[s-1]&&e[s]>=e[s+1]&&(n=20*Math.log10(e[s-1]),o=20*Math.log10(e[s]),i=20*Math.log10(e[s+1]),a=.5*(n-i)/(n-2*o+i),t[u].x=r[s]+(r[s]-r[s-1])*a,t[u].y=e[s]-.25*(e[s-1]-e[s+1])*a)}(I,g,m);for(let t=0;t<I.length;t++)I[t].base=e.noiseLevel;return I.sort(function(t,r){return t.x-r.x}),I}},function(t,r,e){var n=e(26),o=(e(27),{windowSize:9,derivative:0,polynomial:3});function i(t,r,e,n){for(var o=0,i=0,a=r-e;a<r+e;a++)a>=0&&a<t.length-1&&(o+=t[a+1]-t[a],i++);return Math.pow(o/i,n)}function a(t,r,e,n){return e>0?(4*e-2)/(e*(2*r-e+1))*(t*a(t,r,e-1,n)+n*a(t,r,e-1,n-1))-(e-1)*(2*r+e)/(e*(2*r-e+1))*a(t,r,e-2,n):0==e&&0==n?1:0}function s(t,r){var e=1;if(t>=r)for(var n=t-r+1;n<=t;n++)e*=n;return e}function u(t,r,e,n,o){for(var i=0,u=0;u<=n;u++)i+=(2*u+1)*(s(2*e,u)/s(2*e+u+1,u+1))*a(t,e,u,0)*a(r,e,u,o);return i}t.exports=function(t,r,e){if((e=n({},o,e)).windowSize%2==0||e.windowSize<5||!Number.isInteger(e.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(e.windowSize>t.length)throw new RangeError("Window size is higher than the data length "+e.windowSize+">"+t.length);if(e.derivative<0||!Number.isInteger(e.derivative))throw new RangeError("Derivative should be a positive integer");if(e.polynomial<1||!Number.isInteger(e.polynomial))throw new RangeError("Polynomial should be a positive integer");e.polynomial>=6&&console.warn("You should not use polynomial grade higher than 5 if you are not sure that your data arises from such a model. Possible polynomial oscillation problems");var a=e.windowSize,s=Math.floor(a/2),h=t.length,f=new Array(h),l=function(t,r,e){for(var n=new Array(t),o=Math.floor(t/2),i=-o;i<=o;i++){n[i+o]=new Array(t);for(var a=-o;a<=o;a++)n[i+o][a+o]=u(a,i,o,r,e)}return n}(a,e.polynomial,e.derivative),c=0,m=!0;"[object Array]"===Object.prototype.toString.call(r)?m=!1:c=Math.pow(r,e.derivative);for(var g=0;g<s;g++){for(var p=l[s-g-1],v=l[s+g+1],d=0,w=0,y=0;y<a;y++)d+=p[y]*t[y],w+=v[y]*t[h-a+y-1];m?(f[s-g-1]=d/c,f[h-s+g]=w/c):(c=i(r,s-g-1,s,e.derivative),f[s-g-1]=d/c,c=i(r,h-s+g,s,e.derivative),f[h-s+g]=w/c)}var b=l[s];for(g=a;g<h+1;g++){var x=0;for(y=0;y<a;y++)x+=b[y]*t[y+g-a];m||(c=i(r,g-s-1,s,e.derivative)),f[g-s-1]=x/c}return f}},function(t,r,e){"use strict";var n=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=Object.defineProperty,a=Object.getOwnPropertyDescriptor,s=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===o.call(t)},u=function(t){if(!t||"[object Object]"!==o.call(t))return!1;var r,e=n.call(t,"constructor"),i=t.constructor&&t.constructor.prototype&&n.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!i)return!1;for(r in t);return void 0===r||n.call(t,r)},h=function(t,r){i&&"__proto__"===r.name?i(t,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):t[r.name]=r.newValue},f=function(t,r){if("__proto__"===r){if(!n.call(t,r))return;if(a)return a(t,r).value}return t[r]};t.exports=function t(){var r,e,n,o,i,a,l=arguments[0],c=1,m=arguments.length,g=!1;for("boolean"==typeof l&&(g=l,l=arguments[1]||{},c=2),(null==l||"object"!=typeof l&&"function"!=typeof l)&&(l={});c<m;++c)if(null!=(r=arguments[c]))for(e in r)n=f(l,e),l!==(o=f(r,e))&&(g&&o&&(u(o)||(i=s(o)))?(i?(i=!1,a=n&&s(n)?n:[]):a=n&&u(n)?n:{},h(l,{name:e,newValue:t(g,a,o)})):void 0!==o&&h(l,{name:e,newValue:o}));return l}},function(t,r,e){"use strict";r.array=e(10),r.matrix=e(28)},function(t,r,e){"use strict";var n=e(10);function o(t,r){void 0===r&&(r=0);var e,n,o,i,a=t.length,s=t[0].length;if(-1===r){for(e=[0],n=a*s,o=0;o<a;o++)for(i=0;i<s;i++)e[0]+=t[o][i];e[0]/=n}else if(0===r)for(e=new Array(s),n=a,i=0;i<s;i++){for(e[i]=0,o=0;o<a;o++)e[i]+=t[o][i];e[i]/=n}else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(a),n=s,i=0;i<a;i++){for(e[i]=0,o=0;o<s;o++)e[i]+=t[i][o];e[i]/=n}}return e}function i(t,r,e){for(var n=a(t,r,e),o=n.length,i=0;i<o;i++)n[i]=Math.sqrt(n[i]);return n}function a(t,r,e){void 0===e&&(e=!0),r=r||o(t);var n=t.length;if(0===n)return[];for(var i=t[0].length,a=new Array(i),s=0;s<i;s++){for(var u=0,h=0,f=0,l=0;l<n;l++)u+=f=t[l][s]-r[s],h+=f*f;a[s]=e?(h-u*u/n)/(n-1):(h-u*u/n)/n}return a}function s(t,r,e){void 0===e&&(e=0),void 0===r&&(0===e?r=t.length-1:1===e&&(r=t[0].length-1));var n=o(t,e),i=t.length;if(0===i)return[[]];var a,s,u,h,f,l=t[0].length;if(0===e){for(a=new Array(l),s=0;s<l;s++)a[s]=new Array(l);for(s=0;s<l;s++)for(u=s;u<l;u++){for(h=0,f=0;f<i;f++)h+=(t[f][u]-n[u])*(t[f][s]-n[s]);h/=r,a[s][u]=h,a[u][s]=h}}else{if(1!==e)throw new Error("Invalid dimension");for(a=new Array(i),s=0;s<i;s++)a[s]=new Array(i);for(s=0;s<i;s++)for(u=s;u<i;u++){for(h=0,f=0;f<l;f++)h+=(t[u][f]-n[u])*(t[s][f]-n[s]);h/=r,a[s][u]=h,a[u][s]=h}}return a}function u(t,r,e){return r=r||o(t),void 0===e&&(e=i(t,!0,r)),f(h(t,r,!1),e,!0)}function h(t,r,e){r=r||o(t);var n,i,a,s=t,u=t.length;if(!e)for(s=new Array(u),n=0;n<u;n++)s[n]=new Array(t[n].length);for(n=0;n<u;n++){var h=s[n];for(i=0,a=h.length;i<a;i++)h[i]=t[n][i]-r[i]}return s}function f(t,r,e){void 0===r&&(r=i(t));var n,o,a,s=t,u=t.length;if(!e)for(s=new Array(u),n=0;n<u;n++)s[n]=new Array(t[n].length);for(n=0;n<u;n++){var h=s[n],f=t[n];for(o=0,a=h.length;o<a;o++)0===r[o]||isNaN(r[o])||(h[o]=f[o]/r[o])}return s}function l(t,r,e){void 0===e&&(e=0);var o=t.length;if(0===o)return[];var i,a,s,u,h,f,l=t[0].length;if(0===e){for(i=new Array(l),a=0;a<l;a++)i[a]=0;for(a=0;a<o;a++)for(f=t[a],h=r[a],u=0;u<l;u++)i[u]+=f[u]*h}else{if(1!==e)throw new Error("Invalid dimension");for(i=new Array(o),a=0;a<o;a++)i[a]=0;for(u=0;u<o;u++)for(f=t[u],h=r[u],a=0;a<l;a++)i[u]+=f[a]*h}var c=n.sum(r);if(0!==c)for(a=0,s=i.length;a<s;a++)i[a]/=c;return i}function c(t,r,e,n,o){o=o||0,e=e||l(t,r,o),void 0===n&&(n=1);var i=t.length;if(0===i)return[[]];var a,s,u,h,f,c=t[0].length;if(0===o){for(a=new Array(c),s=0;s<c;s++)a[s]=new Array(c);for(s=0;s<c;s++)for(u=s;u<c;u++){for(f=0,h=0;h<i;h++)f+=r[h]*(t[h][u]-e[u])*(t[h][s]-e[s]);a[s][u]=f*n,a[u][s]=f*n}}else{if(1!==o)throw new Error("Invalid dimension");for(a=new Array(i),s=0;s<i;s++)a[s]=new Array(i);for(s=0;s<i;s++)for(u=s;u<i;u++){for(f=0,h=0;h<c;h++)f+=r[h]*(t[u][h]-e[u])*(t[s][h]-e[s]);a[s][u]=f*n,a[u][s]=f*n}}return a}t.exports={entropy:function(t,r){void 0===r&&(r=0);for(var e=0,n=t.length,o=t[0].length,i=0;i<n;i++)for(var a=0;a<o;a++)e+=t[i][a]*Math.log(t[i][a]+r);return-e},mean:o,standardDeviation:i,variance:a,median:function(t){for(var r=t.length,e=t[0].length,n=new Array(e),o=0;o<e;o++){for(var i=new Array(r),a=0;a<r;a++)i[a]=t[a][o];i.sort();var s=i.length;n[o]=s%2==0?.5*(i[s/2]+i[s/2-1]):i[Math.floor(s/2)]}return n},mode:function(t){var r,e,n=t.length,o=t[0].length,i=new Array(o);for(r=0;r<o;r++){for(var a=new Array(n),s=0;s<n;s++)a[s]=0;var u=new Array(n),h=0;for(e=0;e<n;e++){var f=u.indexOf(t[e][r]);f>=0?a[f]++:(u[h]=t[e][r],a[h]=1,h++)}var l=0,c=0;for(e=0;e<h;e++)a[e]>l&&(l=a[e],c=e);i[r]=u[c]}return i},skewness:function(t,r){void 0===r&&(r=!0);for(var e=o(t),n=t.length,i=e.length,a=new Array(i),s=0;s<i;s++){for(var u=0,h=0,f=0;f<n;f++){var l=t[f][s]-e[s];u+=l*l,h+=l*l*l}var c=u/n,m=h/n/Math.pow(c,1.5);if(r){var g=Math.sqrt(n*(n-1)),p=n-2;a[s]=g/p*m}else a[s]=m}return a},kurtosis:function(t,r){void 0===r&&(r=!0);for(var e=o(t),n=t.length,i=t[0].length,a=new Array(i),s=0;s<i;s++){for(var u=0,h=0,f=0;f<n;f++){var l=t[f][s]-e[s];u+=l*l,h+=l*l*l*l}var c=u/n,m=h/n;if(r){var g=u/(n-1),p=n*(n+1)/((n-1)*(n-2)*(n-3)),v=h/(g*g),d=(n-1)*(n-1)/((n-2)*(n-3));a[s]=p*v-3*d}else a[s]=m/(c*c)-3}return a},standardError:function(t){for(var r=t.length,e=i(t),n=e.length,o=new Array(n),a=Math.sqrt(r),s=0;s<n;s++)o[s]=e[s]/a;return o},covariance:function(t,r){return s(t,void 0,r)},scatter:s,correlation:function(t){var r,e,n=o(t),a=u(t,n,i(t,!0,n)),s=t.length,h=t[0].length,f=new Array(h);for(r=0;r<h;r++)f[r]=new Array(h);for(r=0;r<h;r++)for(e=r;e<h;e++){for(var l=0,c=0,m=a.length;c<m;c++)l+=a[c][e]*a[c][r];l/=s-1,f[r][e]=l,f[e][r]=l}return f},zScores:u,center:h,standardize:f,weightedVariance:function(t,r){var e=o(t),n=t.length;if(0===n)return[];for(var i=t[0].length,a=new Array(i),s=0;s<i;s++){for(var u=0,h=0,f=0,l=0;l<n;l++){var c=t[l][s]-e[s],m=r[l];u+=m*(c*c),f+=m,h+=m*m}a[s]=u*(f/(f*f-h))}return a},weightedMean:l,weightedCovariance:function(t,r,e,n){n=n||0,e=e||l(t,r,n);for(var o=0,i=0,a=0,s=r.length;a<s;a++)o+=r[a],i+=r[a]*r[a];return c(t,r,e,o/(o*o-i),n)},weightedScatter:c}},function(t,r,e){"use strict";var n=e(11);function o(t,r,e,n,o){var i=e.length,a=[],s=[],u=Math.sign(e[1]-e[0]);-1===u&&(o[0]=e.length-1);for(var h=Math.abs(r-t)/2,f=(t+r)/2,l=!1,c=o[0];!l&&c<i&&c>=0;)Math.abs(e[c]-f)<=h?(a.push(e[c]),s.push(n[c]),c+=u):1===Math.sign(f-e[c])?c+=u:l=!0;return o[0]=c,[a,s]}t.exports=function(t,r,e,i,a){var s,u,h,f,l,c=[0],m=function(t,r){var e,n,o,i,a=[],s=[],u=[t[0].x,r*t[0].width];for(e=0;e<t.length;e++)Math.abs(t[e].x-u[0])<r*t[e].width+u[1]?(a.push(t[e]),o=u[0]+u[1],t[e].x+r*t[e].width>o&&(o=t[e].x+r*t[e].width),i=u[0]-u[1],t[e].x-r*t[e].width<i&&(i=t[e].x-r*t[e].width),u=[(o+i)/2,Math.abs(o-i)/2]):(s.push({limits:u,group:a}),a=[t[e]],u=[t[e].x,r*t[e].width]);for(s.push({limits:u,group:a}),e=s.length-2;e>=0;e--)if(Math.abs(s[e].limits[0]-s[e+1].limits[0])<(s[e].limits[1]+s[e+1].limits[1])/2){for(n=0;n<s[e+1].group.length;n++)s[e].group.push(s[e+1].group[n]);o=s[e].limits[0]+s[e].limits[1],s[e+1].limits[0]+s[e+1].limits[1]>o&&(o=s[e+1].limits[0]+s[e+1].limits[1]),i=s[e].limits[0]-s[e].limits[1],s[e+1].limits[0]-s[e+1].limits[1]<i&&(i=s[e+1].limits[0]-s[e+1].limits[1]),s[e].limits=[(o+i)/2,Math.abs(o-i)/2],s.splice(e+1,1)}return s}(t,i),g=[],p=1;for("gaussian"===a&&(p=1.17741),s=0;s<m.length;s++){var v=m[s].group;if(v.length>1){if((h=o(m[s].limits[0]-m[s].limits[1],m[s].limits[0]+m[s].limits[1],r,e,c))[0].length>5){l=[3,100,f=v[0].width/1e3,f,f,10*f,10*f,11,9,1];var d=[];for("gaussian"===a?d=n.optimizeGaussianSum(h,v,l):"lorentzian"===a&&(d=n.optimizeLorentzianSum(h,v,l)),u=0;u<d.length;u++)g.push({x:d[u][0][0],y:d[u][1][0],width:d[u][2][0]*p})}}else if((h=o((v=v[0]).x-i*v.width,v.x+i*v.width,r,e,c))[0].length>5){l=[3,100,f=v.width/1e3,f,f,10*f,10*f,11,9,1];var w=[];"gaussian"===a?w=n.optimizeSingleGaussian([h[0],h[1]],v,l):"lorentzian"===a&&(w=n.optimizeSingleLorentzian([h[0],h[1]],v,l)),g.push({x:w[0][0],y:w[1][0],width:w[2][0]*p})}}return g}},function(t,r,e){"use strict";t.exports=e(31),t.exports.Matrix=e(5),t.exports.Matrix.algebra=e(16)},function(t,r,e){var n=e(5),o=e(16),i={optimize:function(t,r,e,i,a,s,u,h,f,l){var c=0;if("object"!=typeof r[0])for(var m=0;m<r.length;m++)r[m]=[r[m]];var g=r.length,p=i.length,v=n.zeros(g,1),d=n.zeros(p,1),w=-2e-4,y=-2e-4,b=n.zeros(p,g);if(e.length==i.length){a=a||Math.sqrt((p-g+1)/o.multiply(o.transpose(i),i)),s=s||.001,u=u||o.multiply(Math.abs(r),-100),h=h||o.multiply(Math.abs(r),100),f=f||1;(l=l||[3,10*g,.001,.001,.001,.01,.01,11,9,1])[0];var x=l[1],M=l[2],A=(l[3],l[4],l[5]),E=l[6],R=l[7],S=l[8],T=l[9];if(!s.length||1==s.length){var _=new Array(g);for(m=0;m<g;m++)_[m]=[s];s=_}var k=[];for(m=0;m<s.length;m++)0!=s[m][0]&&k.push(m);var O=k.length,C=!1,P=null;if(!a.length||a.length<p){var I=o.multiply(n.ones(p,1),a[0]);P=o.dotMultiply(I,I)}else P=o.dotMultiply(a,a);var V=this.lm_matx(t,e,v,d,1,b,r,i,P,s,f),N=V.JtWJ,D=V.JtWdy,z=(w=V.Chi_sq,V.y_hat);b=V.J;switch(Math.max(Math.abs(D))<M&&(console.log(" *** Your Initial Guess is Extremely Close to Optimal ***"),console.log(" *** epsilon_1 = ",M),C=!0),T){case 1:lambda=E;break;default:lambda=E*Math.max(o.diag(N)),nu=2}y=w;for(var U=null;!C&&c<=x;){switch(c+=1,T){case 1:U=o.solve(o.add(N,o.multiply(o.diag(o.diag(N)),lambda)),D);break;default:U=o.solve(o.add(N,o.multiply(n.eye(g),lambda)),D)}var F=new Array(k.length);for(X=0;X<k.length;X++)F[X]=U[k[X]];var L=o.add(r,F);for(X=0;X<L.length;X++)L[X][0]=Math.min(Math.max(u[X][0],L[X][0]),h[X][0]);var j=o.subtract(i,t(e,L,f)),Y=o.multiply(o.transpose(j),o.dotMultiply(j,P));if(2==T){var q=o.multiply(o.transpose(D),U),B=o.multiply(q,o.inv(o.add(o.multiply(o.subtract(Y-w),.5)),o.multiply(q,2)));U=o.multiply(B,U);for(var X=0;X<k.length;X++)F[X]=U[k[X]];L=o.add(r,F),L=o.min(o.max(u,L),h),j=o.subtract(i,t(e,L,f)),Y=o.multiply(o.transpose(j),mat.dotMultiply(j,P))}var W=(w-Y)/o.multiply(o.multiply(o.transpose(U),2),o.add(o.multiply(lambda,U),D));if(W>A)switch(dX2=w-y,y=w,v=r,d=z,r=L,N=(V=this.lm_matx(t,e,v,d,dX2,b,r,i,P,s,f)).JtWJ,D=V.JtWdy,w=V.Chi_sq,z=V.y_hat,b=V.J,T){case 1:lambda=Math.max(lambda/S,1e-7);break;case 2:lambda=Math.max(lambda/(1+B),1e-7);break;case 3:lambda=o.multiply(Math.max(1/3,1-(2*W-1)^3),lambda),nu=2}else switch(w=y,c%(2*g)==0&&(N=(V=this.lm_matx(t,e,v,d,-1,b,r,i,P,s,f)).JtWJ,D=V.JtWdy,dX2=V.Chi_sq,z=V.y_hat,b=V.J),T){case 1:lambda=Math.min(lambda*R,1e7);break;case 2:lambda+=Math.abs((Y-w)/2/B);break;case 3:lambda*=nu,nu*=2}}return(P=o.multiply(o.multiply(o.transpose(j),j),n.ones(p,1))).apply(function(t,r){P[t][r]=(p-O+1)/P[t][r]}),N=(V=this.lm_matx(t,e,v,d,-1,b,r,i,P,s,f)).JtWJ,D=V.JtWdy,w=V.Chi_sq,z=V.y_hat,b=V.J,{p:r,X2:w}}console.log("lm.m error: the length of t must equal the length of y_dat"),length_t=e.length,length_y_dat=i.length;var w=0},lm_FD_J:function(t,r,e,i,a,s){var u=i.length,h=e.length;a=a||o.multiply(n.ones(h,1),.001);for(var f=e.clone(),l=new n(u,h),c=new Array(h),m=0;m<h;m++){if(c[m]=a[m]*(1+Math.abs(e[m][0])),e[m]=[f[m][0]+c[m]],0!=c[m])if(y1=t(r,e,s),a[m][0]<0)for(var g=o.dotDivide(o.subtract(y1,i),c[m]),p=0;p<u;p++)l[p][m]=g[p][0];else{e[m][0]=f[m][0]-c[m];for(g=o.dotDivide(o.subtract(y1,t(r,e,s)),2*c[m]),p=0;p<u;p++)l[p][m]=g[p][0]}e[m]=f[m]}return l},lm_Broyden_J:function(t,r,e,n,i){var a=o.subtract(n,t),s=o.transpose(a);return s.div(o.multiply(s,a)),e=o.add(e,o.multiply(o.subtract(i,o.add(r,o.multiply(e,a))),s))},lm_matx:function(t,r,e,i,a,s,u,h,f,l,c,m){h.length;var g=u.length;l=l||.001;var p=t(r,u,c);s=m%(2*g)==0||a>0?this.lm_FD_J(t,r,u,p,l,c):this.lm_Broyden_J(e,i,s,u,p);var v=o.subtract(h,p),d=o.multiply(o.transpose(v),o.dotMultiply(v,f)),w=o.transpose(s);return{JtWJ:o.multiply(w,o.dotMultiply(s,o.multiply(f,n.ones(1,g)))),JtWdy:o.multiply(w,o.dotMultiply(f,v)),Chi_sq:d,y_hat:p,J:s}}};t.exports=i},function(t,r,e){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(t,r,e){t.exports=r=e(34),r.getEquallySpacedData=e(36).getEquallySpacedData,r.SNV=e(37).SNV},function(t,r,e){"use strict";const n=e(6).array;function o(t){for(var r=new Array(t[0].length),e=0;e<r.length;++e)r[e]=new Array(t.length);for(e=0;e<t.length;++e)for(var n=0;n<t[0].length;++n)r[n][e]=t[e][n];return r}t.exports={coordArrayToPoints:function(t,r){if(t.length%r!=0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var e=t.length/r,n=new Array(e),o=0,i=0;i<t.length;i+=r){for(var a=new Array(r),s=0;s<r;++s)a[s]=t[i+s];n[o]=a,o++}return n},coordArrayToCoordMatrix:function(t,r){if(t.length%r!=0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var e=new Array(r),n=t.length/r,o=0;o<e.length;o++)e[o]=new Array(n);for(o=0;o<t.length;o+=r)for(var i=0;i<r;++i){var a=Math.floor(o/r);e[i][a]=t[o+i]}return e},coordMatrixToCoordArray:function(t){for(var r=new Array(t.length*t[0].length),e=0,n=0;n<t[0].length;++n)for(var o=0;o<t.length;++o)r[e]=t[o][n],++e;return r},coordMatrixToPoints:o,pointsToCoordArray:function(t){for(var r=new Array(t.length*t[0].length),e=0,n=0;n<t.length;++n)for(var o=0;o<t[0].length;++o)r[e]=t[n][o],++e;return r},pointsToCoordMatrix:o,applyDotProduct:function(t,r){var e,n;t.length<=r.length?(n=t,e=r):(n=r,e=t);for(var o=e.length-n.length+1,i=new Array(o),a=0;a<o;++a){for(var s=0,u=0;u<n.length;++u)s+=n[u]*e[a+u];i[a]=s}return i},scale:function(t,r){var e;e=r.inPlace?t:new Array(t.length);const o=r.max,i=r.min;if("number"==typeof o)if("number"==typeof i)for(var a=n.minMax(t),s=(o-i)/(a.max-a.min),u=0;u<e.length;u++)e[u]=(t[u]-a.min)*s+i;else for(s=o/n.max(t),u=0;u<e.length;u++)e[u]=t[u]*s;else if("number"==typeof i)for(s=i/n.min(t),u=0;u<e.length;u++)e[u]=t[u]*s;return e}}},function(t,r,e){"use strict";var n=e(15);function o(t,r){return t-r}r.max=function(t){for(var r=-1/0,e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++)t[e][n]>r&&(r=t[e][n]);return r},r.min=function(t){for(var r=1/0,e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++)t[e][n]<r&&(r=t[e][n]);return r},r.minMax=function(t){for(var r=1/0,e=-1/0,n=0;n<t.length;n++)for(var o=0;o<t[n].length;o++)t[n][o]<r&&(r=t[n][o]),t[n][o]>e&&(e=t[n][o]);return{min:r,max:e}},r.entropy=function(t,r){void 0===r&&(r=0);for(var e=0,n=t.length,o=t[0].length,i=0;i<n;i++)for(var a=0;a<o;a++)e+=t[i][a]*Math.log(t[i][a]+r);return-e},r.mean=function(t,r){void 0===r&&(r=0);var e,n,o,i,a=t.length,s=t[0].length;if(-1===r){for(e=[0],n=a*s,o=0;o<a;o++)for(i=0;i<s;i++)e[0]+=t[o][i];e[0]/=n}else if(0===r)for(e=new Array(s),n=a,i=0;i<s;i++){for(e[i]=0,o=0;o<a;o++)e[i]+=t[o][i];e[i]/=n}else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(a),n=s,i=0;i<a;i++){for(e[i]=0,o=0;o<s;o++)e[i]+=t[i][o];e[i]/=n}}return e},r.sum=function(t,r){void 0===r&&(r=0);var e,n,o,i=t.length,a=t[0].length;if(-1===r)for(e=[0],n=0;n<i;n++)for(o=0;o<a;o++)e[0]+=t[n][o];else if(0===r)for(e=new Array(a),o=0;o<a;o++)for(e[o]=0,n=0;n<i;n++)e[o]+=t[n][o];else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(i),o=0;o<i;o++)for(e[o]=0,n=0;n<a;n++)e[o]+=t[o][n]}return e},r.product=function(t,r){void 0===r&&(r=0);var e,n,o,i=t.length,a=t[0].length;if(-1===r)for(e=[1],n=0;n<i;n++)for(o=0;o<a;o++)e[0]*=t[n][o];else if(0===r)for(e=new Array(a),o=0;o<a;o++)for(e[o]=1,n=0;n<i;n++)e[o]*=t[n][o];else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(i),o=0;o<i;o++)for(e[o]=1,n=0;n<a;n++)e[o]*=t[o][n]}return e},r.standardDeviation=function(t,e,n){for(var o=r.variance(t,e,n),i=o.length,a=0;a<i;a++)o[a]=Math.sqrt(o[a]);return o},r.variance=function(t,e,n){void 0===n&&(n=!0),e=e||r.mean(t);var o=t.length;if(0===o)return[];for(var i=t[0].length,a=new Array(i),s=0;s<i;s++){for(var u=0,h=0,f=0,l=0;l<o;l++)u+=f=t[l][s]-e[s],h+=f*f;a[s]=n?(h-u*u/o)/(o-1):(h-u*u/o)/o}return a},r.median=function(t){for(var r=t.length,e=t[0].length,n=new Array(e),i=0;i<e;i++){for(var a=new Array(r),s=0;s<r;s++)a[s]=t[s][i];a.sort(o);var u=a.length;n[i]=u%2==0?.5*(a[u/2]+a[u/2-1]):a[Math.floor(u/2)]}return n},r.mode=function(t){var r,e,n=t.length,o=t[0].length,i=new Array(o);for(r=0;r<o;r++){for(var a=new Array(n),s=0;s<n;s++)a[s]=0;var u=new Array(n),h=0;for(e=0;e<n;e++){var f=u.indexOf(t[e][r]);f>=0?a[f]++:(u[h]=t[e][r],a[h]=1,h++)}var l=0,c=0;for(e=0;e<h;e++)a[e]>l&&(l=a[e],c=e);i[r]=u[c]}return i},r.skewness=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=t.length,i=n.length,a=new Array(i),s=0;s<i;s++){for(var u=0,h=0,f=0;f<o;f++){var l=t[f][s]-n[s];u+=l*l,h+=l*l*l}var c=u/o,m=h/o/Math.pow(c,1.5);if(e){var g=Math.sqrt(o*(o-1)),p=o-2;a[s]=g/p*m}else a[s]=m}return a},r.kurtosis=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=t.length,i=t[0].length,a=new Array(i),s=0;s<i;s++){for(var u=0,h=0,f=0;f<o;f++){var l=t[f][s]-n[s];u+=l*l,h+=l*l*l*l}var c=u/o,m=h/o;if(e){var g=u/(o-1),p=o*(o+1)/((o-1)*(o-2)*(o-3)),v=h/(g*g),d=(o-1)*(o-1)/((o-2)*(o-3));a[s]=p*v-3*d}else a[s]=m/(c*c)-3}return a},r.standardError=function(t){for(var e=t.length,n=r.standardDeviation(t),o=n.length,i=new Array(o),a=Math.sqrt(e),s=0;s<o;s++)i[s]=n[s]/a;return i},r.covariance=function(t,e){return r.scatter(t,void 0,e)},r.scatter=function(t,e,n){void 0===n&&(n=0),void 0===e&&(0===n?e=t.length-1:1===n&&(e=t[0].length-1));var o=r.mean(t,n),i=t.length;if(0===i)return[[]];var a,s,u,h,f,l=t[0].length;if(0===n){for(a=new Array(l),s=0;s<l;s++)a[s]=new Array(l);for(s=0;s<l;s++)for(u=s;u<l;u++){for(h=0,f=0;f<i;f++)h+=(t[f][u]-o[u])*(t[f][s]-o[s]);h/=e,a[s][u]=h,a[u][s]=h}}else{if(1!==n)throw new Error("Invalid dimension");for(a=new Array(i),s=0;s<i;s++)a[s]=new Array(i);for(s=0;s<i;s++)for(u=s;u<i;u++){for(h=0,f=0;f<l;f++)h+=(t[u][f]-o[u])*(t[s][f]-o[s]);h/=e,a[s][u]=h,a[u][s]=h}}return a},r.correlation=function(t){var e,n,o=r.mean(t),i=r.standardDeviation(t,!0,o),a=r.zScores(t,o,i),s=t.length,u=t[0].length,h=new Array(u);for(e=0;e<u;e++)h[e]=new Array(u);for(e=0;e<u;e++)for(n=e;n<u;n++){for(var f=0,l=0,c=a.length;l<c;l++)f+=a[l][n]*a[l][e];f/=s-1,h[e][n]=f,h[n][e]=f}return h},r.zScores=function(t,e,n){return e=e||r.mean(t),void 0===n&&(n=r.standardDeviation(t,!0,e)),r.standardize(r.center(t,e,!1),n,!0)},r.center=function(t,e,n){e=e||r.mean(t);var o,i,a,s=t,u=t.length;if(!n)for(s=new Array(u),o=0;o<u;o++)s[o]=new Array(t[o].length);for(o=0;o<u;o++){var h=s[o];for(i=0,a=h.length;i<a;i++)h[i]=t[o][i]-e[i]}return s},r.standardize=function(t,e,n){void 0===e&&(e=r.standardDeviation(t));var o,i,a,s=t,u=t.length;if(!n)for(s=new Array(u),o=0;o<u;o++)s[o]=new Array(t[o].length);for(o=0;o<u;o++){var h=s[o],f=t[o];for(i=0,a=h.length;i<a;i++)0===e[i]||isNaN(e[i])||(h[i]=f[i]/e[i])}return s},r.weightedVariance=function(t,e){var n=r.mean(t),o=t.length;if(0===o)return[];for(var i=t[0].length,a=new Array(i),s=0;s<i;s++){for(var u=0,h=0,f=0,l=0;l<o;l++){var c=t[l][s]-n[s],m=e[l];u+=m*(c*c),f+=m,h+=m*m}a[s]=u*(f/(f*f-h))}return a},r.weightedMean=function(t,r,e){void 0===e&&(e=0);var o=t.length;if(0===o)return[];var i,a,s,u,h,f,l=t[0].length;if(0===e){for(i=new Array(l),a=0;a<l;a++)i[a]=0;for(a=0;a<o;a++)for(f=t[a],h=r[a],u=0;u<l;u++)i[u]+=f[u]*h}else{if(1!==e)throw new Error("Invalid dimension");for(i=new Array(o),a=0;a<o;a++)i[a]=0;for(u=0;u<o;u++)for(f=t[u],h=r[u],a=0;a<l;a++)i[u]+=f[a]*h}var c=n.sum(r);if(0!==c)for(a=0,s=i.length;a<s;a++)i[a]/=c;return i},r.weightedCovariance=function(t,e,n,o){o=o||0,n=n||r.weightedMean(t,e,o);for(var i=0,a=0,s=0,u=e.length;s<u;s++)i+=e[s],a+=e[s]*e[s];var h=i/(i*i-a);return r.weightedScatter(t,e,n,h,o)},r.weightedScatter=function(t,e,n,o,i){i=i||0,n=n||r.weightedMean(t,e,i),void 0===o&&(o=1);var a=t.length;if(0===a)return[[]];var s,u,h,f,l,c=t[0].length;if(0===i){for(s=new Array(c),u=0;u<c;u++)s[u]=new Array(c);for(u=0;u<c;u++)for(h=u;h<c;h++){for(l=0,f=0;f<a;f++)l+=e[f]*(t[f][h]-n[h])*(t[f][u]-n[u]);s[u][h]=l*o,s[h][u]=l*o}}else{if(1!==i)throw new Error("Invalid dimension");for(s=new Array(a),u=0;u<a;u++)s[u]=new Array(a);for(u=0;u<a;u++)for(h=u;h<a;h++){for(l=0,f=0;f<c;f++)l+=e[f]*(t[h][f]-n[h])*(t[u][f]-n[u]);s[u][h]=l*o,s[h][u]=l*o}}return s}},function(t,r,e){"use strict";function n(t,r,e,n){return.5*e*r*r+n*r-(.5*e*t*t+n*t)}r.getEquallySpacedData=function(t,r,e){if(t.length>1&&t[0]>t[1]&&(t=t.slice().reverse(),r=r.slice().reverse()),t.length!==r.length)throw new RangeError("the x and y vector doesn't have the same size.");void 0===e&&(e={});var o=void 0===e.from?t[0]:e.from;if(isNaN(o)||!isFinite(o))throw new RangeError("'From' value must be a number");var i=void 0===e.to?t[t.length-1]:e.to;if(isNaN(i)||!isFinite(i))throw new RangeError("'To' value must be a number");var a=o>i;if(a){var s=o;o=i,i=s}var u=void 0===e.numberOfPoints?100:e.numberOfPoints;if(isNaN(u)||!isFinite(u))throw new RangeError("'Number of points' value must be a number");if(u<1)throw new RangeError("the number of point must be higher than 1");var h="slot"==("slot"===e.variant?"slot":"smooth")?function(t,r,e,n,o){var i=t.length,a=(n-e)/(o-1),s=a/2,u=t[t.length-1]-t[t.length-2],h=e-s,f=new Array(o),l=h,c=h+a,m=-Number.MAX_VALUE,g=0,p=t[0],v=r[0],d=0,w=!0,y=0,b=0,x=1,M=0;t:for(;;){if(m>=p)throw new Error("x must be an increasing serie");for(;m-c>0;){if(w&&(b++,w=!1),f[M]=b<=0?0:y/b,++M===o)break t;l=c,c+=a,y=0,b=0}m>l&&(y+=g,b++),(m===-Number.MAX_VALUE||d>1)&&b--,m=p,g=v,x<i?(p=t[x],v=r[x],x++):(p+=u,v=0,d++)}return f}(t,r,o,i,u):function(t,r,e,o,i){var a=t.length,s=(o-e)/(i-1),u=e-s/2,h=new Array(i),f=t[1]-t[0],l=t[t.length-1]-t[t.length-2],c=u,m=u+s,g=Number.MIN_VALUE,p=0,v=t[0]-f,d=0,w=0,y=0,b=0,x=0,M=0,A=0,E=0;t:for(;;){for(;v-m>=0;){var R=n(0,m-g,y,p);if(M=w+R,h[E]=(M-x)/s,++E===i)break t;c=m,m+=s,x=M}g<=c&&c<=v&&(R=n(0,c-g,y,p),x=w+R),w+=n(g,v,y,b),g=v,p=d,A<a?(v=t[A],d=r[A],A++):A===a&&(v+=l,d=0),b=-(y=(d-p)/(v-g))*g+p}return h}(t,r,o,i,u);return a?h.reverse():h},r.integral=n},function(t,r,e){"use strict";r.SNV=function(t){for(var r=n.mean(t),e=n.standardDeviation(t),o=t.slice(),i=0;i<t.length;i++)o[i]=(o[i]-r)/e;return o};var n=e(6).array},function(t,r,e){"use strict";var n=e(2);t.exports=class extends n{constructor(t){super(t,t.columns,t.rows)}set(t,r,e){return this.matrix.set(r,t,e),this}get(t,r){return this.matrix.get(r,t)}}},function(t,r,e){"use strict";var n=e(2);t.exports=class extends n{constructor(t,r){super(t,1,t.columns),this.row=r}set(t,r,e){return this.matrix.set(this.row,r,e),this}get(t,r){return this.matrix.get(this.row,r)}}},function(t,r,e){"use strict";var n=e(2),o=e(7);t.exports=class extends n{constructor(t,r,e,n,i){o.checkRange(t,r,e,n,i),super(t,e-r+1,i-n+1),this.startRow=r,this.startColumn=n}set(t,r,e){return this.matrix.set(this.startRow+t,this.startColumn+r,e),this}get(t,r){return this.matrix.get(this.startRow+t,this.startColumn+r)}}},function(t,r,e){"use strict";var n=e(2),o=e(7);t.exports=class extends n{constructor(t,r,e){var n=o.checkIndices(t,r,e);super(t,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(t,r,e){return this.matrix.set(this.rowIndices[t],this.columnIndices[r],e),this}get(t,r){return this.matrix.get(this.rowIndices[t],this.columnIndices[r])}}},function(t,r,e){"use strict";var n=e(2);t.exports=class extends n{constructor(t,r){super(t,t.rows,1),this.column=r}set(t,r,e){return this.matrix.set(t,this.column,e),this}get(t){return this.matrix.get(t,this.column)}}},function(t,r,e){"use strict";var n=e(2);t.exports=class extends n{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(this.rows-t-1,r,e),this}get(t,r){return this.matrix.get(this.rows-t-1,r)}}},function(t,r,e){"use strict";var n=e(2);t.exports=class extends n{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(t,this.columns-r-1,e),this}get(t,r){return this.matrix.get(t,this.columns-r-1)}}},function(t,r,e){"use strict";var n=e(1).Matrix,o=e(14),i=e(46),a=e(13),s=e(47),u=e(48);function h(t){return f(t=n.checkMatrix(t),n.eye(t.rows))}function f(t,r){return t=n.checkMatrix(t),r=n.checkMatrix(r),t.isSquare()?new a(t).solve(r):new s(t).solve(r)}n.inverse=n.inv=h,n.prototype.inverse=n.prototype.inv=function(){return h(this)},n.solve=f,n.prototype.solve=function(t){return f(this,t)},t.exports={SingularValueDecomposition:o,SVD:o,EigenvalueDecomposition:i,EVD:i,LuDecomposition:a,LU:a,QrDecomposition:s,QR:s,CholeskyDecomposition:u,CHO:u,inverse:h,solve:f}},function(t,r,e){"use strict";const n=e(1).Matrix,o=e(8),i=o.hypotenuse,a=o.getFilled2DArray,s={assumeSymmetric:!1};function u(t,r){if(r=Object.assign({},s,r),!(this instanceof u))return new u(t,r);if(!(t=n.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var e,o,f=t.columns,l=a(f,f,0),c=new Array(f),m=new Array(f),g=t;if(!!r.assumeSymmetric||t.isSymmetric()){for(e=0;e<f;e++)for(o=0;o<f;o++)l[e][o]=g.get(e,o);!function(t,r,e,n){var o,i,a,s,u,h,f,l;for(u=0;u<t;u++)e[u]=n[t-1][u];for(s=t-1;s>0;s--){for(l=0,a=0,h=0;h<s;h++)l+=Math.abs(e[h]);if(0===l)for(r[s]=e[s-1],u=0;u<s;u++)e[u]=n[s-1][u],n[s][u]=0,n[u][s]=0;else{for(h=0;h<s;h++)e[h]/=l,a+=e[h]*e[h];for(o=e[s-1],i=Math.sqrt(a),o>0&&(i=-i),r[s]=l*i,a-=o*i,e[s-1]=o-i,u=0;u<s;u++)r[u]=0;for(u=0;u<s;u++){for(o=e[u],n[u][s]=o,i=r[u]+n[u][u]*o,h=u+1;h<=s-1;h++)i+=n[h][u]*e[h],r[h]+=n[h][u]*o;r[u]=i}for(o=0,u=0;u<s;u++)r[u]/=a,o+=r[u]*e[u];for(f=o/(a+a),u=0;u<s;u++)r[u]-=f*e[u];for(u=0;u<s;u++){for(o=e[u],i=r[u],h=u;h<=s-1;h++)n[h][u]-=o*r[h]+i*e[h];e[u]=n[s-1][u],n[s][u]=0}}e[s]=a}for(s=0;s<t-1;s++){if(n[t-1][s]=n[s][s],n[s][s]=1,0!==(a=e[s+1])){for(h=0;h<=s;h++)e[h]=n[h][s+1]/a;for(u=0;u<=s;u++){for(i=0,h=0;h<=s;h++)i+=n[h][s+1]*n[h][u];for(h=0;h<=s;h++)n[h][u]-=i*e[h]}}for(h=0;h<=s;h++)n[h][s+1]=0}for(u=0;u<t;u++)e[u]=n[t-1][u],n[t-1][u]=0;n[t-1][t-1]=1,r[0]=0}(f,m,c,l),function(t,r,e,n){var o,a,s,u,h,f,l,c,m,g,p,v,d,w,y,b;for(s=1;s<t;s++)r[s-1]=r[s];r[t-1]=0;var x=0,M=0,A=Math.pow(2,-52);for(f=0;f<t;f++){for(M=Math.max(M,Math.abs(e[f])+Math.abs(r[f])),l=f;l<t&&!(Math.abs(r[l])<=A*M);)l++;if(l>f){0;do{for(1,o=e[f],c=(e[f+1]-o)/(2*r[f]),m=i(c,1),c<0&&(m=-m),e[f]=r[f]/(c+m),e[f+1]=r[f]*(c+m),g=e[f+1],a=o-e[f],s=f+2;s<t;s++)e[s]-=a;for(x+=a,c=e[l],v=p=1,d=p,w=r[f+1],y=0,b=0,s=l-1;s>=f;s--)for(d=v,v=p,b=y,o=p*r[s],a=p*c,m=i(c,r[s]),r[s+1]=y*m,y=r[s]/m,c=(p=c/m)*e[s]-y*o,e[s+1]=a+y*(p*o+y*e[s]),h=0;h<t;h++)a=n[h][s+1],n[h][s+1]=y*n[h][s]+p*a,n[h][s]=p*n[h][s]-y*a;c=-y*b*d*w*r[f]/g,r[f]=y*c,e[f]=p*c}while(Math.abs(r[f])>A*M)}e[f]=e[f]+x,r[f]=0}for(s=0;s<t-1;s++){for(h=s,c=e[s],u=s+1;u<t;u++)e[u]<c&&(h=u,c=e[u]);if(h!==s)for(e[h]=e[s],e[s]=c,u=0;u<t;u++)c=n[u][s],n[u][s]=n[u][h],n[u][h]=c}}(f,m,c,l)}else{var p=a(f,f,0),v=new Array(f);for(o=0;o<f;o++)for(e=0;e<f;e++)p[e][o]=g.get(e,o);!function(t,r,e,n){var o,i,a,s,u,h,f,l=t-1;for(h=1;h<=l-1;h++){for(f=0,s=h;s<=l;s++)f+=Math.abs(r[s][h-1]);if(0!==f){for(a=0,s=l;s>=h;s--)e[s]=r[s][h-1]/f,a+=e[s]*e[s];for(i=Math.sqrt(a),e[h]>0&&(i=-i),a-=e[h]*i,e[h]=e[h]-i,u=h;u<t;u++){for(o=0,s=l;s>=h;s--)o+=e[s]*r[s][u];for(o/=a,s=h;s<=l;s++)r[s][u]-=o*e[s]}for(s=0;s<=l;s++){for(o=0,u=l;u>=h;u--)o+=e[u]*r[s][u];for(o/=a,u=h;u<=l;u++)r[s][u]-=o*e[u]}e[h]=f*e[h],r[h][h-1]=f*i}}for(s=0;s<t;s++)for(u=0;u<t;u++)n[s][u]=s===u?1:0;for(h=l-1;h>=1;h--)if(0!==r[h][h-1]){for(s=h+1;s<=l;s++)e[s]=r[s][h-1];for(u=h;u<=l;u++){for(i=0,s=h;s<=l;s++)i+=e[s]*n[s][u];for(i=i/e[h]/r[h][h-1],s=h;s<=l;s++)n[s][u]+=i*e[s]}}}(f,p,v,l),function(t,r,e,n,o){var i,a,s,u,f,l,c,m,g,p,v,d,w,y,b,x=t-1,M=t-1,A=Math.pow(2,-52),E=0,R=0,S=0,T=0,_=0,k=0,O=0,C=0;for(i=0;i<t;i++)for((i<0||i>M)&&(e[i]=o[i][i],r[i]=0),a=Math.max(i-1,0);a<t;a++)R+=Math.abs(o[i][a]);for(;x>=0;){for(u=x;u>0&&(0===(k=Math.abs(o[u-1][u-1])+Math.abs(o[u][u]))&&(k=R),!(Math.abs(o[u][u-1])<A*k));)u--;if(u===x)o[x][x]=o[x][x]+E,e[x]=o[x][x],r[x]=0,x--,C=0;else if(u===x-1){if(c=o[x][x-1]*o[x-1][x],S=(o[x-1][x-1]-o[x][x])/2,T=S*S+c,O=Math.sqrt(Math.abs(T)),o[x][x]=o[x][x]+E,o[x-1][x-1]=o[x-1][x-1]+E,m=o[x][x],T>=0){for(O=S>=0?S+O:S-O,e[x-1]=m+O,e[x]=e[x-1],0!==O&&(e[x]=m-c/O),r[x-1]=0,r[x]=0,m=o[x][x-1],k=Math.abs(m)+Math.abs(O),S=m/k,T=O/k,_=Math.sqrt(S*S+T*T),S/=_,T/=_,a=x-1;a<t;a++)O=o[x-1][a],o[x-1][a]=T*O+S*o[x][a],o[x][a]=T*o[x][a]-S*O;for(i=0;i<=x;i++)O=o[i][x-1],o[i][x-1]=T*O+S*o[i][x],o[i][x]=T*o[i][x]-S*O;for(i=0;i<=M;i++)O=n[i][x-1],n[i][x-1]=T*O+S*n[i][x],n[i][x]=T*n[i][x]-S*O}else e[x-1]=m+S,e[x]=m+S,r[x-1]=O,r[x]=-O;x-=2,C=0}else{if(m=o[x][x],g=0,c=0,u<x&&(g=o[x-1][x-1],c=o[x][x-1]*o[x-1][x]),10===C){for(E+=m,i=0;i<=x;i++)o[i][i]-=m;k=Math.abs(o[x][x-1])+Math.abs(o[x-1][x-2]),m=g=.75*k,c=-.4375*k*k}if(30===C&&(k=(k=(g-m)/2)*k+c)>0){for(k=Math.sqrt(k),g<m&&(k=-k),k=m-c/((g-m)/2+k),i=0;i<=x;i++)o[i][i]-=k;E+=k,m=g=c=.964}for(C+=1,f=x-2;f>=u&&(O=o[f][f],S=((_=m-O)*(k=g-O)-c)/o[f+1][f]+o[f][f+1],T=o[f+1][f+1]-O-_-k,_=o[f+2][f+1],k=Math.abs(S)+Math.abs(T)+Math.abs(_),S/=k,T/=k,_/=k,f!==u)&&!(Math.abs(o[f][f-1])*(Math.abs(T)+Math.abs(_))<A*(Math.abs(S)*(Math.abs(o[f-1][f-1])+Math.abs(O)+Math.abs(o[f+1][f+1]))));)f--;for(i=f+2;i<=x;i++)o[i][i-2]=0,i>f+2&&(o[i][i-3]=0);for(s=f;s<=x-1&&(y=s!==x-1,s!==f&&(S=o[s][s-1],T=o[s+1][s-1],_=y?o[s+2][s-1]:0,0!==(m=Math.abs(S)+Math.abs(T)+Math.abs(_))&&(S/=m,T/=m,_/=m)),0!==m);s++)if(k=Math.sqrt(S*S+T*T+_*_),S<0&&(k=-k),0!==k){for(s!==f?o[s][s-1]=-k*m:u!==f&&(o[s][s-1]=-o[s][s-1]),m=(S+=k)/k,g=T/k,O=_/k,T/=S,_/=S,a=s;a<t;a++)S=o[s][a]+T*o[s+1][a],y&&(S+=_*o[s+2][a],o[s+2][a]=o[s+2][a]-S*O),o[s][a]=o[s][a]-S*m,o[s+1][a]=o[s+1][a]-S*g;for(i=0;i<=Math.min(x,s+3);i++)S=m*o[i][s]+g*o[i][s+1],y&&(S+=O*o[i][s+2],o[i][s+2]=o[i][s+2]-S*_),o[i][s]=o[i][s]-S,o[i][s+1]=o[i][s+1]-S*T;for(i=0;i<=M;i++)S=m*n[i][s]+g*n[i][s+1],y&&(S+=O*n[i][s+2],n[i][s+2]=n[i][s+2]-S*_),n[i][s]=n[i][s]-S,n[i][s+1]=n[i][s+1]-S*T}}}if(0===R)return;for(x=t-1;x>=0;x--)if(S=e[x],0===(T=r[x]))for(u=x,o[x][x]=1,i=x-1;i>=0;i--){for(c=o[i][i]-S,_=0,a=u;a<=x;a++)_+=o[i][a]*o[a][x];if(r[i]<0)O=c,k=_;else if(u=i,0===r[i]?o[i][x]=0!==c?-_/c:-_/(A*R):(m=o[i][i+1],g=o[i+1][i],T=(e[i]-S)*(e[i]-S)+r[i]*r[i],l=(m*k-O*_)/T,o[i][x]=l,o[i+1][x]=Math.abs(m)>Math.abs(O)?(-_-c*l)/m:(-k-g*l)/O),l=Math.abs(o[i][x]),A*l*l>1)for(a=i;a<=x;a++)o[a][x]=o[a][x]/l}else if(T<0)for(u=x-1,Math.abs(o[x][x-1])>Math.abs(o[x-1][x])?(o[x-1][x-1]=T/o[x][x-1],o[x-1][x]=-(o[x][x]-S)/o[x][x-1]):(b=h(0,-o[x-1][x],o[x-1][x-1]-S,T),o[x-1][x-1]=b[0],o[x-1][x]=b[1]),o[x][x-1]=0,o[x][x]=1,i=x-2;i>=0;i--){for(p=0,v=0,a=u;a<=x;a++)p+=o[i][a]*o[a][x-1],v+=o[i][a]*o[a][x];if(c=o[i][i]-S,r[i]<0)O=c,_=p,k=v;else if(u=i,0===r[i]?(b=h(-p,-v,c,T),o[i][x-1]=b[0],o[i][x]=b[1]):(m=o[i][i+1],g=o[i+1][i],d=(e[i]-S)*(e[i]-S)+r[i]*r[i]-T*T,w=2*(e[i]-S)*T,0===d&&0===w&&(d=A*R*(Math.abs(c)+Math.abs(T)+Math.abs(m)+Math.abs(g)+Math.abs(O))),b=h(m*_-O*p+T*v,m*k-O*v-T*p,d,w),o[i][x-1]=b[0],o[i][x]=b[1],Math.abs(m)>Math.abs(O)+Math.abs(T)?(o[i+1][x-1]=(-p-c*o[i][x-1]+T*o[i][x])/m,o[i+1][x]=(-v-c*o[i][x]-T*o[i][x-1])/m):(b=h(-_-g*o[i][x-1],-k-g*o[i][x],O,T),o[i+1][x-1]=b[0],o[i+1][x]=b[1])),l=Math.max(Math.abs(o[i][x-1]),Math.abs(o[i][x])),A*l*l>1)for(a=i;a<=x;a++)o[a][x-1]=o[a][x-1]/l,o[a][x]=o[a][x]/l}for(i=0;i<t;i++)if(i<0||i>M)for(a=i;a<t;a++)n[i][a]=o[i][a];for(a=t-1;a>=0;a--)for(i=0;i<=M;i++){for(O=0,s=0;s<=Math.min(a,M);s++)O+=n[i][s]*o[s][a];n[i][a]=O}}(f,m,c,l,p)}this.n=f,this.e=m,this.d=c,this.V=l}function h(t,r,e,n){var o,i;return Math.abs(e)>Math.abs(n)?[(t+(o=n/e)*r)/(i=e+o*n),(r-o*t)/i]:[((o=e/n)*t+r)/(i=n+o*e),(o*r-t)/i]}u.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return n.isMatrix(this.V)||(this.V=new n(this.V)),this.V},get diagonalMatrix(){var t,r,e=this.n,o=this.e,i=this.d,a=new n(e,e);for(t=0;t<e;t++){for(r=0;r<e;r++)a[t][r]=0;a[t][t]=i[t],o[t]>0?a[t][t+1]=o[t]:o[t]<0&&(a[t][t-1]=o[t])}return a}},t.exports=u},function(t,r,e){"use strict";var n=e(1).Matrix,o=e(8).hypotenuse;function i(t){if(!(this instanceof i))return new i(t);var r,e,a,s,u=(t=n.checkMatrix(t)).clone(),h=t.rows,f=t.columns,l=new Array(f);for(a=0;a<f;a++){var c=0;for(r=a;r<h;r++)c=o(c,u[r][a]);if(0!==c){for(u[a][a]<0&&(c=-c),r=a;r<h;r++)u[r][a]/=c;for(u[a][a]+=1,e=a+1;e<f;e++){for(s=0,r=a;r<h;r++)s+=u[r][a]*u[r][e];for(s=-s/u[a][a],r=a;r<h;r++)u[r][e]+=s*u[r][a]}}l[a]=-c}this.QR=u,this.Rdiag=l}i.prototype={solve:function(t){t=n.checkMatrix(t);var r=this.QR,e=r.rows;if(t.rows!==e)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var o,i,a,s,u=t.columns,h=t.clone(),f=r.columns;for(a=0;a<f;a++)for(i=0;i<u;i++){for(s=0,o=a;o<e;o++)s+=r[o][a]*h[o][i];for(s=-s/r[a][a],o=a;o<e;o++)h[o][i]+=s*r[o][a]}for(a=f-1;a>=0;a--){for(i=0;i<u;i++)h[a][i]/=this.Rdiag[a];for(o=0;o<a;o++)for(i=0;i<u;i++)h[o][i]-=h[a][i]*r[o][a]}return h.subMatrix(0,f-1,0,u-1)},isFullRank:function(){for(var t=this.QR.columns,r=0;r<t;r++)if(0===this.Rdiag[r])return!1;return!0},get upperTriangularMatrix(){var t,r,e=this.QR,o=e.columns,i=new n(o,o);for(t=0;t<o;t++)for(r=0;r<o;r++)i[t][r]=t<r?e[t][r]:t===r?this.Rdiag[t]:0;return i},get orthogonalMatrix(){var t,r,e,o,i=this.QR,a=i.rows,s=i.columns,u=new n(a,s);for(e=s-1;e>=0;e--){for(t=0;t<a;t++)u[t][e]=0;for(u[e][e]=1,r=e;r<s;r++)if(0!==i[e][e]){for(o=0,t=e;t<a;t++)o+=i[t][e]*u[t][r];for(o=-o/i[e][e],t=e;t<a;t++)u[t][r]+=o*i[t][e]}}return u}},t.exports=i},function(t,r,e){"use strict";var n=e(1).Matrix;function o(t){if(!(this instanceof o))return new o(t);if(!(t=n.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var r,e,i,a=t,s=a.rows,u=new n(s,s),h=!0;for(e=0;e<s;e++){var f=u[e],l=0;for(i=0;i<e;i++){var c=u[i],m=0;for(r=0;r<i;r++)m+=c[r]*f[r];f[i]=m=(a[e][i]-m)/u[i][i],l+=m*m}for(h&=(l=a[e][e]-l)>0,u[e][e]=Math.sqrt(Math.max(l,0)),i=e+1;i<s;i++)u[e][i]=0}if(!h)throw new Error("Matrix is not positive definite");this.L=u}o.prototype={get lowerTriangularMatrix(){return this.L},solve:function(t){t=n.checkMatrix(t);var r=this.L,e=r.rows;if(t.rows!==e)throw new Error("Matrix dimensions do not match");var o,i,a,s=t.columns,u=t.clone();for(a=0;a<e;a++)for(i=0;i<s;i++){for(o=0;o<a;o++)u[a][i]-=u[o][i]*r[a][o];u[a][i]/=r[a][a]}for(a=e-1;a>=0;a--)for(i=0;i<s;i++){for(o=a+1;o<e;o++)u[a][i]-=u[o][i]*r[o][a];u[a][i]/=r[a][a]}return u}},t.exports=o},function(t,r,e){"use strict";var n=e(11);t.exports=function(t){var r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).width,e=[],o=0,i=0,a=1;for(let r=t.length-1;r>=0;r--)t[r].soft&&e.push(t.splice(r,1)[0]);e.push({x:Number.MAX_VALUE});var s=[[e[0].x,e[0].y]],u=[0];for(let f=1;f<e.length;f++)if(Math.abs(e[f-1].x-e[f].x)<r)s.push([e[f].x,e[f].y]),e[f].y>o&&(o=e[f].y,i=f),u.push(f),a++;else{if(a>2){var h=n.optimizeSingleLorentzian(s,{x:e[i].x,y:o,width:Math.abs(s[0][0]-s[s.length-1][0])});t.push({x:h[0][0],y:h[1][0],width:h[2][0],soft:!1})}else u.forEach(r=>{t.push(e[r])});s=[[e[f].x,e[f].y]],u=[f],o=e[f].y,i=f,a=1}return t.sort(function(t,r){return t.x-r.x}),t}},function(t,r,e){"use strict";t.exports=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const e=r.factor,n=void 0===e?2:e,o=r.overlap,i=void 0!==o&&o;for(let r of t)r.from=r.x-r.width/2*n,r.to=r.x+r.width/2*n;if(!i)for(let r=0;r<t.length-1;r++){let e=t[r],n=t[r+1];e.to>n.from&&(e.to=n.from=(e.to+n.from)/2)}for(let r of t)r.width=r.to-r.from;return t}},function(t,r,e){"use strict";t.exports=r=e(52),r.getEquallySpacedData=e(53).getEquallySpacedData,r.SNV=e(54).SNV},function(t,r,e){"use strict";const n=e(6).array;function o(t){for(var r=new Array(t[0].length),e=0;e<r.length;++e)r[e]=new Array(t.length);for(e=0;e<t.length;++e)for(var n=0;n<t[0].length;++n)r[n][e]=t[e][n];return r}t.exports={coordArrayToPoints:function(t,r){if(t.length%r!=0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var e=t.length/r,n=new Array(e),o=0,i=0;i<t.length;i+=r){for(var a=new Array(r),s=0;s<r;++s)a[s]=t[i+s];n[o]=a,o++}return n},coordArrayToCoordMatrix:function(t,r){if(t.length%r!=0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var e=new Array(r),n=t.length/r,o=0;o<e.length;o++)e[o]=new Array(n);for(o=0;o<t.length;o+=r)for(var i=0;i<r;++i){var a=Math.floor(o/r);e[i][a]=t[o+i]}return e},coordMatrixToCoordArray:function(t){for(var r=new Array(t.length*t[0].length),e=0,n=0;n<t[0].length;++n)for(var o=0;o<t.length;++o)r[e]=t[o][n],++e;return r},coordMatrixToPoints:o,pointsToCoordArray:function(t){for(var r=new Array(t.length*t[0].length),e=0,n=0;n<t.length;++n)for(var o=0;o<t[0].length;++o)r[e]=t[n][o],++e;return r},pointsToCoordMatrix:o,applyDotProduct:function(t,r){var e,n;t.length<=r.length?(n=t,e=r):(n=r,e=t);for(var o=e.length-n.length+1,i=new Array(o),a=0;a<o;++a){for(var s=0,u=0;u<n.length;++u)s+=n[u]*e[a+u];i[a]=s}return i},scale:function t(r){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=e.min,i=e.max;var a=e.inPlace?r:new Array(r.length),s=n.minMax(r);if("number"==typeof i)if("number"==typeof o){let t=(i-o)/(s.max-s.min);for(let e=0;e<a.length;e++)a[e]=(r[e]-s.min)*t+o}else if(0!==s.max){let t=i/s.max;for(let e=0;e<a.length;e++)a[e]=r[e]*t}else e.min=s.min,a=t(r,e);else if("number"==typeof o)if(0!==s.min){let t=o/s.min;for(let e=0;e<a.length;e++)a[e]=r[e]*t}else e.max=s.max,a=t(r,e);return a}}},function(t,r,e){"use strict";function n(t,r,e,n){return.5*e*r*r+n*r-(.5*e*t*t+n*t)}r.getEquallySpacedData=function(t,r){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var o=t.length;t.length>1&&t[0]>t[1]&&(t=t.slice().reverse(),r=r.slice().reverse());var i=e.from,a=void 0===i?t[0]:i,s=e.to,u=void 0===s?t[o-1]:s,h=e.variant,f=void 0===h?"smooth":h,l=e.numberOfPoints,c=void 0===l?100:l;if(o!==r.length)throw new RangeError("the x and y vector doesn't have the same size.");if("number"!=typeof a||isNaN(a))throw new RangeError("'from' option must be a number");if("number"!=typeof u||isNaN(u))throw new RangeError("'to' option must be a number");var m=a>u;if(m){var g=[u,a];a=g[0],u=g[1]}if("number"!=typeof c||isNaN(c))throw new RangeError("'numberOfPoints' option must be a number");if(c<1)throw new RangeError("the number of points must be at least 1");var p="slot"===f?function(t,r,e,n,o){var i=t.length,a=(n-e)/(o-1),s=a/2,u=t[t.length-1]-t[t.length-2],h=e-s,f=new Array(o),l=h,c=h+a,m=-Number.MAX_VALUE,g=0,p=t[0],v=r[0],d=0,w=!0,y=0,b=0,x=1,M=0;t:for(;;){if(m>=p)throw new Error("x must be an increasing serie");for(;m-c>0;){if(w&&(b++,w=!1),f[M]=b<=0?0:y/b,++M===o)break t;l=c,c+=a,y=0,b=0}m>l&&(y+=g,b++),(m===-Number.MAX_VALUE||d>1)&&b--,m=p,g=v,x<i?(p=t[x],v=r[x],x++):(p+=u,v=0,d++)}return f}(t,r,a,u,c):function(t,r,e,o,i){var a=t.length,s=(o-e)/(i-1),u=s/2,h=new Array(i),f=t[1]-t[0],l=t[a-1]-t[a-2],c=e-u,m=e+u,g=Number.MIN_VALUE,p=0,v=t[0]-f,d=0,w=0,y=0,b=0,x=0,M=0,A=0,E=0;t:for(;;){for(g<=c&&c<=v&&(R=n(0,c-g,y,p),x=w+R);v-m>=0;){var R=n(0,m-g,y,p);if(M=w+R,h[E++]=(M-x)/s,E===i)break t;c=m,m+=s,x=M}w+=n(g,v,y,b),g=v,p=d,A<a?(v=t[A],d=r[A],A++):A===a&&(v+=l,d=0),b=-(y=(d-p)/(v-g))*g+p}return h}(t,r,a,u,c);return m?p.reverse():p},r.integral=n},function(t,r,e){"use strict";r.SNV=function(t){for(var r=n.mean(t),e=n.standardDeviation(t),o=t.slice(),i=0;i<t.length;i++)o[i]=(o[i]-r)/e;return o};var n=e(6).array},function(t,r,e){"use strict";e.r(r),e.d(r,"hash",function(){return i});var n=e(4),o=e(9),i=function(t){return Object(o.a)(Object(o.b)(t))};i.is=Object(n.curry)(function(t,r){return i(t)===i(r)}),i.is.all=Object(n.curry)(function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];for(var n=i.is(r.shift()),o=0;o<r.length;o++)if(!n(r[o]))return!1;return!0},2),i.is.any=Object(n.curry)(function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];for(var n=i.is(r.shift()),o=0;o<r.length;o++)if(n(r[o]))return!0;return!1},2),i.is.not=Object(n.curry)(function(t,r){return i(t)!==i(r)}),r.default=i},function(t,r){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,r,e){"use strict";r.byteLength=function(t){var r=h(t),e=r[0],n=r[1];return 3*(e+n)/4-n},r.toByteArray=function(t){for(var r,e=h(t),n=e[0],a=e[1],s=new i(function(t,r,e){return 3*(r+e)/4-e}(0,n,a)),u=0,f=a>0?n-4:n,l=0;l<f;l+=4)r=o[t.charCodeAt(l)]<<18|o[t.charCodeAt(l+1)]<<12|o[t.charCodeAt(l+2)]<<6|o[t.charCodeAt(l+3)],s[u++]=r>>16&255,s[u++]=r>>8&255,s[u++]=255&r;2===a&&(r=o[t.charCodeAt(l)]<<2|o[t.charCodeAt(l+1)]>>4,s[u++]=255&r);1===a&&(r=o[t.charCodeAt(l)]<<10|o[t.charCodeAt(l+1)]<<4|o[t.charCodeAt(l+2)]>>2,s[u++]=r>>8&255,s[u++]=255&r);return s},r.fromByteArray=function(t){for(var r,e=t.length,o=e%3,i=[],a=0,s=e-o;a<s;a+=16383)i.push(f(t,a,a+16383>s?s:a+16383));1===o?(r=t[e-1],i.push(n[r>>2]+n[r<<4&63]+"==")):2===o&&(r=(t[e-2]<<8)+t[e-1],i.push(n[r>>10]+n[r>>4&63]+n[r<<2&63]+"="));return i.join("")};for(var n=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)n[s]=a[s],o[a.charCodeAt(s)]=s;function h(t){var r=t.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=t.indexOf("=");return-1===e&&(e=r),[e,e===r?0:4-e%4]}function f(t,r,e){for(var o,i,a=[],s=r;s<e;s+=3)o=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(n[(i=o)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(t,r){r.read=function(t,r,e,n,o){var i,a,s=8*o-n-1,u=(1<<s)-1,h=u>>1,f=-7,l=e?o-1:0,c=e?-1:1,m=t[r+l];for(l+=c,i=m&(1<<-f)-1,m>>=-f,f+=s;f>0;i=256*i+t[r+l],l+=c,f-=8);for(a=i&(1<<-f)-1,i>>=-f,f+=n;f>0;a=256*a+t[r+l],l+=c,f-=8);if(0===i)i=1-h;else{if(i===u)return a?NaN:1/0*(m?-1:1);a+=Math.pow(2,n),i-=h}return(m?-1:1)*a*Math.pow(2,i-n)},r.write=function(t,r,e,n,o,i){var a,s,u,h=8*i-o-1,f=(1<<h)-1,l=f>>1,c=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:i-1,g=n?1:-1,p=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(s=isNaN(r)?1:0,a=f):(a=Math.floor(Math.log(r)/Math.LN2),r*(u=Math.pow(2,-a))<1&&(a--,u*=2),(r+=a+l>=1?c/u:c*Math.pow(2,1-l))*u>=2&&(a++,u/=2),a+l>=f?(s=0,a=f):a+l>=1?(s=(r*u-1)*Math.pow(2,o),a+=l):(s=r*Math.pow(2,l-1)*Math.pow(2,o),a=0));o>=8;t[e+m]=255&s,m+=g,s/=256,o-=8);for(a=a<<o|s,h+=o;h>0;t[e+m]=255&a,m+=g,a/=256,h-=8);t[e+m-g]|=128*p}},function(t,r){var e={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==e.call(t)}},function(t,r,e){"use strict";function n(){const t=/[, \t]+/,r=["TIC",".RIC","SCANNUMBER"];function e(t){var r=[];for(let e=0;e<t.length;e++)r.push(parseFloat(t[e]));return r}class n{}const o={keepRecordsRegExp:/^$/,xy:!1,withoutXY:!1,chromatogram:!1,keepSpectra:!1,noContour:!1,nbContourLevels:7,noiseMultiplier:5,profiling:!1};function i(t){return t.toLowerCase().replace(/[^a-z0-9]/g,"")}function a(t){return-1!==r.indexOf(t)}function s(t,r){if(r.xFactor||(r.xFactor=1),r.yFactor||(r.yFactor=1),r.observeFrequency&&r.xUnit&&"HZ"===r.xUnit.toUpperCase()&&(r.xUnit="PPM",r.xFactor=r.xFactor/r.observeFrequency,r.firstX=r.firstX/r.observeFrequency,r.lastX=r.lastX/r.observeFrequency,r.deltaX=r.deltaX/r.observeFrequency),r.shiftOffsetVal){var e=r.firstX-r.shiftOffsetVal;r.firstX=r.firstX-e,r.lastX=r.lastX-e}}function u(t,r){return t-r}function h(t,r){var e=t.yFactor,n=t.deltaX;t.isXYdata=!0;var o=[];t.data=[o];var i,a=t.firstX,s=t.firstY,u=!1;let h=0;for(;h<r.length;h++)if(13===(i=r.charCodeAt(h))||10===i)u=!0;else if(u)break;for(var f=!0,l=!1,c=!1,m=0,g=!1,p=!1,v=0,d=0,w=!1,y=!1,b=!1,x=0;h<=r.length;h++)if(i=h===r.length?13:r.charCodeAt(h),p)13!==i&&10!==i||(f=!0,p=!1);else if(i<=57&&i>=48)y=!0,x>0?v+=(i-48)/Math.pow(10,x++):(v*=10,v+=i-48);else if(44===i||46===i)y=!0,x++;else{if(y){if(f)f=!1,c&&(b=!0);else if(b)b=!1;else{l?(m=w?0-v:v,c=!0,l=!1):g||(d=w?0-v:v);for(var M=g?v-1:1,A=0;A<M;A++)c?s+=m:s=d,o.push(a),o.push(s*e),a+=n}w=!1,v=0,x=0,y=!1,g=!1}if(i<74&&i>63)y=!0,c=!1,v=i-64;else if(i>96&&i<106)y=!0,c=!1,v=i-96,w=!0;else if(115===i)y=!0,g=!0,v=9;else if(i>82&&i<91)y=!0,g=!0,v=i-82;else if(i>73&&i<83)y=!0,l=!0,v=i-73;else if(i>105&&i<115)y=!0,l=!0,v=i-105,w=!0;else if(36===i&&36===r.charCodeAt(h+1))y=!0,p=!0;else if(37===i)y=!0,l=!0,v=0,w=!1;else if(45===i){var E=r.charCodeAt(h+1);(E>=48&&E<=57||44===E||46===E)&&(y=!0,f||(c=!1),w=!0)}else 13!==i&&10!==i||(f=!0,p=!1)}}function f(t,r){var e,n=/(\(+|\)+|<+|>+|\s+)/g;t.isXYAdata=!0;var o=[];t.data=[o];var i=r.split(/,? *,?[;\r\n]+ */);for(let t=1;t<i.length;t++)e=i[t].trim().replace(n,"").split(","),o.push(parseFloat(e[0])),o.push(parseFloat(e[1]))}function l(t,r,e){var n,o=/\$\$.*/,i=/[,\t ]+/;t.isPeaktable=!0;var a=[];t.data=[a];var s=r.split(/,? *,?[;\r\n]+ */);for(let r=1;r<s.length;r++)if((n=s[r].trim().replace(o,"").split(i)).length%2==0)for(let r=0;r<n.length;r+=2)a.push(parseFloat(n[r])*t.xFactor),a.push(parseFloat(n[r+1])*t.yFactor);else e.logs.push("Format error: ".concat(n))}return function(c,m){var g,p,v,d,w,y,b,x=!(m=Object.assign({},o,m)).withoutXY,M=Date.now(),A={},E={};E.profiling=!!m.profiling&&[],E.logs=[];var R=[];E.spectra=R,E.info={};var S=new n;if("string"!=typeof c)throw new TypeError("the JCAMP should be a string");E.profiling&&E.profiling.push({action:"Before split to LDRS",time:Date.now()-M}),d=c.split(/[\r\n]+##/),E.profiling&&E.profiling.push({action:"Split to LDRS",time:Date.now()-M}),d[0]&&(d[0]=d[0].replace(/^[\r\n ]*##/,""));for(let r=0;r<d.length;r++){if((w=(g=d[r]).indexOf("="))>0?(p=g.substring(0,w),v=g.substring(w+1).trim()):(p=g,v=""),"DATATABLE"===(p=p.replace(/[_ -]/g,"").toUpperCase())&&(-1===(y=v.indexOf("\n"))&&(y=v.indexOf("\r")),y>0)){var T=-1,_=-1;if((b=v.substring(0,y).split(/[ ,;\t]+/))[0].indexOf("++")>0){var k=b[0].replace(/.*\(([a-zA-Z0-9]+)\+\+.*/,"$1"),O=b[0].replace(/.*\.\.([a-zA-Z0-9]+).*/,"$1");T=A.symbol.indexOf(k),_=A.symbol.indexOf(O)}-1===T&&(T=0),-1===_&&(_=0),A.first&&(A.first.length>T&&(S.firstX=A.first[T]),A.first.length>_&&(S.firstY=A.first[_])),A.last&&(A.last.length>T&&(S.lastX=A.last[T]),A.last.length>_&&(S.lastY=A.last[_])),A.vardim&&A.vardim.length>T&&(S.nbPoints=A.vardim[T]),A.factor&&(A.factor.length>T&&(S.xFactor=A.factor[T]),A.factor.length>_&&(S.yFactor=A.factor[_])),A.units&&(A.units.length>T&&(S.xUnit=A.units[T]),A.units.length>_&&(S.yUnit=A.units[_])),S.datatable=b[0],b[1]&&b[1].indexOf("PEAKS")>-1?p="PEAKTABLE":b[1]&&(b[1].indexOf("XYDATA")||b[0].indexOf("++")>0)&&(p="XYDATA",S.deltaX=(S.lastX-S.firstX)/(S.nbPoints-1))}if("XYDATA"!==p)if("PEAKTABLE"!==p)if("PEAKASSIGNMENTS"!==p){if("TITLE"===p)S.title=v;else if("DATATYPE"===p)S.dataType=v,v.indexOf("nD")>-1&&(E.twoD=!0);else if("NTUPLES"===p)v.indexOf("nD")>-1&&(E.twoD=!0);else if("XUNITS"===p)S.xUnit=v;else if("YUNITS"===p)S.yUnit=v;else if("FIRSTX"===p)S.firstX=parseFloat(v);else if("LASTX"===p)S.lastX=parseFloat(v);else if("FIRSTY"===p)S.firstY=parseFloat(v);else if("LASTY"===p)S.lastY=parseFloat(v);else if("NPOINTS"===p)S.nbPoints=parseFloat(v);else if("XFACTOR"===p)S.xFactor=parseFloat(v);else if("YFACTOR"===p)S.yFactor=parseFloat(v);else if("MAXX"===p)S.maxX=parseFloat(v);else if("MINX"===p)S.minX=parseFloat(v);else if("MAXY"===p)S.maxY=parseFloat(v);else if("MINY"===p)S.minY=parseFloat(v);else if("DELTAX"===p)S.deltaX=parseFloat(v);else if(".OBSERVEFREQUENCY"===p||"$SFO1"===p)S.observeFrequency||(S.observeFrequency=parseFloat(v));else if(".OBSERVENUCLEUS"===p)S.xType||(E.xType=v.replace(/[^a-zA-Z0-9]/g,""));else if("$SFO2"===p)E.indirectFrequency||(E.indirectFrequency=parseFloat(v));else if("$OFFSET"===p)E.shiftOffsetNum=0,S.shiftOffsetVal||(S.shiftOffsetVal=parseFloat(v));else if("$REFERENCEPOINT"===p);else if("VARNAME"===p)A.varname=v.split(t);else if("SYMBOL"===p)A.symbol=v.split(t);else if("VARTYPE"===p)A.vartype=v.split(t);else if("VARFORM"===p)A.varform=v.split(t);else if("VARDIM"===p)A.vardim=e(v.split(t));else if("UNITS"===p)A.units=v.split(t);else if("FACTOR"===p)A.factor=e(v.split(t));else if("FIRST"===p)A.first=e(v.split(t));else if("LAST"===p)A.last=e(v.split(t));else if("MIN"===p)A.min=e(v.split(t));else if("MAX"===p)A.max=e(v.split(t));else if(".NUCLEUS"===p)E.twoD&&(E.yType=v.split(t)[0]);else if("PAGE"===p){S.page=v.trim(),S.pageValue=parseFloat(v.replace(/^.*=/,"")),S.pageSymbol=S.page.replace(/[=].*/,"");var C=A.symbol.indexOf(S.pageSymbol),P="";A.units&&A.units[C]&&(P=A.units[C]),E.indirectFrequency&&"PPM"!==P&&(S.pageValue/=E.indirectFrequency)}else"RETENTIONTIME"===p?S.pageValue=parseFloat(v):a(p)?S[i(p)]=v:"SAMPLEDESCRIPTION"===p&&(S.sampleDescription=v);p.match(m.keepRecordsRegExp)&&(E.info[p]?(Array.isArray(E.info[p])||(E.info[p]=[E.info[p]]),E.info[p].push(v.trim())):E.info[p]=v.trim())}else x&&(v.match(/.*(XYA).*/)&&f(S,v),R.push(S),S=new n);else x&&(s(0,S),l(S,v,E),R.push(S),S=new n);else x&&(s(0,S),v.match(/.*\+\+.*/)?(S.deltaX||(S.deltaX=(S.lastX-S.firstX)/(S.nbPoints-1)),h(S,v)):l(S,v,E),R.push(S),S=new n)}if(E.profiling&&E.profiling.push({action:"Finished parsing",time:Date.now()-M}),Object.keys(A).length>0){var I=[],V=Object.keys(A);for(let t=0;t<V.length;t++){var N=V[t],D=A[N];for(let t=0;t<D.length;t++)I[t]||(I[t]={}),I[t][N]=D[t]}E.ntuples=I}if(E.twoD&&x&&(function(t,r){var e=function(t){var r,e,n=t[0].data[0][0],o=n,i=t.length,a=t[0].data[0].length/2,s=new Array(i);for(let r=0;r<i;r++){s[r]=new Array(a);var h=t[r].data[0];for(let t=0;t<a;t++){var f=h[2*t+1];s[r][t]=f,f<n&&(n=f),f>o&&(o=f)}}return{z:s,minX:t[0].data[0][0],maxX:t[0].data[0][t[0].data[0].length-2],minY:t[0].pageValue,maxY:t[i-1].pageValue,minZ:n,maxZ:o,noise:(r=s[0].map(Math.abs),e=(r=r.sort(u)).length,r[Math.floor(e/2)])}}(t.spectra);r.noContour||(t.contourLines=function(t,r){for(var e,n,o,i,a,s,u,h,f,l,c,m,g,p=t.noise,v=t.z,d=v.length,w=v[0].length,y=t.minX,b=(t.maxX-y)/(w-1),x=t.minY,M=(t.maxY-x)/(d-1),A=t.minZ,E=t.maxZ,R=2*r.nbContourLevels,S=new Array(R),T=0;T<R;T++){var _={};S[T]=_;var k=T%2,O=(E-r.noiseMultiplier*p)*Math.exp((T>>1)-r.nbContourLevels);g=0===k?O+r.noiseMultiplier*p:0-O-r.noiseMultiplier*p;var C=[];if(_.zValue=g,_.lines=C,!(g<=A||g>=E))for(var P=0;P<d-1;P++)for(var I=v[P],V=v[P+1],N=0;N<w-1;N++)e=I[N],n=I[N+1],o=V[N],i=V[N+1],u=o>g,h=i>g,(a=e>g)!=(s=n>g)&&a!==u&&(f=N+(g-e)/(n-e),l=P,c=N,m=P+(g-e)/(o-e),C.push(f*b+y),C.push(l*M+x),C.push(c*b+y),C.push(m*M+x)),h!==s&&h!==u&&(f=N+1,l=P+1-(g-i)/(n-i),c=N+1-(g-i)/(o-i),m=P+1,C.push(f*b+y),C.push(l*M+x),C.push(c*b+y),C.push(m*M+x)),s!==u&&(f=(N+1-(g-n)/(o-n))*b+y,l=(P+(g-n)/(o-n))*M+x,s!==a&&(c=N+1-(g-n)/(e-n),m=P,C.push(f),C.push(l),C.push(c*b+y),C.push(m*M+x)),u!==a&&(c=N,m=P+1-(g-o)/(e-o),C.push(f),C.push(l),C.push(c*b+y),C.push(m*M+x)),s!==h&&(c=N+1,m=P+(g-n)/(i-n),C.push(f),C.push(l),C.push(c*b+y),C.push(m*M+x)),u!==h&&(c=N+(g-o)/(i-o),m=P+1,C.push(f),C.push(l),C.push(c*b+y),C.push(m*M+x)))}return{minX:t.minX,maxX:t.maxX,minY:t.minY,maxY:t.maxY,segments:S}}(e,r),delete e.z),t.minMax=e}(E,m),E.profiling&&E.profiling.push({action:"Finished countour plot calculation",time:Date.now()-M}),m.keepSpectra||delete E.spectra),m.chromatogram&&(m.xy=!0),m.xy&&x&&R.length>0)for(let t=0;t<R.length;t++)if((S=R[t]).data.length>0)for(let t=0;t<S.data.length;t++){for(var z=S.data[t],U={x:new Array(z.length/2),y:new Array(z.length/2)},F=0;F<z.length;F+=2)U.x[F/2]=z[F],U.y[F/2]=z[F+1];S.data[t]=U}return m.chromatogram&&(E.spectra.length>1?function(t){var e=t.spectra,n=e.length,o={times:new Array(n),series:{ms:{dimension:2,data:new Array(n)}}},a=[];for(let t=0;t<r.length;t++){var s=i(r[t]);e[0][s]&&(a.push(s),o.series[s]={dimension:1,data:new Array(n)})}for(let t=0;t<n;t++){var u=e[t];o.times[t]=u.pageValue;for(let r=0;r<a.length;r++)o.series[a[r]].data[t]=parseFloat(u[a[r]]);u.data&&(o.series.ms.data[t]=[u.data[0].x,u.data[0].y])}t.chromatogram=o}(E):function(t){var r=t.spectra[0].data[0];t.chromatogram={times:r.x.slice(),series:{intensity:{dimension:1,data:r.y.slice()}}}}(E),E.profiling&&E.profiling.push({action:"Finished chromatogram calculation",time:Date.now()-M})),E.profiling&&E.profiling.push({action:"Total time",time:Date.now()-M}),E}}var o=n();var i,a={};t.exports={convert:function(t,r,e){return"boolean"==typeof r&&(e=r,r={}),e?function(t,r){var e;return i||(e=URL.createObjectURL(new Blob(["var getConverter =".concat(n.toString(),";var convert = getConverter(); onmessage = function (event) { var data = JSON.parse(event.data); postMessage(JSON.stringify({stamp: data.stamp, output: convert(data.input, data.options)})); };")],{type:"application/javascript"})),i=new Worker(e),URL.revokeObjectURL(e),i.addEventListener("message",function(t){var r=JSON.parse(t.data),e=r.stamp;a[e]&&a[e](r.output)})),new Promise(function(e){var n="".concat(Date.now()).concat(Math.random());a[n]=e,i.postMessage(JSON.stringify({stamp:n,input:t,options:r}))})}(t,r):o(t,r)},createTree:function(t){const r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).flatten,e=void 0!==r&&r;if("string"!=typeof t)throw new TypeError("the JCAMP should be a string");let n,o=t.split(/[\r\n]+/),i=[],a=[],s=[],u=0,h=t.includes("## ");for(var f=0;f<o.length;f++){let t=o[f],r=h?t.replace(/ /g,""):t;if("##NTUPLES"===r.substring(0,9)&&u++,"##TITLE"===r.substring(0,7)){let e=[r.substring(8).trim()];for(let t=f+1;t<o.length&&!o[t].startsWith("##");t++)e.push(o[t].trim());a.push({title:e.join("\n"),jcamp:"".concat(t,"\n"),children:[]}),n=a[a.length-1],i.push(n)}else if("##END"===r.substring(0,5)&&0===u){n.jcamp+="".concat(t,"\n");var l=a.pop();0!==a.length?(n=a[a.length-1]).children.push(l):(n=void 0,s.push(l))}else if(n&&n.jcamp){n.jcamp+="".concat(t,"\n");var c=r.match(/^##(.*?)=(.+)/);c&&"DATATYPE"===c[1].replace(/[ _-]/g,"").toUpperCase()&&(n.dataType=c[2].trim())}"##END"===r.substring(0,5)&&u>0&&u--}return e?(i.forEach(t=>{t.children=void 0}),i):s}}},function(t,r,e){"use strict";e.r(r),e.d(r,"parseXY",function(){return i});var n=e(18),o=e.n(n);function i(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const e=r.normalize,n=void 0!==e&&e,i=r.uniqueX,a=void 0!==i&&i,s=r.arrayType,u=void 0===s?"xyxy":s,h=r.xColumn,f=void 0===h?0:h,l=r.yColumn,c=void 0===l?1:l,m=r.keepInfo,g=void 0!==m&&m,p=r.maxNumberColumns,v=void 0===p?Math.max(f,c)+1:p,d=r.minNumberColumns,w=void 0===d?Math.max(f,c)+1:d;var y=t.split(/[\r\n]+/);if("xxyy"!==u&&"xyxy"!==u)throw new Error("unsupported arrayType (".concat(u,")"));for(var b=Number.MIN_VALUE,x=[[],[]],M=[],A=0;A<y.length;A++){var E=y[A].trim();if(E.match(/[0-9]+/)&&E.match(/^[0-9eE,;. \t+-]+$/)){var R=E.split(/,[; \t]+|[; \t]+/);if(1===R.length&&(R=E.split(/[,; \t]+/)),R&&R.length>=w&&R.length<=v){let t=parseFloat(R[f].replace(",",".")),r=parseFloat(R[c].replace(",","."));r>b&&(b=r),x[0].push(t),x[1].push(r)}}else E&&M.push({position:x[0].length,value:E})}if(n)for(var S=0;S<x[0].length;S++)x[1][S]/=b;if(a&&o()(x[0],x[1]),"xyxy"===u){var T=[];for(let t=0;t<x[0].length;t++)T.push([x[0][t],x[1][t]]);x=T}return g?{info:M,data:x}:x}},function(t,r,e){"use strict";e.r(r);var n=e(3),o=e.n(n);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!==i(t)||o()(t)||(r=t,t=[]),!o()(t))throw new TypeError("input must be an array");var e=r,n=e.from,a=void 0===n?0:n,s=e.to,u=void 0===s?10:s,h=e.size,f=void 0===h?t.length:h,l=e.step;if(f&&l)throw new Error("step is defined by the array size");if(f||(f=l?Math.floor((u-a)/l)+1:u-a+1),!l&&f&&(l=(u-a)/(f-1)),Array.isArray(t)){t.length=0;for(var c=0;c<f;c++)t.push(a),a+=l}else{if(t.length!==f)throw new Error("sequentialFill typed array must have the correct length");for(var m=0;m<f;m++)t[m]=a,a+=l}return t};function s(t,r,e,n){return.5*e*r*r+n*r-(.5*e*t*t+n*t)}function u(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.x,n=t.y,o=e.length,i=!1;e.length>1&&e[0]>e[1]&&(e=e.slice().reverse(),n=n.slice().reverse(),i=!0);let a=r.from,s=void 0===a?e[0]:a,u=r.to,f=void 0===u?e[o-1]:u,l=r.variant,c=void 0===l?"smooth":l,m=r.numberOfPoints,g=void 0===m?100:m,p=r.exclusions,v=void 0===p?[]:p;if(o!==n.length)throw new RangeError("the x and y vector doesn't have the same size.");if("number"!=typeof s||isNaN(s))throw new RangeError("'from' option must be a number");if("number"!=typeof f||isNaN(f))throw new RangeError("'to' option must be a number");if("number"!=typeof g||isNaN(g))throw new RangeError("'numberOfPoints' option must be a number");let d=function(t,r,e){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(t>r){var o=[r,t];t=o[0],r=o[1]}n=n.filter(t=>void 0!==t.from&&void 0!==t.to),(n=JSON.parse(JSON.stringify(n))).forEach(t=>{if(t.from>t.to){var r=[t.from,t.to];t.to=r[0],t.from=r[1]}}),n.sort((t,r)=>t.from-r.from),n.forEach(e=>{e.from<t&&(e.from=t),e.to>r&&(e.to=r)});for(let t=0;t<n.length-1;t++)n[t].to>n[t+1].from&&(n[t].to=n[t+1].from);if(!(n=n.filter(t=>t.from<t.to))||0===n.length)return[{from:t,to:r,numberOfPoints:e}];let i=n.reduce((t,r)=>t+=r.to-r.from,0),a=(r-t-i)/e,s=[],u=t,h=0;for(let t of n){let r=Math.round((t.from-u)/a);h+=r,r>0&&s.push({from:u,to:t.from,numberOfPoints:r}),u=t.to}return e-h>0&&s.push({from:u,to:r,numberOfPoints:e-h}),s}(s,f,g,v),w=[],y=[];for(let t of d){let r=h(e,n,t.from,t.to,t.numberOfPoints,c);w.push(...r.x),y.push(...r.y)}return i?s<f?{x:w.reverse(),y:y.reverse()}:{x:w,y:y}:s<f?{x:w,y:y}:{x:w.reverse(),y:y.reverse()}}function h(t,r,e,n,o,i){if(o<1)throw new RangeError("the number of points must be at least 1");var u="slot"===i?function(t,r,e,n,o){var i=t.length,a=(n-e)/(o-1),s=a/2,u=t[t.length-1]-t[t.length-2],h=e-s,f=new Array(o),l=h,c=h+a,m=-Number.MAX_VALUE,g=0,p=t[0],v=r[0],d=0,w=!0,y=0,b=0,x=1,M=0;t:for(;;){if(m>=p)throw new Error("x must be an increasing serie");for(;m-c>0;){if(w&&(b++,w=!1),f[M]=b<=0?0:y/b,++M===o)break t;l=c,c+=a,y=0,b=0}m>l&&(y+=g,b++),(m===-Number.MAX_VALUE||d>1)&&b--,m=p,g=v,x<i?(p=t[x],v=r[x],x++):(p+=u,v=0,d++)}return f}(t,r,e,n,o):function(t,r,e,n,o){var i=t.length,a=(n-e)/(o-1),u=a/2,h=new Array(o),f=t[1]-t[0],l=t[i-1]-t[i-2],c=e-u,m=e+u,g=Number.MIN_VALUE,p=0,v=t[0]-f,d=0,w=0,y=0,b=0,x=0,M=0,A=0,E=0;t:for(;;){for(g<=c&&c<=v&&(x=w+(R=s(0,c-g,y,p)));v-m>=0;){var R=s(0,m-g,y,p);if(M=w+R,h[E++]=(M-x)/a,E===o)break t;c=m,m+=a,x=M}w+=s(g,v,y,b),g=v,p=d,A<i?(v=t[A],d=r[A],A++):A===i&&(v+=l,d=0),b=-(y=(d-p)/(v-g))*g+p}return h}(t,r,e,n,o);return{x:a({from:e,to:n,size:o}),y:u}}e.d(r,"default",function(){return u})}])});
//# sourceMappingURL=spectra-processor.min.js.map