{"version":3,"sources":["webpack://SpectraProcessor/webpack/universalModuleDefinition","webpack://SpectraProcessor/webpack/bootstrap","webpack://SpectraProcessor/./node_modules/is-any-array/src/index.js","webpack://SpectraProcessor/./node_modules/ml-array-max/lib-es6/index.js","webpack://SpectraProcessor/./lib/index.js","webpack://SpectraProcessor//usr/lib/node_modules/cheminfo-tools/node_modules/process/browser.js","webpack://SpectraProcessor/./node_modules/ml-stat/array.js","webpack://SpectraProcessor/./node_modules/jcampconverter/src/index.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/check.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/x/findClosestIndex.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/x/getFromToIndex.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/integration.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/integral.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/maxY.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/maxYPoint.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/minYPoint.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/reduce.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/sortX.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/minClosestYPoint.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/maxClosestYPoint.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/x/getTargetIndex.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/realMinYPoint.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/realMaxYPoint.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/maximaY.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/minimaY.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/peakInfo.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xy/index.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xreim/zeroFilling.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xreim/sortX.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/xreim/index.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/reim/absolute.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/reim/phaseCorrection.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/reim/index.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/x/add.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/x/boxPlot.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/x/divide.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/x/multiply.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/x/rotate.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/x/subtract.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/x/correlation.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/x/index.js","webpack://SpectraProcessor/./node_modules/ml-spectra-processing/src/index.js","webpack://SpectraProcessor/./node_modules/ml-array-sequential-fill/lib-es6/index.js","webpack://SpectraProcessor/./node_modules/ml-array-xy-equally-spaced/src/integral.js","webpack://SpectraProcessor/./node_modules/ml-array-xy-equally-spaced/src/equallySpacedSmooth.js","webpack://SpectraProcessor/./node_modules/ml-array-xy-equally-spaced/src/equallySpacedSlot.js","webpack://SpectraProcessor/./node_modules/ml-array-xy-equally-spaced/src/getZones.js","webpack://SpectraProcessor/./node_modules/ml-array-xy-equally-spaced/src/index.js","webpack://SpectraProcessor/./node_modules/ml-regression-base/src/index.js","webpack://SpectraProcessor/./node_modules/ml-regression-base/src/checkArrayLength.js","webpack://SpectraProcessor/./node_modules/ml-regression-base/src/maybeToPrecision.js","webpack://SpectraProcessor/./node_modules/ml-regression-simple-linear/src/index.js","webpack://SpectraProcessor/./node_modules/ml-array-min/lib-es6/index.js","webpack://SpectraProcessor/./node_modules/ml-array-rescale/lib-es6/index.js","webpack://SpectraProcessor/./node_modules/ml-array-xy-filter-x/src/getZones.js","webpack://SpectraProcessor/./node_modules/ml-array-xy-filter-x/src/index.js","webpack://SpectraProcessor/./node_modules/ml-array-sum/lib-es6/index.js","webpack://SpectraProcessor/./node_modules/ml-array-normed/lib-es6/index.js"],"names":["toString","Object","prototype","isAnyArray","object","call","endsWith","module","exports","max","input","isArray","TypeError","length","maxValue","i","defineProperty","value","_interopDefault","ex","Stat","require","Stat__default","filterX","equallySpaced","normed","rescale","mlSpectraProcessing","jcampconverter","SimpleLinearRegression","getData","spectrum","filter","data","x","y","getNormalized","options","Array","Error","from","to","numberOfPoints","filters","exclusions","slice","name","mean","meanFct","map","std","standardDeviation","stdFct","undefined","process","kind","result","updateRangesInfo","ranges","range","JSON","parse","stringify","label","fromToIndex","fromIndex","X","findClosestIndex","normalized","toIndex","integration","XY","maxPoint","maxYPoint","Spectrum","constructor","id","meta","normalization","reverse","normalizedBoundary","min","updateNormalizedBoundary","updateNormalization","updateMemory","minX","maxX","original","memory","total","removeOriginal","getXY","minMax","getJcampKind","datatype","spectra","dataType","toLowerCase","yUnit","match","IR_ABSORBANCE","IR_TRANSMITTANCE","importation","converter","transmittance","Math","log10","display","xLabel","xInverted","yLabel","jcamp","parsed","convert","xy","keepRecordsRegExp","info","text","lines","split","fs","matrix","ids","headers","labels","header","isNaN","Number","line","parts","push","oneMeta","j","getNormalizationAnnotations","boundary","annotations","exclusion","ignore","annotation","type","position","strokeWidth","fillColor","getBoxPlotData","nbRow","nbColumn","aColumn","Float64Array","column","row","boxPlot","key","getBoxPlotAnnotations","q13FillColor","q13FillOpacity","q2StrokeColor","q2StrokeWidth","minMaxFillColor","minMaxFillOpacity","q13","Q1","Q3","layer","properties","fillOpacity","q2","Q2","strokeColor","addChartDataStyle","styles","unselected","lineColor","color","lineWidth","lineStyle","selected","getChart","chart","includes","getNormalizedChart","getScaledChart","spectraProcessor","scaled","getScaledData","getAutocorrelation","index","array1","array2","correlation","getNormalizedData","currentIDs","getNormalizedText","rs","allKeysObject","metum","keys","allKeys","join","getFromToIndex","xs","targetSpectrum","targetValue","minYPoint","values","factor","multiply","regression","computeX","range$1","targetID","relative","method","getSpectrum","getSpectra","subtract","SpectraProcessor","maxMemory","keepOriginal","boundaries","MAX_VALUE","MIN_VALUE","minY","maxY","getNormalizedBoundary","setNormalization","getNormalization","getMinMaxX","addFromJcamp","jcamp$1","force","contains","addFromData","random","substring","getSpectrumIndex","memoryInfo","getMemoryInfo","removeOriginals","removeSpectrum","splice","removeSpectraNotIn","forEach","fromNormalizedText","text$1","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","setTimeout","e","clearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","concat","drainQueue","timeout","len","run","nextTick","args","arguments","Item","array","apply","title","browser","env","argv","version","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","compareNumbers","a","b","sum","l","arithmeticMean","geometricMean","mul","pow","logMean","lnsum","log","grandMean","means","samples","n","truncatedMean","percent","alreadySorted","sort","k","floor","harmonicMean","RangeError","contraHarmonicMean","r1","r2","median","half","variance","unbiased","theMean","theVariance","sqrt","standardError","robustMeanAndStdev","stdev","averageDeviations","abs","quartiles","quart","q1","ceil","q3","pooledStandardDeviation","pooledVariance","vari","mode","itemCount","itemArray","count","indexOf","maxIndex","covariance","vector1","vector2","mean1","mean2","cov","skewness","s2","s3","dev","m2","m3","g","kurtosis","s4","m4","v","c","entropy","eps","weightedMean","weights","weightedStandardDeviation","weightedVariance","z","w","center","inPlace","standardize","standardDev","cumulativeSum","getConverter","ntuplesSeparator","GC_MS_FIELDS","convertToFloatArray","stringArray","floatArray","parseFloat","defaultOptions","withoutXY","chromatogram","keepSpectra","noContour","nbContourLevels","noiseMultiplier","profiling","assign","wantXY","start","Date","now","ntuples","ldr","dataLabel","dataValue","ldrs","endLine","infos","logs","action","time","replace","trim","toUpperCase","xIndex","yIndex","firstVariable","secondVariable","symbol","first","firstX","firstY","last","lastX","lastY","vardim","nbPoints","xFactor","yFactor","units","xUnit","datatable","deltaX","prepareSpectrum","fastParseXYData","parsePeakTable","parseXYA","twoD","observeFrequency","xType","indirectFrequency","shiftOffsetNum","shiftOffsetVal","varname","vartype","varform","yType","page","pageValue","pageSymbol","pageSymbolIndex","unit","isMSField","convertMSFieldToLabel","sampleDescription","newNtuples","add2D","newData","complexChromatogram","simpleChromatogram","times","series","ms","dimension","existingGCMSFields","intensity","shift","getMedian","convertTo3DZ","minZ","maxZ","ySize","xSize","xVector","noise","zData","contourLines","generateContourLines","povarHeight0","povarHeight1","povarHeight2","povarHeight3","isOver0","isOver1","isOver2","isOver3","nbSubSpectra","nbPovars","pAx","pAy","pBx","pBy","x0","xN","dx","y0","yN","dy","iter","contourLevels","lineZValue","level","contourLevel","side","exp","zValue","iSubSpectra","subSpectra","subSpectraAfter","povar","segments","isXYdata","currentData","currentX","currentY","ascii","charCodeAt","newLine","isDifference","isLastDifference","lastDifference","isDuplicate","inComment","currentValue","lastValue","isNegative","inValue","skipFirstValue","decimalPosition","duplicate","ascii2","removeSymbolRegExp","isXYAdata","removeCommentRegExp","peakTableSplitRegExp","isPeaktable","JcampConverter","useWorker","postToWorker","stamps","worker","createWorker","Promise","resolve","stamp","postMessage","workerURL","URL","createObjectURL","Blob","Worker","revokeObjectURL","addEventListener","event","output","createTree","flatten","flat","stack","current","ntupleLevel","spaces","labelLine","startsWith","children","finished","pop","entry","check","points","target","low","high","middle","integral","reduce","newX","newY","slot","sortX","minClosestYPoint","targetIndex","previousIndex","MIN_SAFE_INTEGER","currentIndex","maxClosestYPoint","getTargetIndex","realMinYPoint","alpha","beta","gamma","p","realMaxYPoint","maximaY","maxima","startEqualIndex","minimaY","peakInfo","currentDiff","multiplier","newDiff","after","before","inflectionBefore","inflectionAfter","extrema","inflectionMiddle","width","zeroFilling","re","im","newRE","newIM","XReIm","absolute","newArray","phaseCorrection","phi0","phi1","isFinite","delta","sin","cosTheta","cos","sinTheta","newRe","newIm","ReIm","add","isConstant","constant","array3","q1max","q3min","middleOver","divide","rotate","A","B","sumA","sumA2","sumB","sumB2","sumAB","_typeof","obj","Symbol","iterator","sequentialFill","_options","_options$from","_options$to","_options$size","size","step","_i","x1","slope","intercept","equallySpacedSmooth","xLength","halfStep","initialOriginalStep","lastOriginalStep","previousX","previousY","nextX","nextY","sumAtMin","sumAtMax","getSlope","y1","main","equallySpacedSlot","lastStep","frontOutsideSpectra","backOutsideSpectra","currentPoints","getZones","toRemove","previous","unitsPerPoint","zones","currentFrom","totalPoints","currentNbPoints","round","arrayXY","variant","xResult","yResult","zone","zoneResult","processZone","BaseRegression","new","predict","_predict","train","toLaTeX","score","y2","xSum","ySum","chi2","rmsd","xSquared","ySquared","xY","r","checkArraySize","maybeToPrecision","digits","toPrecision","coefficients","checkArrayLength","regress","toJSON","precision","absIntercept","operator","load","json","slr","numerator","minValue","currentMin","currentMax","_options$min","autoMinMax","_options$max","currentZoneIndex","sumValue","norm","_options$algorithm","algorithm","absoluteSumValue","absoluteSum","element"],"mappings":"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","file":"spectra-processor.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SpectraProcessor\"] = factory();\n\telse\n\t\troot[\"SpectraProcessor\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","'use strict';\n\nconst toString = Object.prototype.toString;\n\nfunction isAnyArray(object) {\n  return toString.call(object).endsWith('Array]');\n}\n\nmodule.exports = isAnyArray;\n","import isArray from 'is-any-array';\n\n/**\n * Computes the maximum of the given values\n * @param {Array<number>} input\n * @return {number}\n */\n\nfunction max(input) {\n  if (!isArray(input)) {\n    throw new TypeError('input must be an array');\n  }\n\n  if (input.length === 0) {\n    throw new TypeError('input must not be empty');\n  }\n\n  var maxValue = input[0];\n\n  for (var i = 1; i < input.length; i++) {\n    if (input[i] > maxValue) maxValue = input[i];\n  }\n\n  return maxValue;\n}\n\nexport default max;\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nfunction _interopDefault (ex) { return (ex && (typeof ex === 'object') && 'default' in ex) ? ex['default'] : ex; }\n\nvar Stat = require('ml-stat/array');\nvar Stat__default = _interopDefault(Stat);\nvar filterX = _interopDefault(require('ml-array-xy-filter-x'));\nvar equallySpaced = _interopDefault(require('ml-array-xy-equally-spaced'));\nvar normed = _interopDefault(require('ml-array-normed'));\nvar rescale = _interopDefault(require('ml-array-rescale'));\nvar mlSpectraProcessing = require('ml-spectra-processing');\nvar jcampconverter = require('jcampconverter');\nvar SimpleLinearRegression = _interopDefault(require('ml-regression-simple-linear'));\n\n/**\n *\n * @private\n * @param {Spectrum} spectrum\n * @param {object} [filter={}]\n * @param {array} [filter.from]\n * @param {array} [filter.to]\n * @param {array} [filter.exclusions=[]]\n */\n\nfunction getData(spectrum, filter = {}) {\n  let data = { x: spectrum.x, y: spectrum.y };\n\n  if (filter) {\n    data = filterX({ x: spectrum.x, y: spectrum.y }, filter);\n  }\n  return data;\n}\n\n/**\n *\n * @private\n * @param {*} spectrum\n * @param {*} options\n */\nfunction getNormalized(spectrum, options = {}) {\n  if (!Array.isArray(spectrum.x) || !Array.isArray(spectrum.y)) {\n    throw new Error(\n      'getNormalized: Can not get normalized data, missing original data.'\n    );\n  }\n\n  let {\n    from = spectrum.x[0],\n    to = spectrum.x[spectrum.x.length - 1],\n    numberOfPoints = 1024,\n    filters = [],\n    exclusions = []\n  } = options;\n\n  let y = spectrum.y.slice(0);\n\n  for (let filter of filters) {\n    switch (filter.name) {\n      case 'centerMean': {\n        let mean = Stat__default.mean(spectrum.y);\n        let meanFct = (y) => y - mean;\n        y = y.map(meanFct);\n        break;\n      }\n      case 'scaleSD': {\n        let std = Stat__default.standardDeviation(spectrum.y);\n        let stdFct = (y) => y / std;\n        y = y.map(stdFct);\n        break;\n      }\n      case 'normalize': {\n        y = normed(y);\n        break;\n      }\n      case 'rescale': {\n        y = rescale(y);\n        break;\n      }\n      case '':\n      case undefined:\n        break;\n      default:\n        throw new Error(`Unknown process kind: ${process.kind}`);\n    }\n  }\n  let result = equallySpaced(\n    { x: spectrum.x, y },\n    { from, to, numberOfPoints, exclusions }\n  );\n  return result;\n}\n\n/**\n *  @private\n * @param {*} spectrum\n * @param {*} ranges\n */\nfunction updateRangesInfo(spectrum, ranges = []) {\n  spectrum.ranges = {};\n  for (let range of ranges) {\n    range = JSON.parse(JSON.stringify(range));\n    spectrum.ranges[range.label] = range;\n    let fromToIndex = {\n      fromIndex: mlSpectraProcessing.X.findClosestIndex(spectrum.normalized.x, range.from),\n      toIndex: mlSpectraProcessing.X.findClosestIndex(spectrum.normalized.x, range.to)\n    };\n    range.integration = mlSpectraProcessing.XY.integration(spectrum.normalized, fromToIndex);\n    range.maxPoint = mlSpectraProcessing.XY.maxYPoint(spectrum.normalized, fromToIndex);\n  }\n}\n\n/**\n * Class allowing manipulate one IR spectrum\n * @class spectrum\n * @param {object} [json={}] - object containing a spectrum\n * @param {Array} [json.x=[]] - x values\n * @param {Array} [json.y=[]] - y values\n */\nclass Spectrum {\n  /**\n   *\n   * @param {array} x\n   * @param {array} y\n   * @param {string} id\n   * @param {object} [options={}]\n   * @param {object} [options.meta={}]\n   * @param {object} [options.normalization]\n   * @param {object} [options.normalized]\n   */\n  constructor(x, y, id, options = {}) {\n    const { meta = {}, normalization = {}, normalized } = options;\n\n    if (x && x.length > 1 && x[0] > x[1]) {\n      this.x = x.reverse();\n      this.y = y.reverse();\n    } else {\n      this.x = x || [];\n      this.y = y || [];\n    }\n    this.id = id;\n    this.meta = meta;\n    this.normalizedBoundary = { x: { min: 0, max: 0 }, y: { min: 0, max: 0 } };\n    if (normalized) {\n      this.normalized = normalized;\n      this.updateNormalizedBoundary();\n    } else {\n      this.updateNormalization(normalization);\n    }\n\n    this.updateMemory();\n  }\n\n  get minX() {\n    return this.x[0];\n  }\n\n  get maxX() {\n    return this.x[this.x.length - 1];\n  }\n\n  updateMemory() {\n    let original = ((this.x && this.x.length) || 0) * 16;\n    let normalized = this.normalized.x.length * 16;\n    this.memory = { original, normalized, total: original + normalized };\n  }\n\n  removeOriginal() {\n    this.x = undefined;\n    this.y = undefined;\n    this.updateMemory();\n  }\n\n  getXY() {\n    if (!Array.isArray(this.x) || !Array.isArray(this.y)) {\n      throw new Error('Can not get normalized data');\n    }\n    return { x: this.x, y: this.y };\n  }\n}\n\nSpectrum.prototype.getData = function(options) {\n  return getData(this, options);\n};\n\nSpectrum.prototype.updateNormalization = function(normalization) {\n  this.normalized = getNormalized(this, normalization);\n  this.ranges = {};\n  this.updateMemory();\n  this.updateNormalizedBoundary();\n};\n\nSpectrum.prototype.updateRangesInfo = function(ranges) {\n  updateRangesInfo(this, ranges);\n};\n\nSpectrum.prototype.updateNormalizedBoundary = function() {\n  this.normalizedBoundary.x = {\n    min: this.normalized.x[0],\n    max: this.normalized.x[this.normalized.x.length - 1]\n  };\n  this.normalizedBoundary.y = Stat.minMax(this.normalized.y);\n};\n\nfunction getJcampKind(data) {\n  let datatype = data.spectra[0].dataType.toLowerCase();\n  let yUnit = data.spectra[0].yUnit.toLowerCase();\n\n  if (datatype.match(/infrared/)) {\n    if (yUnit.match(/absorbance/)) {\n      return IR_ABSORBANCE;\n    } else {\n      return IR_TRANSMITTANCE;\n    }\n  }\n  return undefined;\n}\n\nconst IR_TRANSMITTANCE = {\n  normalization: {},\n  importation: {\n    converter: (transmittance) => -Math.log10(transmittance)\n  },\n  kind: 'Infrared',\n  display: {\n    xLabel: 'wavelength [cm-1]',\n    xInverted: true,\n    yLabel: 'Absorbance'\n  }\n};\n\nconst IR_ABSORBANCE = {\n  normalization: {},\n  kind: 'Infrared',\n  display: {\n    xLabel: 'wavelength [cm-1]',\n    xInverted: true,\n    yLabel: 'Absorbance'\n  }\n};\n\n/**\n * Create a spectrum from a jcamp\n * @param {string} jcamp - String containing the JCAMP data\n * @return {Spectrum} - new instance of Spectrum with the provided data\n */\nfunction jcamp(jcamp) {\n  const parsed = jcampconverter.convert(jcamp, { xy: true, keepRecordsRegExp: /TITLE/ });\n  const kind = getJcampKind(parsed);\n  const data = parsed.spectra[0].data[0];\n  const meta = parsed.info;\n  // we convert the data\n  if (kind && kind.importation && kind.importation.converter) {\n    data.y = data.y.map(kind.importation.converter);\n  }\n\n  return { data, kind, meta };\n}\n\n/**\n * Creates a g\n * @param {string} text - String containing the JCAMP data\n * @param {object} [options={}]\n * @param {string} [options.fs='\\t'] Field separator\n * @return {object} - {matrix, data, x, ids}\n */\nfunction text(text, options = {}) {\n  const lines = text.split(/[\\r\\n]+/).filter((value) => value);\n  const { fs = '\\t' } = options;\n  let matrix = [];\n  let ids = [];\n  let meta = [];\n  let x = [];\n\n  let headers = lines[0].split(fs);\n  let labels = [];\n\n  for (let i = 0; i < headers.length; i++) {\n    let header = headers[i];\n    if (isNaN(header)) {\n      labels[i] = header;\n    } else {\n      x = headers.slice(i).map((value) => Number(value));\n      break;\n    }\n  }\n\n  for (let i = 1; i < lines.length; i++) {\n    let line = lines[i];\n    let parts = line.split('\\t');\n    ids.push(parts[0]);\n    let oneMeta = {};\n    meta.push(oneMeta);\n    for (let j = 1; j < parts.length; j++) {\n      if (j < labels.length) {\n        oneMeta[labels[j]] = parts[j];\n      } else {\n        matrix.push(parts.slice(labels.length).map((value) => Number(value)));\n        break;\n      }\n    }\n  }\n  return { x, meta, matrix, ids };\n}\n\nfunction getNormalizationAnnotations(filter = {}, boundary) {\n  let { exclusions = [] } = filter;\n  let annotations = [];\n  exclusions = exclusions.filter((exclusion) => !exclusion.ignore);\n  annotations = exclusions.map((exclusion) => {\n    var annotation = {\n      type: 'rect',\n      position: [\n        { x: exclusion.from, y: boundary.y.min },\n        { x: exclusion.to, y: boundary.y.max }\n      ],\n      strokeWidth: 0,\n      fillColor: 'rgba(255,255,224,1)'\n    };\n    return annotation;\n  });\n  if (filter.from !== undefined) {\n    annotations.push({\n      type: 'rect',\n      position: [\n        { x: 0, y: boundary.y.min },\n        { x: filter.from, y: boundary.y.max }\n      ],\n      strokeWidth: 0,\n      fillColor: 'rgba(255,255,224,1)'\n    });\n  }\n  if (filter.to !== undefined) {\n    annotations.push({\n      type: 'rect',\n      position: [\n        { x: filter.to, y: boundary.y.min },\n        { x: 10000, y: boundary.y.max }\n      ],\n      strokeWidth: 0,\n      fillColor: 'rgba(255,255,224,1)'\n    });\n  }\n  return annotations;\n}\n\n/**\n * @private\n * @param {*} spectra\n */\n\nfunction getBoxPlotData(spectra) {\n  let matrix = [];\n  let x = spectra[0].normalized.x;\n  for (let spectrum of spectra) {\n    matrix.push(spectrum.normalized.y);\n  }\n\n  let nbRow = matrix.length;\n  let nbColumn = matrix[0].length;\n  let result;\n  let aColumn = new Float64Array(nbRow);\n  for (let column = 0; column < nbColumn; column++) {\n    for (let row = 0; row < nbRow; row++) {\n      aColumn[row] = matrix[row][column];\n    }\n    let info = mlSpectraProcessing.X.boxPlot(aColumn);\n    if (!result) {\n      result = { x };\n      for (let key in info) {\n        result[key] = [];\n      }\n    }\n    for (let key in info) {\n      result[key].push(info[key]);\n    }\n  }\n  return result;\n}\n\nfunction getBoxPlotAnnotations(spectra, options = {}) {\n  const {\n    q13FillColor = '#000',\n    q13FillOpacity = 0.3,\n    q2StrokeColor = '#000',\n    q2StrokeWidth = 3,\n    minMaxFillColor = '#000',\n    minMaxFillOpacity = 0.15\n  } = options;\n  let annotations = [];\n\n  let data = getBoxPlotData(spectra);\n  if (q13FillOpacity && q13FillColor) {\n    let q13 = [];\n    for (let i = 0; i < data.x.length; i++) {\n      q13.push({\n        x: data.x[i],\n        y: data.Q1[i]\n      });\n    }\n    for (let i = data.x.length - 1; i >= 0; i--) {\n      q13.push({\n        x: data.x[i],\n        y: data.Q3[i]\n      });\n    }\n    annotations.push({\n      type: 'polygon',\n      layer: 0,\n      properties: {\n        fillColor: q13FillColor,\n        fillOpacity: q13FillOpacity,\n        strokeWidth: 0.0000001,\n        position: q13\n      }\n    });\n  }\n\n  if (q2StrokeColor && q2StrokeWidth) {\n    let q2 = [];\n    for (let i = 0; i < data.x.length; i++) {\n      q2.push({\n        x: data.x[i],\n        y: data.Q2[i]\n      });\n    }\n    // Temp code because polyline is not working\n    for (let i = data.x.length - 1; i >= 0; i--) {\n      q2.push({\n        x: data.x[i],\n        y: data.Q2[i]\n      });\n    }\n\n    annotations.push({\n      type: 'polygon',\n      layer: 0,\n      properties: {\n        strokeWidth: q2StrokeWidth,\n        strokeColor: q2StrokeColor,\n        position: q2\n      }\n    });\n  }\n\n  if (minMaxFillColor && minMaxFillOpacity) {\n    let minMax = [];\n    for (let i = 0; i < data.x.length; i++) {\n      minMax.push({\n        x: data.x[i],\n        y: data.min[i]\n      });\n    }\n    for (let i = data.x.length - 1; i >= 0; i--) {\n      minMax.push({\n        x: data.x[i],\n        y: data.max[i]\n      });\n    }\n\n    annotations.push({\n      type: 'polygon',\n      layer: 0,\n      properties: {\n        fillColor: minMaxFillColor,\n        fillOpacity: minMaxFillOpacity,\n        strokeWidth: 0.0000001,\n        strokeColor: '#FFF',\n        position: minMax\n      }\n    });\n  }\n\n  return annotations;\n}\n\nfunction addChartDataStyle(data, spectrum) {\n  data.styles = {\n    unselected: {\n      lineColor: spectrum.meta.color || 'darkgrey',\n      lineWidth: 1,\n      lineStyle: 1\n    },\n    selected: {\n      lineColor: spectrum.meta.color || 'darkgrey',\n      lineWidth: 3,\n      lineStyle: 1\n    }\n  };\n  data.label = spectrum.meta.id || spectrum.id;\n}\n\n/**\n * Retrieve a chart with selected original data\n * @param {object} [options={}]\n * @param {Array} [options.ids] List of spectra ids, by default all\n * @param {Array} [options.maxDataPoints=]\n */\nfunction getChart(spectra, options = {}) {\n  const { ids } = options;\n  let chart = {\n    data: []\n  };\n  for (let spectrum of spectra) {\n    if (!ids || ids.includes(spectrum.id)) {\n      let data = spectrum.getData();\n      addChartDataStyle(data, spectrum);\n      chart.data.push(data);\n    }\n  }\n  return chart;\n}\n\nfunction getNormalizedChart(spectra, options = {}) {\n  const { ids } = options;\n  let chart = {\n    data: []\n  };\n  for (let spectrum of spectra) {\n    if (!ids || ids.includes(spectrum.id)) {\n      let data = spectrum.normalized;\n      addChartDataStyle(data, spectrum);\n      chart.data.push(data);\n    }\n  }\n  return chart;\n}\n\n/**\n *\n * @param {SpectraProcessor} spectraProcessor\n * @param {object} [options={}] scale spectra based on various parameters\n * @param {object} [options.range] from - to\n * @param {Array} [options.ids] ids of selected spectra\n * @param {string} [options.targetID=spectra[0].id]\n * @param {string} [options.method='max'] min, max, range, minMax\n * @param {boolean} [options.relative=false]\n */\nfunction getScaledChart(spectraProcessor, options = {}) {\n  let scaled = spectraProcessor.getScaledData(options);\n\n  let chart = {\n    data: []\n  };\n\n  for (let i = 0; i < scaled.matrix.length; i++) {\n    let data = {\n      x: scaled.x,\n      y: scaled.matrix[i]\n    };\n    addChartDataStyle(data, { meta: scaled.meta[i], id: scaled.ids[i] });\n    chart.data.push(data);\n  }\n\n  return chart;\n}\n\n/**\n * @private\n */\n\nfunction getAutocorrelation(normalized, index) {\n  let matrix = normalized.matrix;\n  let nbRow = matrix.length;\n  let nbColumn = matrix[0].length;\n  let array1 = new Float64Array(nbRow);\n  let array2 = new Float64Array(nbRow);\n  let result = new Array(nbColumn);\n  for (let j = 0; j < nbRow; j++) {\n    array1[j] = matrix[j][index];\n  }\n  for (let i = 0; i < nbColumn; i++) {\n    for (let j = 0; j < nbRow; j++) {\n      array2[j] = matrix[j][i];\n    }\n    result[i] = mlSpectraProcessing.X.correlation(array1, array2);\n  }\n  return {\n    x: normalized.x,\n    y: result\n  };\n}\n\n/**\n * @private\n * @param {*} spectra\n * @param {*} options\n */\n\nfunction getNormalizedData(spectra) {\n  if (!spectra || !spectra[0]) return {};\n  let matrix = [];\n  let meta = [];\n  let currentIDs = [];\n\n  for (let spectrum of spectra) {\n    currentIDs.push(spectrum.id);\n    matrix.push(spectrum.normalized.y);\n    meta.push(spectrum.meta);\n  }\n  let x = spectra[0].normalized.x;\n  return { ids: currentIDs, matrix, meta, x };\n}\n\n/**\n * @private\n * @param {*} spectra\n * @param {object} [options={}]\n * @param {string} [options.fs='\\t'] field separator\n * @param {string} [options.rs='\\n'] record (line) separator\n */\n\nfunction getNormalizedText(spectra, options = {}) {\n  let { fs = '\\t', rs = '\\n' } = options;\n  let { matrix, meta, ids, x } = getNormalizedData(spectra);\n  let allKeysObject = {};\n  for (let metum of meta) {\n    for (let key of Object.keys(metum)) {\n      let type = typeof metum[key];\n      if (type === 'number' || type === 'string' || type === 'boolean') {\n        allKeysObject[key] = true;\n      }\n    }\n  }\n  let allKeys = Object.keys(allKeysObject);\n\n  let lines = [];\n  let line = [];\n  line.push('id', ...allKeys, ...x);\n  lines.push(line.join(fs));\n\n  for (let i = 0; i < ids.length; i++) {\n    line = [];\n    line.push(ids[i]);\n    for (let key of allKeys) {\n      line.push(meta[i][key]);\n    }\n    line.push(...matrix[i]);\n    lines.push(line.join(fs));\n  }\n\n  return lines.join(rs);\n}\n\nfunction getFromToIndex(xs, range) {\n  let { from, to } = range;\n  if (from === undefined) {\n    from = xs[0];\n  }\n  if (to === undefined) {\n    to = xs[xs.length - 1];\n  }\n\n  return {\n    fromIndex: mlSpectraProcessing.X.findClosestIndex(xs, from),\n    toIndex: mlSpectraProcessing.X.findClosestIndex(xs, to)\n  };\n}\n\nfunction min(spectra, targetSpectrum, range = {}) {\n  let fromToIndex = getFromToIndex(targetSpectrum.normalized.x, range);\n\n  let targetValue = mlSpectraProcessing.XY.minYPoint(targetSpectrum.normalized, fromToIndex).y;\n\n  let values = spectra.map(\n    (spectrum) => mlSpectraProcessing.XY.minYPoint(spectrum.normalized, fromToIndex).y\n  );\n\n  let matrix = [];\n  for (let i = 0; i < spectra.length; i++) {\n    let spectrum = spectra[i];\n    let factor = targetValue / values[i];\n    matrix.push(mlSpectraProcessing.X.multiply(spectrum.normalized.y, factor));\n  }\n\n  return matrix;\n}\n\nfunction max(spectra, targetSpectrum, range = {}) {\n  let fromToIndex = getFromToIndex(targetSpectrum.normalized.x, range);\n\n  let targetValue = mlSpectraProcessing.XY.maxYPoint(targetSpectrum.normalized, fromToIndex).y;\n\n  let values = spectra.map(\n    (spectrum) => mlSpectraProcessing.XY.maxYPoint(spectrum.normalized, fromToIndex).y\n  );\n\n  let matrix = [];\n  for (let i = 0; i < spectra.length; i++) {\n    let spectrum = spectra[i];\n    let factor = targetValue / values[i];\n    matrix.push(mlSpectraProcessing.X.multiply(spectrum.normalized.y, factor));\n  }\n\n  return matrix;\n}\n\nfunction minMax(spectra, targetSpectrum, range = {}) {\n  let fromToIndex = getFromToIndex(targetSpectrum.normalized.x, range);\n\n  let targetValue = {\n    min: mlSpectraProcessing.XY.minYPoint(targetSpectrum.normalized, fromToIndex).y,\n    max: mlSpectraProcessing.XY.maxYPoint(targetSpectrum.normalized, fromToIndex).y\n  };\n\n  let values = spectra.map((spectrum) => {\n    return {\n      min: mlSpectraProcessing.XY.minYPoint(spectrum.normalized, fromToIndex).y,\n      max: mlSpectraProcessing.XY.maxYPoint(spectrum.normalized, fromToIndex).y\n    };\n  });\n\n  let matrix = [];\n  for (let i = 0; i < spectra.length; i++) {\n    let spectrum = spectra[i];\n    const regression = new SimpleLinearRegression(\n      [targetValue.min, targetValue.max],\n      [values[i].min, values[i].max]\n    );\n\n    let length = spectrum.normalized.y.length;\n    let scaled = new Array(length);\n    for (let j = 0; j < length; j++) {\n      scaled[j] = regression.computeX(spectrum.normalized.y[j]);\n    }\n    matrix.push(scaled);\n  }\n\n  return matrix;\n}\n\nfunction range(spectra, targetSpectrum, range = {}) {\n  let fromToIndex = getFromToIndex(targetSpectrum.normalized.x, range);\n\n  let targetValue = mlSpectraProcessing.XY.integration(targetSpectrum.normalized, fromToIndex);\n\n  let values = spectra.map((spectrum) =>\n    mlSpectraProcessing.XY.integration(spectrum.normalized, fromToIndex)\n  );\n\n  let matrix = [];\n  for (let i = 0; i < spectra.length; i++) {\n    let spectrum = spectra[i];\n    let factor = targetValue / values[i];\n    matrix.push(mlSpectraProcessing.X.multiply(spectrum.normalized.y, factor));\n  }\n\n  return matrix;\n}\n\n/**\n * @private\n * @param {Array<Spectrum>} spectra\n * @param {object} [options={}] scale spectra based on various parameters\n * @param {object} [options.range] from - to\n * @param {Array} [options.ids] ids of selected spectra\n * @param {string} [options.targetID=spectra[0].id]\n * @param {string} [options.method='max'] min, max, range, minMax\n * @param {boolean} [options.relative=false]\n * @returns {object} { ids:[], matrix:[Array], meta:[object], x:[] }\n */\n\nfunction getScaledData(spectraProcessor, options = {}) {\n  if (!spectraProcessor.spectra || !spectraProcessor.spectra[0]) return {};\n  const { range: range$1, targetID, relative, method, ids } = options;\n\n  let targetSpectrum =\n    spectraProcessor.getSpectrum(targetID) || spectraProcessor.spectra[0];\n  let spectra = spectraProcessor.getSpectra(ids);\n\n  let result;\n  if (method === '' || method === undefined) {\n    result = getNormalizedData(spectra);\n  } else {\n    let matrix;\n    switch (method.toLowerCase()) {\n      case 'min':\n        matrix = min(spectra, targetSpectrum, range$1);\n        break;\n      case 'max':\n        matrix = max(spectra, targetSpectrum, range$1);\n        break;\n      case 'minmax':\n        matrix = minMax(spectra, targetSpectrum, range$1);\n        break;\n      case 'range':\n        matrix = range(spectra, targetSpectrum, range$1);\n        break;\n      default:\n        throw new Error(`getScaledData: unknown method: ${method}`);\n    }\n    let meta = [];\n    let currentIDs = [];\n    for (let spectrum of spectra) {\n      currentIDs.push(spectrum.id);\n      meta.push(spectrum.meta);\n    }\n    let x = spectra[0].normalized.x;\n    result = { ids: currentIDs, matrix, meta, x };\n  }\n\n  if (relative) {\n    for (let i = 0; i < result.matrix.length; i++) {\n      result.matrix[i] = mlSpectraProcessing.X.subtract(\n        result.matrix[i],\n        targetSpectrum.normalized.y\n      );\n    }\n  }\n\n  return result;\n}\n\nclass SpectraProcessor {\n  /**\n   * Manager a large number of spectra with the possibility to normalize the data\n   * and skip the original data.\n   * @param {object} [options={}]\n   * @param {boolean} [options.maxMemory=64M]\n   * @param {object} [options.normalization={}] options to normalize the spectra before comparison\n   * @param {number} [options.normalization.from]\n   * @param {number} [options.normalization.to]\n   * @param {number} [options.normalization.numberOfPoints]\n   * @param {array<object>} [options.normalization.filters]\n   * @param {string} [options.normalization.filters.X.name]\n   * @param {object} [options.normalization.filters.X.options]\n   * @param {array<object>} [options.normalization.exclusions]\n   * @param {string} [options.normalization.exclusions.X.from]\n   * @param {object} [options.normalization.exclusions.X.to]\n   */\n  constructor(options = {}) {\n    this.normalization = options.normalization;\n    this.maxMemory = options.maxMemory || 64 * 1024 * 1024;\n    this.keepOriginal = true;\n    this.spectra = [];\n    this.boundaries = {\n      minX: Number.MAX_VALUE,\n      maxX: Number.MIN_VALUE,\n      minY: Number.MAX_VALUE,\n      maxY: Number.MIN_VALUE\n    };\n  }\n\n  getNormalizationAnnotations() {\n    return getNormalizationAnnotations(\n      this.normalization,\n      this.getNormalizedBoundary()\n    );\n  }\n\n  /**\n   * Recalculate the normalized data using the stored original data if available\n   * This will throw an error in the original data is not present\n   * @param {number} [normalization.from]\n   * @param {number} [normalization.to]\n   * @param {number} [normalization.numberOfPoints]\n   * @param {array<object>} [normalization.filters]\n   * @param {string} [normalization.filters.X.name]\n   * @param {object} [normalization.filters.X.options]\n   * @param {array<object>} [normalization.exclusions]\n   * @param {string} [normalization.exclusions.X.from]\n   * @param {object} [normalization.exclusions.X.to]\n   */\n  setNormalization(normalization = {}) {\n    if (JSON.stringify(this.normalization) === JSON.stringify(normalization)) {\n      return;\n    }\n    this.normalization = normalization;\n    for (let spectrum of this.spectra) {\n      spectrum.updateNormalization(this.normalization);\n    }\n  }\n\n  getNormalization() {\n    return this.normalization;\n  }\n\n  /**\n   * Returns an object {x:[], y:[]} containing the autocorrelation for the\n   * specified index\n   * @param {integer} [index] point of the spectrum to autocorrelate\n   */\n  getAutocorrelation(index, options) {\n    return getAutocorrelation(this.getNormalizedData(options), index);\n  }\n\n  /**\n   * Returns an object contains 4 parameters with the normalized data\n   * @returns {object} { ids:[], matrix:[Array], meta:[object], x:[] }\n   * @param {object} [options={}]\n   * @param {Array} [options.ids] List of spectra ids to export, by default all\n   */\n  getNormalizedData(options = {}) {\n    const { ids } = options;\n    let spectra = this.getSpectra(ids);\n    return getNormalizedData(spectra);\n  }\n\n  /**\n   * Returns a tab separated value containing the normalized data\n   * @param {object} [options={}]\n   * @param {Array} [options.ids] List of spectra ids to export, by default all\n   * @param {string} [options.fs='\\t'] field separator\n   * @param {string} [options.rs='\\n'] record (line) separator\n   * @returns {string}\n   */\n  getNormalizedText(options = {}) {\n    const { ids } = options;\n    let spectra = this.getSpectra(ids);\n    return getNormalizedText(spectra, options);\n  }\n\n  getMinMaxX() {\n    let min = Number.MAX_VALUE;\n    let max = Number.MIN_VALUE;\n    for (let spectrum of this.spectra) {\n      if (spectrum.minX < min) min = spectrum.minX;\n      if (spectrum.maxX > max) max = spectrum.maxX;\n    }\n    return { min, max };\n  }\n\n  /**\n\n   * Returns an object contains 4 parameters with the scaled data\n   * @param {object} [options={}] scale spectra based on various parameters\n   * @param {object} [options.range] from - to\n   * @param {Array} [options.ids] ids of selected spectra, by default all\n   * @param {string} [options.targetID=spectra[0].id]\n   * @param {string} [options.method='max'] min, max, range, minMax\n   * @param {boolean} [options.relative=false]\n   * @returns {object} { ids:[], matrix:[Array], meta:[object], x:[] }\n   */\n  getScaledData(options) {\n    return getScaledData(this, options);\n  }\n\n  /**\n   * Add jcamp\n   * By default TITLE from the jcamp will be in the meta information\n   * @param {string} jcamp\n   * @param {object} [options={}]\n   * @param {object} [options.meta={}]\n   * @param {string} [options.meta.color]\n   * @param {object} [options.id={}]\n   * @param {boolean} [options.force=false] replace existing spectrum (same ID)\n   */\n\n  addFromJcamp(jcamp$1, options = {}) {\n    if (options.force !== true && options.id && this.contains(options.id)) {\n      return;\n    }\n    let parsed = jcamp(jcamp$1);\n    let meta = { ...parsed.meta, ...(options.meta || {}) };\n    this.addFromData(parsed.data, { meta, id: options.id });\n  }\n\n  updateRangesInfo(options) {\n    for (let spectrum of this.spectra) {\n      spectrum.updateRangesInfo(options);\n    }\n  }\n\n  /**\n   * Add a spectrum based on the data\n   * @param {object} data {x, y}}\n   * @param {object} [options={}]\n   * @param {object} [options.meta={}]\n   * @param {object} [options.id]\n   * @param {object} [options.normalization={}]\n   * @param {object} [options.normalized]\n   * @return {Spectrum}\n   */\n\n  addFromData(data, options = {}) {\n    if (this.spectra.length === 0) this.keepOriginal = true;\n    const id = options.id || Math.random(0).toString(36).substring;\n    let index = this.getSpectrumIndex(id);\n    if (index === undefined) index = this.spectra.length;\n    let spectrum = new Spectrum(data.x, data.y, id, {\n      meta: options.meta,\n      normalized: options.normalized,\n      normalization: this.normalization\n    });\n    this.spectra[index] = spectrum;\n    if (!this.keepOriginal) {\n      spectrum.removeOriginal();\n    } else {\n      let memoryInfo = this.getMemoryInfo();\n      if (memoryInfo.total > this.maxMemory) {\n        this.keepOriginal = false;\n        this.removeOriginals();\n      }\n    }\n  }\n\n  removeOriginals() {\n    for (let spectrum of this.spectra) {\n      spectrum.removeOriginal();\n    }\n  }\n\n  /**\n   * Remove the spectrum from the SpectraProcessor for the specified id\n   * @param {string} id\n   */\n  removeSpectrum(id) {\n    let index = this.getSpectrumIndex(id);\n    if (index === undefined) return undefined;\n    return this.spectra.splice(index, 1);\n  }\n\n  /**\n   * Remove all the spectra not present in the list\n   * @param {Array} [ids] Array of ids of the spectra to keep\n   */\n  removeSpectraNotIn(ids) {\n    let currentIDs = this.spectra.map(spectrum => spectrum.id);\n    for (let id of currentIDs) {\n      if (!ids.includes(id)) {\n        this.removeSpectrum(id);\n      }\n    }\n  }\n\n  /**\n   * Checks if the ID of a spectrum exists in the SpectraProcessor\n   * @param {string} id\n   */\n  contains(id) {\n    return !isNaN(this.getSpectrumIndex(id));\n  }\n\n  /**\n   * Returns the index of the spectrum in the spectra array\n   * @param {string} id\n   * @returns {number}\n   */\n  getSpectrumIndex(id) {\n    if (!id) return undefined;\n    for (let i = 0; i < this.spectra.length; i++) {\n      let spectrum = this.spectra[i];\n      if (spectrum.id === id) return i;\n    }\n    return undefined;\n  }\n\n  /**\n   * Returns a spectrum from its ID\n   * @param {Array} ids\n   * @returns {Array<Spectrum}\n   */\n  getSpectra(ids) {\n    if (!ids || !Array.isArray(ids)) return this.spectra;\n    let spectra = [];\n    for (let id of ids) {\n      let index = this.getSpectrumIndex(id);\n      if (index !== undefined) {\n        spectra.push(this.spectra[index]);\n      }\n    }\n    return spectra;\n  }\n\n  /**\n   * Returns the index of the spectrum in the spectra array\n   * @param {string} id\n   * @returns {number}\n   */\n  getSpectrum(id) {\n    let index = this.getSpectrumIndex(id);\n    if (index === undefined) return undefined;\n    return this.spectra[index];\n  }\n\n  /**\n   * Returns a JSGraph chart object for all the spectra\n   * @returns {object}\n   */\n  getChart() {\n    return getChart(this.spectra);\n  }\n\n  /**\n   * Returns a JSGraph annotation object for box plot\n   * @returns {object}\n   */\n  getBoxPlotAnnotations(options) {\n    return getBoxPlotAnnotations(this.spectra, options);\n  }\n\n  /**\n   * Returns a JSGraph chart object for all the normalized spectra\n   * @param {object} [options={}]\n   * @param {Array} [options.ids] ids of the spectra to select, by default all\n   * @returns {object}\n   */\n  getNormalizedChart(options) {\n    return getNormalizedChart(this.spectra, options);\n  }\n\n  /**\n   * Returns a JSGraph chart object for all the scaled normalized spectra\n   * @param {object} [options={}]\n   * @param {Array} [options.ids] ids of the spectra to select, by default all\n   * @param {object} [options.range] from - to\n   * @param {string} [options.targetID=spectra[0].id]\n   * @param {string} [options.method='max'] min, max, range, minMax\n   * @param {boolean} [options.relative=false]\n   * @returns {object}\n   */\n  getScaledChart(options) {\n    return getScaledChart(this, options);\n  }\n\n  getMemoryInfo() {\n    let memoryInfo = { original: 0, normalized: 0, total: 0 };\n    this.spectra.forEach(spectrum => {\n      let memory = spectrum.memory;\n      memoryInfo.original += memory.original;\n      memoryInfo.normalized += memory.normalized;\n      memoryInfo.total += memory.total;\n    });\n    memoryInfo.keepOriginal = this.keepOriginal;\n    memoryInfo.maxMemory = this.maxMemory;\n    return memoryInfo;\n  }\n\n  getNormalizedBoundary() {\n    let boundary = {\n      x: { min: Number.MAX_VALUE, max: Number.MIN_VALUE },\n      y: { min: Number.MAX_VALUE, max: Number.MIN_VALUE }\n    };\n    for (let spectrum of this.spectra) {\n      if (spectrum.normalizedBoundary.x.min < boundary.x.min) {\n        boundary.x.min = spectrum.normalizedBoundary.x.min;\n      }\n      if (spectrum.normalizedBoundary.x.max > boundary.x.max) {\n        boundary.x.max = spectrum.normalizedBoundary.x.max;\n      }\n      if (spectrum.normalizedBoundary.y.min < boundary.y.min) {\n        boundary.y.min = spectrum.normalizedBoundary.y.min;\n      }\n      if (spectrum.normalizedBoundary.y.max > boundary.y.max) {\n        boundary.y.max = spectrum.normalizedBoundary.y.max;\n      }\n    }\n    return boundary;\n  }\n\n  /**\n   * Create SpectraProcessor from normalized TSV\n   * @param {string} text\n   * @param {object} [options={}]\n   * @param {object} [options.separator='\\t']\n   */\n  static fromNormalizedText(text$1, options = {}) {\n    let parsed = text(text$1, options);\n    if (!parsed) {\n      throw new Error('Can not parse TSV file');\n    }\n    let spectraProcessor = new SpectraProcessor();\n\n    spectraProcessor.setNormalization({\n      from: parsed.x[0],\n      to: parsed.x[parsed.x.length - 1],\n      numberOfPoints: parsed.x.length\n    });\n    spectraProcessor.keepOriginal = false;\n\n    for (let i = 0; i < parsed.ids.length; i++) {\n      spectraProcessor.addFromData(\n        { x: [], y: [] },\n        {\n          normalized: {\n            x: parsed.x,\n            y: parsed.matrix[i]\n          },\n          id: parsed.ids[i],\n          meta: parsed.meta[i]\n        }\n      );\n    }\n\n    return spectraProcessor;\n  }\n}\n\nexports.SpectraProcessor = SpectraProcessor;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","'use strict';\n\nfunction compareNumbers(a, b) {\n    return a - b;\n}\n\n/**\n * Computes the sum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.sum = function sum(values) {\n    var sum = 0;\n    for (var i = 0; i < values.length; i++) {\n        sum += values[i];\n    }\n    return sum;\n};\n\n/**\n * Computes the maximum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.max = function max(values) {\n    var max = values[0];\n    var l = values.length;\n    for (var i = 1; i < l; i++) {\n        if (values[i] > max) max = values[i];\n    }\n    return max;\n};\n\n/**\n * Computes the minimum of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.min = function min(values) {\n    var min = values[0];\n    var l = values.length;\n    for (var i = 1; i < l; i++) {\n        if (values[i] < min) min = values[i];\n    }\n    return min;\n};\n\n/**\n * Computes the min and max of the given values\n * @param {Array} values\n * @returns {{min: number, max: number}}\n */\nexports.minMax = function minMax(values) {\n    var min = values[0];\n    var max = values[0];\n    var l = values.length;\n    for (var i = 1; i < l; i++) {\n        if (values[i] < min) min = values[i];\n        if (values[i] > max) max = values[i];\n    }\n    return {\n        min: min,\n        max: max\n    };\n};\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.arithmeticMean = function arithmeticMean(values) {\n    var sum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        sum += values[i];\n    }\n    return sum / l;\n};\n\n/**\n * {@link arithmeticMean}\n */\nexports.mean = exports.arithmeticMean;\n\n/**\n * Computes the geometric mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.geometricMean = function geometricMean(values) {\n    var mul = 1;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        mul *= values[i];\n    }\n    return Math.pow(mul, 1 / l);\n};\n\n/**\n * Computes the mean of the log of the given values\n * If the return value is exponentiated, it gives the same result as the\n * geometric mean.\n * @param {Array} values\n * @returns {number}\n */\nexports.logMean = function logMean(values) {\n    var lnsum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        lnsum += Math.log(values[i]);\n    }\n    return lnsum / l;\n};\n\n/**\n * Computes the weighted grand mean for a list of means and sample sizes\n * @param {Array} means - Mean values for each set of samples\n * @param {Array} samples - Number of original values for each set of samples\n * @returns {number}\n */\nexports.grandMean = function grandMean(means, samples) {\n    var sum = 0;\n    var n = 0;\n    var l = means.length;\n    for (var i = 0; i < l; i++) {\n        sum += samples[i] * means[i];\n        n += samples[i];\n    }\n    return sum / n;\n};\n\n/**\n * Computes the truncated mean of the given values using a given percentage\n * @param {Array} values\n * @param {number} percent - The percentage of values to keep (range: [0,1])\n * @param {boolean} [alreadySorted=false]\n * @returns {number}\n */\nexports.truncatedMean = function truncatedMean(values, percent, alreadySorted) {\n    if (alreadySorted === undefined) alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n    var l = values.length;\n    var k = Math.floor(l * percent);\n    var sum = 0;\n    for (var i = k; i < (l - k); i++) {\n        sum += values[i];\n    }\n    return sum / (l - 2 * k);\n};\n\n/**\n * Computes the harmonic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.harmonicMean = function harmonicMean(values) {\n    var sum = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        if (values[i] === 0) {\n            throw new RangeError('value at index ' + i + 'is zero');\n        }\n        sum += 1 / values[i];\n    }\n    return l / sum;\n};\n\n/**\n * Computes the contraharmonic mean of the given values\n * @param {Array} values\n * @returns {number}\n */\nexports.contraHarmonicMean = function contraHarmonicMean(values) {\n    var r1 = 0;\n    var r2 = 0;\n    var l = values.length;\n    for (var i = 0; i < l; i++) {\n        r1 += values[i] * values[i];\n        r2 += values[i];\n    }\n    if (r2 < 0) {\n        throw new RangeError('sum of values is negative');\n    }\n    return r1 / r2;\n};\n\n/**\n * Computes the median of the given values\n * @param {Array} values\n * @param {boolean} [alreadySorted=false]\n * @returns {number}\n */\nexports.median = function median(values, alreadySorted) {\n    if (alreadySorted === undefined) alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n    var l = values.length;\n    var half = Math.floor(l / 2);\n    if (l % 2 === 0) {\n        return (values[half - 1] + values[half]) * 0.5;\n    } else {\n        return values[half];\n    }\n};\n\n/**\n * Computes the variance of the given values\n * @param {Array} values\n * @param {boolean} [unbiased=true] - if true, divide by (n-1); if false, divide by n.\n * @returns {number}\n */\nexports.variance = function variance(values, unbiased) {\n    if (unbiased === undefined) unbiased = true;\n    var theMean = exports.mean(values);\n    var theVariance = 0;\n    var l = values.length;\n\n    for (var i = 0; i < l; i++) {\n        var x = values[i] - theMean;\n        theVariance += x * x;\n    }\n\n    if (unbiased) {\n        return theVariance / (l - 1);\n    } else {\n        return theVariance / l;\n    }\n};\n\n/**\n * Computes the standard deviation of the given values\n * @param {Array} values\n * @param {boolean} [unbiased=true] - if true, divide by (n-1); if false, divide by n.\n * @returns {number}\n */\nexports.standardDeviation = function standardDeviation(values, unbiased) {\n    return Math.sqrt(exports.variance(values, unbiased));\n};\n\nexports.standardError = function standardError(values) {\n    return exports.standardDeviation(values) / Math.sqrt(values.length);\n};\n\n/**\n * IEEE Transactions on biomedical engineering, vol. 52, no. 1, january 2005, p. 76-\n * Calculate the standard deviation via the Median of the absolute deviation\n *  The formula for the standard deviation only holds for Gaussian random variables.\n * @returns {{mean: number, stdev: number}}\n */\nexports.robustMeanAndStdev = function robustMeanAndStdev(y) {\n    var mean = 0, stdev = 0;\n    var length = y.length, i = 0;\n    for (i = 0; i < length; i++) {\n        mean += y[i];\n    }\n    mean /= length;\n    var averageDeviations = new Array(length);\n    for (i = 0; i < length; i++)\n        averageDeviations[i] = Math.abs(y[i] - mean);\n    averageDeviations.sort(compareNumbers);\n    if (length % 2 === 1) {\n        stdev = averageDeviations[(length - 1) / 2] / 0.6745;\n    } else {\n        stdev = 0.5 * (averageDeviations[length / 2] + averageDeviations[length / 2 - 1]) / 0.6745;\n    }\n\n    return {\n        mean: mean,\n        stdev: stdev\n    };\n};\n\nexports.quartiles = function quartiles(values, alreadySorted) {\n    if (typeof (alreadySorted) === 'undefined') alreadySorted = false;\n    if (!alreadySorted) {\n        values = [].concat(values).sort(compareNumbers);\n    }\n\n    var quart = values.length / 4;\n    var q1 = values[Math.ceil(quart) - 1];\n    var q2 = exports.median(values, true);\n    var q3 = values[Math.ceil(quart * 3) - 1];\n\n    return {q1: q1, q2: q2, q3: q3};\n};\n\nexports.pooledStandardDeviation = function pooledStandardDeviation(samples, unbiased) {\n    return Math.sqrt(exports.pooledVariance(samples, unbiased));\n};\n\nexports.pooledVariance = function pooledVariance(samples, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var sum = 0;\n    var length = 0, l = samples.length;\n    for (var i = 0; i < l; i++) {\n        var values = samples[i];\n        var vari = exports.variance(values);\n\n        sum += (values.length - 1) * vari;\n\n        if (unbiased)\n            length += values.length - 1;\n        else\n            length += values.length;\n    }\n    return sum / length;\n};\n\nexports.mode = function mode(values) {\n    var l = values.length,\n        itemCount = new Array(l),\n        i;\n    for (i = 0; i < l; i++) {\n        itemCount[i] = 0;\n    }\n    var itemArray = new Array(l);\n    var count = 0;\n\n    for (i = 0; i < l; i++) {\n        var index = itemArray.indexOf(values[i]);\n        if (index >= 0)\n            itemCount[index]++;\n        else {\n            itemArray[count] = values[i];\n            itemCount[count] = 1;\n            count++;\n        }\n    }\n\n    var maxValue = 0, maxIndex = 0;\n    for (i = 0; i < count; i++) {\n        if (itemCount[i] > maxValue) {\n            maxValue = itemCount[i];\n            maxIndex = i;\n        }\n    }\n\n    return itemArray[maxIndex];\n};\n\nexports.covariance = function covariance(vector1, vector2, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var mean1 = exports.mean(vector1);\n    var mean2 = exports.mean(vector2);\n\n    if (vector1.length !== vector2.length)\n        throw 'Vectors do not have the same dimensions';\n\n    var cov = 0, l = vector1.length;\n    for (var i = 0; i < l; i++) {\n        var x = vector1[i] - mean1;\n        var y = vector2[i] - mean2;\n        cov += x * y;\n    }\n\n    if (unbiased)\n        return cov / (l - 1);\n    else\n        return cov / l;\n};\n\nexports.skewness = function skewness(values, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var theMean = exports.mean(values);\n\n    var s2 = 0, s3 = 0, l = values.length;\n    for (var i = 0; i < l; i++) {\n        var dev = values[i] - theMean;\n        s2 += dev * dev;\n        s3 += dev * dev * dev;\n    }\n    var m2 = s2 / l;\n    var m3 = s3 / l;\n\n    var g = m3 / (Math.pow(m2, 3 / 2.0));\n    if (unbiased) {\n        var a = Math.sqrt(l * (l - 1));\n        var b = l - 2;\n        return (a / b) * g;\n    } else {\n        return g;\n    }\n};\n\nexports.kurtosis = function kurtosis(values, unbiased) {\n    if (typeof (unbiased) === 'undefined') unbiased = true;\n    var theMean = exports.mean(values);\n    var n = values.length, s2 = 0, s4 = 0;\n\n    for (var i = 0; i < n; i++) {\n        var dev = values[i] - theMean;\n        s2 += dev * dev;\n        s4 += dev * dev * dev * dev;\n    }\n    var m2 = s2 / n;\n    var m4 = s4 / n;\n\n    if (unbiased) {\n        var v = s2 / (n - 1);\n        var a = (n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3));\n        var b = s4 / (v * v);\n        var c = ((n - 1) * (n - 1)) / ((n - 2) * (n - 3));\n\n        return a * b - 3 * c;\n    } else {\n        return m4 / (m2 * m2) - 3;\n    }\n};\n\nexports.entropy = function entropy(values, eps) {\n    if (typeof (eps) === 'undefined') eps = 0;\n    var sum = 0, l = values.length;\n    for (var i = 0; i < l; i++)\n        sum += values[i] * Math.log(values[i] + eps);\n    return -sum;\n};\n\nexports.weightedMean = function weightedMean(values, weights) {\n    var sum = 0, l = values.length;\n    for (var i = 0; i < l; i++)\n        sum += values[i] * weights[i];\n    return sum;\n};\n\nexports.weightedStandardDeviation = function weightedStandardDeviation(values, weights) {\n    return Math.sqrt(exports.weightedVariance(values, weights));\n};\n\nexports.weightedVariance = function weightedVariance(values, weights) {\n    var theMean = exports.weightedMean(values, weights);\n    var vari = 0, l = values.length;\n    var a = 0, b = 0;\n\n    for (var i = 0; i < l; i++) {\n        var z = values[i] - theMean;\n        var w = weights[i];\n\n        vari += w * (z * z);\n        b += w;\n        a += w * w;\n    }\n\n    return vari * (b / (b * b - a));\n};\n\nexports.center = function center(values, inPlace) {\n    if (typeof (inPlace) === 'undefined') inPlace = false;\n\n    var result = values;\n    if (!inPlace)\n        result = [].concat(values);\n\n    var theMean = exports.mean(result), l = result.length;\n    for (var i = 0; i < l; i++)\n        result[i] -= theMean;\n};\n\nexports.standardize = function standardize(values, standardDev, inPlace) {\n    if (typeof (standardDev) === 'undefined') standardDev = exports.standardDeviation(values);\n    if (typeof (inPlace) === 'undefined') inPlace = false;\n    var l = values.length;\n    var result = inPlace ? values : new Array(l);\n    for (var i = 0; i < l; i++)\n        result[i] = values[i] / standardDev;\n    return result;\n};\n\nexports.cumulativeSum = function cumulativeSum(array) {\n    var l = array.length;\n    var result = new Array(l);\n    result[0] = array[0];\n    for (var i = 1; i < l; i++)\n        result[i] = result[i - 1] + array[i];\n    return result;\n};\n","'use strict';\n\nfunction getConverter() {\n  // the following RegExp can only be used for XYdata, some peakTables have values with a \"E-5\" ...\n  const ntuplesSeparator = /[, \\t]+/;\n  const GC_MS_FIELDS = ['TIC', '.RIC', 'SCANNUMBER'];\n\n  function convertToFloatArray(stringArray) {\n    var floatArray = [];\n    for (let i = 0; i < stringArray.length; i++) {\n      floatArray.push(parseFloat(stringArray[i]));\n    }\n    return floatArray;\n  }\n\n  class Spectrum {}\n\n  const defaultOptions = {\n    keepRecordsRegExp: /^$/,\n    xy: false,\n    withoutXY: false,\n    chromatogram: false,\n    keepSpectra: false,\n    noContour: false,\n    nbContourLevels: 7,\n    noiseMultiplier: 5,\n    profiling: false\n  };\n\n  function convert(jcamp, options) {\n    options = Object.assign({}, defaultOptions, options);\n\n    var wantXY = !options.withoutXY;\n\n    var start = Date.now();\n\n    var ntuples = {};\n    var ldr, dataLabel, dataValue, ldrs;\n    var position, endLine, infos;\n\n    var result = {};\n    result.profiling = options.profiling ? [] : false;\n    result.logs = [];\n    var spectra = [];\n    result.spectra = spectra;\n    result.info = {};\n    var spectrum = new Spectrum();\n\n    if (!(typeof jcamp === 'string')) {\n      throw new TypeError('the JCAMP should be a string');\n    }\n\n    if (result.profiling) {\n      result.profiling.push({\n        action: 'Before split to LDRS',\n        time: Date.now() - start\n      });\n    }\n\n    ldrs = jcamp.split(/[\\r\\n]+##/);\n\n    if (result.profiling) {\n      result.profiling.push({\n        action: 'Split to LDRS',\n        time: Date.now() - start\n      });\n    }\n\n    if (ldrs[0]) ldrs[0] = ldrs[0].replace(/^[\\r\\n ]*##/, '');\n\n    for (let i = 0; i < ldrs.length; i++) {\n      ldr = ldrs[i];\n      // This is a new LDR\n      position = ldr.indexOf('=');\n      if (position > 0) {\n        dataLabel = ldr.substring(0, position);\n        dataValue = ldr.substring(position + 1).trim();\n      } else {\n        dataLabel = ldr;\n        dataValue = '';\n      }\n      dataLabel = dataLabel.replace(/[_ -]/g, '').toUpperCase();\n\n      if (dataLabel === 'DATATABLE') {\n        endLine = dataValue.indexOf('\\n');\n        if (endLine === -1) endLine = dataValue.indexOf('\\r');\n        if (endLine > 0) {\n          var xIndex = -1;\n          var yIndex = -1;\n          // ##DATA TABLE= (X++(I..I)), XYDATA\n          // We need to find the variables\n\n          infos = dataValue.substring(0, endLine).split(/[ ,;\\t]+/);\n          if (infos[0].indexOf('++') > 0) {\n            var firstVariable = infos[0].replace(\n              /.*\\(([a-zA-Z0-9]+)\\+\\+.*/,\n              '$1'\n            );\n            var secondVariable = infos[0].replace(\n              /.*\\.\\.([a-zA-Z0-9]+).*/,\n              '$1'\n            );\n            xIndex = ntuples.symbol.indexOf(firstVariable);\n            yIndex = ntuples.symbol.indexOf(secondVariable);\n          }\n\n          if (xIndex === -1) xIndex = 0;\n          if (yIndex === -1) yIndex = 0;\n\n          if (ntuples.first) {\n            if (ntuples.first.length > xIndex) {\n              spectrum.firstX = ntuples.first[xIndex];\n            }\n            if (ntuples.first.length > yIndex) {\n              spectrum.firstY = ntuples.first[yIndex];\n            }\n          }\n          if (ntuples.last) {\n            if (ntuples.last.length > xIndex) {\n              spectrum.lastX = ntuples.last[xIndex];\n            }\n            if (ntuples.last.length > yIndex) {\n              spectrum.lastY = ntuples.last[yIndex];\n            }\n          }\n          if (ntuples.vardim && ntuples.vardim.length > xIndex) {\n            spectrum.nbPoints = ntuples.vardim[xIndex];\n          }\n          if (ntuples.factor) {\n            if (ntuples.factor.length > xIndex) {\n              spectrum.xFactor = ntuples.factor[xIndex];\n            }\n            if (ntuples.factor.length > yIndex) {\n              spectrum.yFactor = ntuples.factor[yIndex];\n            }\n          }\n          if (ntuples.units) {\n            if (ntuples.units.length > xIndex) {\n              spectrum.xUnit = ntuples.units[xIndex];\n            }\n            if (ntuples.units.length > yIndex) {\n              spectrum.yUnit = ntuples.units[yIndex];\n            }\n          }\n          spectrum.datatable = infos[0];\n          if (infos[1] && infos[1].indexOf('PEAKS') > -1) {\n            dataLabel = 'PEAKTABLE';\n          } else if (\n            infos[1] &&\n            (infos[1].indexOf('XYDATA') || infos[0].indexOf('++') > 0)\n          ) {\n            dataLabel = 'XYDATA';\n            spectrum.deltaX =\n              (spectrum.lastX - spectrum.firstX) / (spectrum.nbPoints - 1);\n          }\n        }\n      }\n\n      if (dataLabel === 'XYDATA') {\n        if (wantXY) {\n          prepareSpectrum(result, spectrum);\n          // well apparently we should still consider it is a PEAK TABLE if there are no '++' after\n          if (dataValue.match(/.*\\+\\+.*/)) {\n            // ex: (X++(Y..Y))\n            if (!spectrum.deltaX) {\n              spectrum.deltaX =\n                (spectrum.lastX - spectrum.firstX) / (spectrum.nbPoints - 1);\n            }\n            fastParseXYData(spectrum, dataValue, result);\n          } else {\n            parsePeakTable(spectrum, dataValue, result);\n          }\n          spectra.push(spectrum);\n          spectrum = new Spectrum();\n        }\n        continue;\n      } else if (dataLabel === 'PEAKTABLE') {\n        if (wantXY) {\n          prepareSpectrum(result, spectrum);\n          parsePeakTable(spectrum, dataValue, result);\n          spectra.push(spectrum);\n          spectrum = new Spectrum();\n        }\n        continue;\n      }\n      if (dataLabel === 'PEAKASSIGNMENTS') {\n        if (wantXY) {\n          if (dataValue.match(/.*(XYA).*/)) {\n            // ex: (XYA)\n            parseXYA(spectrum, dataValue);\n          }\n          spectra.push(spectrum);\n          spectrum = new Spectrum();\n        }\n        continue;\n      }\n\n      if (dataLabel === 'TITLE') {\n        spectrum.title = dataValue;\n      } else if (dataLabel === 'DATATYPE') {\n        spectrum.dataType = dataValue;\n        if (dataValue.indexOf('nD') > -1) {\n          result.twoD = true;\n        }\n      } else if (dataLabel === 'NTUPLES') {\n        if (dataValue.indexOf('nD') > -1) {\n          result.twoD = true;\n        }\n      } else if (dataLabel === 'XUNITS') {\n        spectrum.xUnit = dataValue;\n      } else if (dataLabel === 'YUNITS') {\n        spectrum.yUnit = dataValue;\n      } else if (dataLabel === 'FIRSTX') {\n        spectrum.firstX = parseFloat(dataValue);\n      } else if (dataLabel === 'LASTX') {\n        spectrum.lastX = parseFloat(dataValue);\n      } else if (dataLabel === 'FIRSTY') {\n        spectrum.firstY = parseFloat(dataValue);\n      } else if (dataLabel === 'LASTY') {\n        spectrum.lastY = parseFloat(dataValue);\n      } else if (dataLabel === 'NPOINTS') {\n        spectrum.nbPoints = parseFloat(dataValue);\n      } else if (dataLabel === 'XFACTOR') {\n        spectrum.xFactor = parseFloat(dataValue);\n      } else if (dataLabel === 'YFACTOR') {\n        spectrum.yFactor = parseFloat(dataValue);\n      } else if (dataLabel === 'MAXX') {\n        spectrum.maxX = parseFloat(dataValue);\n      } else if (dataLabel === 'MINX') {\n        spectrum.minX = parseFloat(dataValue);\n      } else if (dataLabel === 'MAXY') {\n        spectrum.maxY = parseFloat(dataValue);\n      } else if (dataLabel === 'MINY') {\n        spectrum.minY = parseFloat(dataValue);\n      } else if (dataLabel === 'DELTAX') {\n        spectrum.deltaX = parseFloat(dataValue);\n      } else if (dataLabel === '.OBSERVEFREQUENCY' || dataLabel === '$SFO1') {\n        if (!spectrum.observeFrequency) {\n          spectrum.observeFrequency = parseFloat(dataValue);\n        }\n      } else if (dataLabel === '.OBSERVENUCLEUS') {\n        if (!spectrum.xType) {\n          result.xType = dataValue.replace(/[^a-zA-Z0-9]/g, '');\n        }\n      } else if (dataLabel === '$SFO2') {\n        if (!result.indirectFrequency) {\n          result.indirectFrequency = parseFloat(dataValue);\n        }\n      } else if (dataLabel === '$OFFSET') {\n        // OFFSET for Bruker spectra\n        result.shiftOffsetNum = 0;\n        if (!spectrum.shiftOffsetVal) {\n          spectrum.shiftOffsetVal = parseFloat(dataValue);\n        }\n      } else if (dataLabel === '$REFERENCEPOINT') {\n        // OFFSET for Varian spectra\n        // if we activate this part it does not work for ACD specmanager\n        //         } else if (dataLabel=='.SHIFTREFERENCE') {   // OFFSET FOR Bruker Spectra\n        //                 var parts = dataValue.split(/ *, */);\n        //                 result.shiftOffsetNum = parseInt(parts[2].trim());\n        //                 spectrum.shiftOffsetVal = parseFloat(parts[3].trim());\n      } else if (dataLabel === 'VARNAME') {\n        ntuples.varname = dataValue.split(ntuplesSeparator);\n      } else if (dataLabel === 'SYMBOL') {\n        ntuples.symbol = dataValue.split(ntuplesSeparator);\n      } else if (dataLabel === 'VARTYPE') {\n        ntuples.vartype = dataValue.split(ntuplesSeparator);\n      } else if (dataLabel === 'VARFORM') {\n        ntuples.varform = dataValue.split(ntuplesSeparator);\n      } else if (dataLabel === 'VARDIM') {\n        ntuples.vardim = convertToFloatArray(dataValue.split(ntuplesSeparator));\n      } else if (dataLabel === 'UNITS') {\n        ntuples.units = dataValue.split(ntuplesSeparator);\n      } else if (dataLabel === 'FACTOR') {\n        ntuples.factor = convertToFloatArray(dataValue.split(ntuplesSeparator));\n      } else if (dataLabel === 'FIRST') {\n        ntuples.first = convertToFloatArray(dataValue.split(ntuplesSeparator));\n      } else if (dataLabel === 'LAST') {\n        ntuples.last = convertToFloatArray(dataValue.split(ntuplesSeparator));\n      } else if (dataLabel === 'MIN') {\n        ntuples.min = convertToFloatArray(dataValue.split(ntuplesSeparator));\n      } else if (dataLabel === 'MAX') {\n        ntuples.max = convertToFloatArray(dataValue.split(ntuplesSeparator));\n      } else if (dataLabel === '.NUCLEUS') {\n        if (result.twoD) {\n          result.yType = dataValue.split(ntuplesSeparator)[0];\n        }\n      } else if (dataLabel === 'PAGE') {\n        spectrum.page = dataValue.trim();\n        spectrum.pageValue = parseFloat(dataValue.replace(/^.*=/, ''));\n        spectrum.pageSymbol = spectrum.page.replace(/[=].*/, '');\n        var pageSymbolIndex = ntuples.symbol.indexOf(spectrum.pageSymbol);\n        var unit = '';\n        if (ntuples.units && ntuples.units[pageSymbolIndex]) {\n          unit = ntuples.units[pageSymbolIndex];\n        }\n        if (result.indirectFrequency && unit !== 'PPM') {\n          spectrum.pageValue /= result.indirectFrequency;\n        }\n      } else if (dataLabel === 'RETENTIONTIME') {\n        spectrum.pageValue = parseFloat(dataValue);\n      } else if (isMSField(dataLabel)) {\n        spectrum[convertMSFieldToLabel(dataLabel)] = dataValue;\n      } else if (dataLabel === 'SAMPLEDESCRIPTION') {\n        spectrum.sampleDescription = dataValue;\n      }\n      if (dataLabel.match(options.keepRecordsRegExp)) {\n        if (result.info[dataLabel]) {\n          if (!Array.isArray(result.info[dataLabel])) {\n            result.info[dataLabel] = [result.info[dataLabel]];\n          }\n          result.info[dataLabel].push(dataValue.trim());\n        } else {\n          result.info[dataLabel] = dataValue.trim();\n        }\n      }\n    }\n\n    if (result.profiling) {\n      result.profiling.push({\n        action: 'Finished parsing',\n        time: Date.now() - start\n      });\n    }\n\n    if (Object.keys(ntuples).length > 0) {\n      var newNtuples = [];\n      var keys = Object.keys(ntuples);\n      for (let i = 0; i < keys.length; i++) {\n        var key = keys[i];\n        var values = ntuples[key];\n        for (let j = 0; j < values.length; j++) {\n          if (!newNtuples[j]) newNtuples[j] = {};\n          newNtuples[j][key] = values[j];\n        }\n      }\n      result.ntuples = newNtuples;\n    }\n\n    if (result.twoD && wantXY) {\n      add2D(result, options);\n      if (result.profiling) {\n        result.profiling.push({\n          action: 'Finished countour plot calculation',\n          time: Date.now() - start\n        });\n      }\n      if (!options.keepSpectra) {\n        delete result.spectra;\n      }\n    }\n\n    if (options.chromatogram) {\n      options.xy = true;\n    }\n\n    if (options.xy && wantXY) {\n      // the spectraData should not be a oneD array but an object with x and y\n      if (spectra.length > 0) {\n        for (let i = 0; i < spectra.length; i++) {\n          spectrum = spectra[i];\n          if (spectrum.data.length > 0) {\n            for (let j = 0; j < spectrum.data.length; j++) {\n              var data = spectrum.data[j];\n              var newData = {\n                x: new Array(data.length / 2),\n                y: new Array(data.length / 2)\n              };\n              for (var k = 0; k < data.length; k = k + 2) {\n                newData.x[k / 2] = data[k];\n                newData.y[k / 2] = data[k + 1];\n              }\n              spectrum.data[j] = newData;\n            }\n          }\n        }\n      }\n    }\n\n    // maybe it is a GC (HPLC) / MS. In this case we add a new format\n    if (options.chromatogram) {\n      if (result.spectra.length > 1) {\n        complexChromatogram(result);\n      } else {\n        simpleChromatogram(result);\n      }\n      if (result.profiling) {\n        result.profiling.push({\n          action: 'Finished chromatogram calculation',\n          time: Date.now() - start\n        });\n      }\n    }\n\n    if (result.profiling) {\n      result.profiling.push({\n        action: 'Total time',\n        time: Date.now() - start\n      });\n    }\n\n    return result;\n  }\n\n  function convertMSFieldToLabel(value) {\n    return value.toLowerCase().replace(/[^a-z0-9]/g, '');\n  }\n\n  function isMSField(dataLabel) {\n    return GC_MS_FIELDS.indexOf(dataLabel) !== -1;\n  }\n\n  function complexChromatogram(result) {\n    var spectra = result.spectra;\n    var length = spectra.length;\n    var chromatogram = {\n      times: new Array(length),\n      series: {\n        ms: {\n          dimension: 2,\n          data: new Array(length)\n        }\n      }\n    };\n\n    var existingGCMSFields = [];\n    for (let i = 0; i < GC_MS_FIELDS.length; i++) {\n      var label = convertMSFieldToLabel(GC_MS_FIELDS[i]);\n      if (spectra[0][label]) {\n        existingGCMSFields.push(label);\n        chromatogram.series[label] = {\n          dimension: 1,\n          data: new Array(length)\n        };\n      }\n    }\n\n    for (let i = 0; i < length; i++) {\n      var spectrum = spectra[i];\n      chromatogram.times[i] = spectrum.pageValue;\n      for (let j = 0; j < existingGCMSFields.length; j++) {\n        chromatogram.series[existingGCMSFields[j]].data[i] = parseFloat(\n          spectrum[existingGCMSFields[j]]\n        );\n      }\n      if (spectrum.data) {\n        chromatogram.series.ms.data[i] = [\n          spectrum.data[0].x,\n          spectrum.data[0].y\n        ];\n      }\n    }\n    result.chromatogram = chromatogram;\n  }\n\n  function simpleChromatogram(result) {\n    var data = result.spectra[0].data[0];\n    result.chromatogram = {\n      times: data.x.slice(),\n      series: {\n        intensity: {\n          dimension: 1,\n          data: data.y.slice()\n        }\n      }\n    };\n  }\n\n  function prepareSpectrum(result, spectrum) {\n    if (!spectrum.xFactor) spectrum.xFactor = 1;\n    if (!spectrum.yFactor) spectrum.yFactor = 1;\n    if (spectrum.observeFrequency) {\n      if (spectrum.xUnit && spectrum.xUnit.toUpperCase() === 'HZ') {\n        spectrum.xUnit = 'PPM';\n        spectrum.xFactor = spectrum.xFactor / spectrum.observeFrequency;\n        spectrum.firstX = spectrum.firstX / spectrum.observeFrequency;\n        spectrum.lastX = spectrum.lastX / spectrum.observeFrequency;\n        spectrum.deltaX = spectrum.deltaX / spectrum.observeFrequency;\n      }\n    }\n    if (spectrum.shiftOffsetVal) {\n      var shift = spectrum.firstX - spectrum.shiftOffsetVal;\n      spectrum.firstX = spectrum.firstX - shift;\n      spectrum.lastX = spectrum.lastX - shift;\n    }\n  }\n\n  function getMedian(data) {\n    data = data.sort(compareNumbers);\n    var l = data.length;\n    return data[Math.floor(l / 2)];\n  }\n\n  function compareNumbers(a, b) {\n    return a - b;\n  }\n\n  function convertTo3DZ(spectra) {\n    var minZ = spectra[0].data[0][0];\n    var maxZ = minZ;\n    var ySize = spectra.length;\n    var xSize = spectra[0].data[0].length / 2;\n    var z = new Array(ySize);\n    for (let i = 0; i < ySize; i++) {\n      z[i] = new Array(xSize);\n      var xVector = spectra[i].data[0];\n      for (let j = 0; j < xSize; j++) {\n        var value = xVector[j * 2 + 1];\n        z[i][j] = value;\n        if (value < minZ) minZ = value;\n        if (value > maxZ) maxZ = value;\n      }\n    }\n\n    const firstX = spectra[0].data[0][0];\n    const lastX = spectra[0].data[0][spectra[0].data[0].length - 2]; // has to be -2 because it is a 1D array [x,y,x,y,...]\n    const firstY = spectra[0].pageValue;\n    const lastY = spectra[ySize - 1].pageValue;\n\n    // Because the min / max value are the only information about the matrix if we invert\n    // min and max we need to invert the array\n    if (firstX > lastX) {\n      for (let spectrum of z) {\n        spectrum.reverse();\n      }\n    }\n    if (firstY > lastY) {\n      z.reverse();\n    }\n\n    return {\n      z: z,\n      minX: Math.min(firstX, lastX),\n      maxX: Math.max(firstX, lastX),\n      minY: Math.min(firstY, lastY),\n      maxY: Math.max(firstY, lastY),\n      minZ: minZ,\n      maxZ: maxZ,\n      noise: getMedian(z[0].map(Math.abs))\n    };\n  }\n\n  function add2D(result, options) {\n    var zData = convertTo3DZ(result.spectra);\n    if (!options.noContour) {\n      result.contourLines = generateContourLines(zData, options);\n      delete zData.z;\n    }\n    result.minMax = zData;\n  }\n\n  function generateContourLines(zData, options) {\n    var noise = zData.noise;\n    var z = zData.z;\n    var povarHeight0, povarHeight1, povarHeight2, povarHeight3;\n    var isOver0, isOver1, isOver2, isOver3;\n    var nbSubSpectra = z.length;\n    var nbPovars = z[0].length;\n    var pAx, pAy, pBx, pBy;\n\n    var x0 = zData.minX;\n    var xN = zData.maxX;\n    var dx = (xN - x0) / (nbPovars - 1);\n    var y0 = zData.minY;\n    var yN = zData.maxY;\n    var dy = (yN - y0) / (nbSubSpectra - 1);\n    var minZ = zData.minZ;\n    var maxZ = zData.maxZ;\n\n    // System.out.prvarln('y0 '+y0+' yN '+yN);\n    // -------------------------\n    // Povars attribution\n    //\n    // 0----1\n    // |  / |\n    // | /  |\n    // 2----3\n    //\n    // ---------------------d------\n\n    var iter = options.nbContourLevels * 2;\n    var contourLevels = new Array(iter);\n    var lineZValue;\n    for (var level = 0; level < iter; level++) {\n      // multiply by 2 for positif and negatif\n      var contourLevel = {};\n      contourLevels[level] = contourLevel;\n      var side = level % 2;\n      var factor =\n        (maxZ - options.noiseMultiplier * noise) *\n        Math.exp((level >> 1) - options.nbContourLevels);\n      if (side === 0) {\n        lineZValue = factor + options.noiseMultiplier * noise;\n      } else {\n        lineZValue = 0 - factor - options.noiseMultiplier * noise;\n      }\n      var lines = [];\n      contourLevel.zValue = lineZValue;\n      contourLevel.lines = lines;\n\n      if (lineZValue <= minZ || lineZValue >= maxZ) continue;\n\n      for (var iSubSpectra = 0; iSubSpectra < nbSubSpectra - 1; iSubSpectra++) {\n        var subSpectra = z[iSubSpectra];\n        var subSpectraAfter = z[iSubSpectra + 1];\n        for (var povar = 0; povar < nbPovars - 1; povar++) {\n          povarHeight0 = subSpectra[povar];\n          povarHeight1 = subSpectra[povar + 1];\n          povarHeight2 = subSpectraAfter[povar];\n          povarHeight3 = subSpectraAfter[povar + 1];\n\n          isOver0 = povarHeight0 > lineZValue;\n          isOver1 = povarHeight1 > lineZValue;\n          isOver2 = povarHeight2 > lineZValue;\n          isOver3 = povarHeight3 > lineZValue;\n\n          // Example povar0 is over the plane and povar1 and\n          // povar2 are below, we find the varersections and add\n          // the segment\n          if (isOver0 !== isOver1 && isOver0 !== isOver2) {\n            pAx =\n              povar +\n              (lineZValue - povarHeight0) / (povarHeight1 - povarHeight0);\n            pAy = iSubSpectra;\n            pBx = povar;\n            pBy =\n              iSubSpectra +\n              (lineZValue - povarHeight0) / (povarHeight2 - povarHeight0);\n            lines.push(pAx * dx + x0);\n            lines.push(pAy * dy + y0);\n            lines.push(pBx * dx + x0);\n            lines.push(pBy * dy + y0);\n          }\n          // remove push does not help !!!!\n          if (isOver3 !== isOver1 && isOver3 !== isOver2) {\n            pAx = povar + 1;\n            pAy =\n              iSubSpectra +\n              1 -\n              (lineZValue - povarHeight3) / (povarHeight1 - povarHeight3);\n            pBx =\n              povar +\n              1 -\n              (lineZValue - povarHeight3) / (povarHeight2 - povarHeight3);\n            pBy = iSubSpectra + 1;\n            lines.push(pAx * dx + x0);\n            lines.push(pAy * dy + y0);\n            lines.push(pBx * dx + x0);\n            lines.push(pBy * dy + y0);\n          }\n          // test around the diagonal\n          if (isOver1 !== isOver2) {\n            pAx =\n              (povar +\n                1 -\n                (lineZValue - povarHeight1) / (povarHeight2 - povarHeight1)) *\n                dx +\n              x0;\n            pAy =\n              (iSubSpectra +\n                (lineZValue - povarHeight1) / (povarHeight2 - povarHeight1)) *\n                dy +\n              y0;\n            if (isOver1 !== isOver0) {\n              pBx =\n                povar +\n                1 -\n                (lineZValue - povarHeight1) / (povarHeight0 - povarHeight1);\n              pBy = iSubSpectra;\n              lines.push(pAx);\n              lines.push(pAy);\n              lines.push(pBx * dx + x0);\n              lines.push(pBy * dy + y0);\n            }\n            if (isOver2 !== isOver0) {\n              pBx = povar;\n              pBy =\n                iSubSpectra +\n                1 -\n                (lineZValue - povarHeight2) / (povarHeight0 - povarHeight2);\n              lines.push(pAx);\n              lines.push(pAy);\n              lines.push(pBx * dx + x0);\n              lines.push(pBy * dy + y0);\n            }\n            if (isOver1 !== isOver3) {\n              pBx = povar + 1;\n              pBy =\n                iSubSpectra +\n                (lineZValue - povarHeight1) / (povarHeight3 - povarHeight1);\n              lines.push(pAx);\n              lines.push(pAy);\n              lines.push(pBx * dx + x0);\n              lines.push(pBy * dy + y0);\n            }\n            if (isOver2 !== isOver3) {\n              pBx =\n                povar +\n                (lineZValue - povarHeight2) / (povarHeight3 - povarHeight2);\n              pBy = iSubSpectra + 1;\n              lines.push(pAx);\n              lines.push(pAy);\n              lines.push(pBx * dx + x0);\n              lines.push(pBy * dy + y0);\n            }\n          }\n        }\n      }\n    }\n\n    return {\n      minX: zData.minX,\n      maxX: zData.maxX,\n      minY: zData.minY,\n      maxY: zData.maxY,\n      segments: contourLevels\n    };\n  }\n\n  function fastParseXYData(spectrum, value) {\n    // TODO need to deal with result\n    //  console.log(value);\n    // we check if deltaX is defined otherwise we calculate it\n\n    var yFactor = spectrum.yFactor;\n    var deltaX = spectrum.deltaX;\n\n    spectrum.isXYdata = true;\n    // TODO to be improved using 2 array {x:[], y:[]}\n    var currentData = [];\n    spectrum.data = [currentData];\n\n    var currentX = spectrum.firstX;\n    var currentY = spectrum.firstY;\n\n    // we skip the first line\n    //\n    var endLine = false;\n    var ascii;\n    let i = 0;\n    for (; i < value.length; i++) {\n      ascii = value.charCodeAt(i);\n      if (ascii === 13 || ascii === 10) {\n        endLine = true;\n      } else {\n        if (endLine) break;\n      }\n    }\n\n    // we proceed taking the i after the first line\n    var newLine = true;\n    var isDifference = false;\n    var isLastDifference = false;\n    var lastDifference = 0;\n    var isDuplicate = false;\n    var inComment = false;\n    var currentValue = 0; // can be a difference or a duplicate\n    var lastValue = 0; // must be the real last value\n    var isNegative = false;\n    var inValue = false;\n    var skipFirstValue = false;\n    var decimalPosition = 0;\n    for (; i <= value.length; i++) {\n      if (i === value.length) ascii = 13;\n      else ascii = value.charCodeAt(i);\n      if (inComment) {\n        // we should ignore the text if we are after $$\n        if (ascii === 13 || ascii === 10) {\n          newLine = true;\n          inComment = false;\n        }\n      } else {\n        // when is it a new value ?\n        // when it is not a digit, . or comma\n        // it is a number that is either new or we continue\n        if (ascii <= 57 && ascii >= 48) {\n          // a number\n          inValue = true;\n          if (decimalPosition > 0) {\n            currentValue += (ascii - 48) / Math.pow(10, decimalPosition++);\n          } else {\n            currentValue *= 10;\n            currentValue += ascii - 48;\n          }\n        } else if (ascii === 44 || ascii === 46) {\n          // a \",\" or \".\"\n          inValue = true;\n          decimalPosition++;\n        } else {\n          if (inValue) {\n            // need to process the previous value\n            if (newLine) {\n              newLine = false; // we don't check the X value\n              // console.log(\"NEW LINE\",isDifference, lastDifference);\n              // if new line and lastDifference, the first value is just a check !\n              // that we don't check ...\n              if (isLastDifference) skipFirstValue = true;\n            } else {\n              // need to deal with duplicate and differences\n              if (skipFirstValue) {\n                skipFirstValue = false;\n              } else {\n                if (isDifference) {\n                  lastDifference = isNegative ? 0 - currentValue : currentValue;\n                  isLastDifference = true;\n                  isDifference = false;\n                } else if (!isDuplicate) {\n                  lastValue = isNegative ? 0 - currentValue : currentValue;\n                }\n                var duplicate = isDuplicate ? currentValue - 1 : 1;\n                for (var j = 0; j < duplicate; j++) {\n                  if (isLastDifference) {\n                    currentY += lastDifference;\n                  } else {\n                    currentY = lastValue;\n                  }\n                  currentData.push(currentX);\n                  currentData.push(currentY * yFactor);\n                  currentX += deltaX;\n                }\n              }\n            }\n            isNegative = false;\n            currentValue = 0;\n            decimalPosition = 0;\n            inValue = false;\n            isDuplicate = false;\n          }\n\n          // positive SQZ digits @ A B C D E F G H I (ascii 64-73)\n          if (ascii < 74 && ascii > 63) {\n            inValue = true;\n            isLastDifference = false;\n            currentValue = ascii - 64;\n          } else if (ascii > 96 && ascii < 106) {\n            // negative SQZ digits a b c d e f g h i (ascii 97-105)\n            inValue = true;\n            isLastDifference = false;\n            currentValue = ascii - 96;\n            isNegative = true;\n          } else if (ascii === 115) {\n            // DUP digits S T U V W X Y Z s (ascii 83-90, 115)\n            inValue = true;\n            isDuplicate = true;\n            currentValue = 9;\n          } else if (ascii > 82 && ascii < 91) {\n            inValue = true;\n            isDuplicate = true;\n            currentValue = ascii - 82;\n          } else if (ascii > 73 && ascii < 83) {\n            // positive DIF digits % J K L M N O P Q R (ascii 37, 74-82)\n            inValue = true;\n            isDifference = true;\n            currentValue = ascii - 73;\n          } else if (ascii > 105 && ascii < 115) {\n            // negative DIF digits j k l m n o p q r (ascii 106-114)\n            inValue = true;\n            isDifference = true;\n            currentValue = ascii - 105;\n            isNegative = true;\n          } else if (ascii === 36 && value.charCodeAt(i + 1) === 36) {\n            // $ sign, we need to check the next one\n            inValue = true;\n            inComment = true;\n          } else if (ascii === 37) {\n            // positive DIF digits % J K L M N O P Q R (ascii 37, 74-82)\n            inValue = true;\n            isDifference = true;\n            currentValue = 0;\n            isNegative = false;\n          } else if (ascii === 45) {\n            // a \"-\"\n            // check if after there is a number, decimal or comma\n            var ascii2 = value.charCodeAt(i + 1);\n            if (\n              (ascii2 >= 48 && ascii2 <= 57) ||\n              ascii2 === 44 ||\n              ascii2 === 46\n            ) {\n              inValue = true;\n              if (!newLine) isLastDifference = false;\n              isNegative = true;\n            }\n          } else if (ascii === 13 || ascii === 10) {\n            newLine = true;\n            inComment = false;\n          }\n          // and now analyse the details ... space or tabulation\n          // if \"+\" we just don't care\n        }\n      }\n    }\n  }\n\n  function parseXYA(spectrum, value) {\n    var removeSymbolRegExp = /(\\(+|\\)+|<+|>+|\\s+)/g;\n\n    spectrum.isXYAdata = true;\n    var values;\n    var currentData = [];\n    spectrum.data = [currentData];\n\n    var lines = value.split(/,? *,?[;\\r\\n]+ */);\n\n    for (let i = 1; i < lines.length; i++) {\n      values = lines[i]\n        .trim()\n        .replace(removeSymbolRegExp, '')\n        .split(',');\n      currentData.push(parseFloat(values[0]));\n      currentData.push(parseFloat(values[1]));\n    }\n  }\n\n  function parsePeakTable(spectrum, value, result) {\n    var removeCommentRegExp = /\\$\\$.*/;\n    var peakTableSplitRegExp = /[,\\t ]+/;\n\n    spectrum.isPeaktable = true;\n    var values;\n    var currentData = [];\n    spectrum.data = [currentData];\n\n    // counts for around 20% of the time\n    var lines = value.split(/,? *,?[;\\r\\n]+ */);\n\n    for (let i = 1; i < lines.length; i++) {\n      values = lines[i]\n        .trim()\n        .replace(removeCommentRegExp, '')\n        .split(peakTableSplitRegExp);\n      if (values.length % 2 === 0) {\n        for (let j = 0; j < values.length; j = j + 2) {\n          // takes around 40% of the time to add and parse the 2 values nearly exclusively because of parseFloat\n          currentData.push(parseFloat(values[j]) * spectrum.xFactor);\n          currentData.push(parseFloat(values[j + 1]) * spectrum.yFactor);\n        }\n      } else {\n        result.logs.push(`Format error: ${values}`);\n      }\n    }\n  }\n\n  return convert;\n}\n\nvar convert = getConverter();\n\nfunction JcampConverter(input, options, useWorker) {\n  if (typeof options === 'boolean') {\n    useWorker = options;\n    options = {};\n  }\n  if (useWorker) {\n    return postToWorker(input, options);\n  } else {\n    return convert(input, options);\n  }\n}\n\nvar stamps = {};\nvar worker;\n\nfunction postToWorker(input, options) {\n  if (!worker) {\n    createWorker();\n  }\n  return new Promise(function (resolve) {\n    var stamp = `${Date.now()}${Math.random()}`;\n    stamps[stamp] = resolve;\n    worker.postMessage(\n      JSON.stringify({\n        stamp: stamp,\n        input: input,\n        options: options\n      })\n    );\n  });\n}\n\nfunction createWorker() {\n  var workerURL = URL.createObjectURL(\n    new Blob(\n      [`var getConverter =${getConverter.toString()};var convert = getConverter(); onmessage = function (event) { var data = JSON.parse(event.data); postMessage(JSON.stringify({stamp: data.stamp, output: convert(data.input, data.options)})); };`],\n      { type: 'application/javascript' }\n    )\n  );\n  worker = new Worker(workerURL);\n  URL.revokeObjectURL(workerURL);\n  worker.addEventListener('message', function (event) {\n    var data = JSON.parse(event.data);\n    var stamp = data.stamp;\n    if (stamps[stamp]) {\n      stamps[stamp](data.output);\n    }\n  });\n}\n\nfunction createTree(jcamp, options = {}) {\n  const { flatten = false } = options;\n  if (typeof jcamp !== 'string') {\n    throw new TypeError('the JCAMP should be a string');\n  }\n\n  let lines = jcamp.split(/[\\r\\n]+/);\n  let flat = [];\n  let stack = [];\n  let result = [];\n  let current;\n  let ntupleLevel = 0;\n\n  let spaces = jcamp.includes('## ');\n\n  for (var i = 0; i < lines.length; i++) {\n    let line = lines[i];\n    let labelLine = spaces ? line.replace(/ /g, '') : line;\n\n    if (labelLine.substring(0, 9) === '##NTUPLES') {\n      ntupleLevel++;\n    }\n\n    if (labelLine.substring(0, 7) === '##TITLE') {\n      let title = [labelLine.substring(8).trim()];\n      for (let j = i + 1; j < lines.length; j++) {\n        if (lines[j].startsWith('##')) {\n          break;\n        } else {\n          title.push(lines[j].trim());\n        }\n      }\n      stack.push({\n        title: title.join('\\n'),\n        jcamp: `${line}\\n`,\n        children: []\n      });\n      current = stack[stack.length - 1];\n      flat.push(current);\n    } else if (labelLine.substring(0, 5) === '##END' && ntupleLevel === 0) {\n      current.jcamp += `${line}\\n`;\n      var finished = stack.pop();\n      if (stack.length !== 0) {\n        current = stack[stack.length - 1];\n        current.children.push(finished);\n      } else {\n        current = undefined;\n        result.push(finished);\n      }\n    } else if (current && current.jcamp) {\n      current.jcamp += `${line}\\n`;\n      var match = labelLine.match(/^##(.*?)=(.+)/);\n      if (match) {\n        var dataLabel = match[1].replace(/[ _-]/g, '').toUpperCase();\n        if (dataLabel === 'DATATYPE') {\n          current.dataType = match[2].trim();\n        }\n      }\n    }\n\n    if (labelLine.substring(0, 5) === '##END' && ntupleLevel > 0) {\n      ntupleLevel--;\n    }\n  }\n  if (flatten) {\n    flat.forEach((entry) => {\n      entry.children = undefined;\n    });\n    return flat;\n  } else {\n    return result;\n  }\n}\n\nmodule.exports = {\n  convert: JcampConverter,\n  createTree: createTree\n};\n","const isAnyArray = require('is-any-array');\n\n/**\n * Throw an error in no an object of x,y arrays\n * @param {object} [points={}]\n */\nexport function check(points = {}) {\n  if (!isAnyArray(points.x) || !isAnyArray(points.y)) {\n    throw new Error('Points must be an object of x and y arrays');\n  }\n  if (points.x.length !== points.y.length) {\n    throw new Error('The x and y arrays mush have the same length');\n  }\n}\n","/**\n * Returns the closest index of a `target` in an ordered array\n * @param {array} array\n * @param {number} target\n */\n\nexport function findClosestIndex(array, target) {\n  let low = 0;\n  let high = array.length - 1;\n  let middle = 0;\n  while (high - low > 1) {\n    middle = low + ((high - low) >> 1);\n    if (array[middle] < target) {\n      low = middle;\n    } else if (array[middle] > target) {\n      high = middle;\n    } else {\n      return middle;\n    }\n  }\n\n  if (low < array.length - 1) {\n    if (Math.abs(target - array[low]) < Math.abs(array[low + 1] - target)) {\n      return low;\n    } else {\n      return low + 1;\n    }\n  } else {\n    return low;\n  }\n}\n","import { findClosestIndex } from './findClosestIndex';\n\n/**\n * Returns an object with {fromIndex, toIndex} for a specific from / to\n * @param {array} x\n * @param {object} [options={}]\n * @param {number} [options.from] - First value for integration in the X scale\n * @param {number} [options.fromIndex=0] - First point for integration\n * @param {number} [options.to] - Last value for integration in the X scale\n * @param {number} [options.toIndex=x.length-1] - Last point for integration\n */\n\nexport function getFromToIndex(x, options = {}) {\n  let { fromIndex, toIndex, from, to } = options;\n\n  if (fromIndex === undefined) {\n    if (from !== undefined) {\n      fromIndex = findClosestIndex(x, from);\n    } else {\n      fromIndex = 0;\n    }\n  }\n  if (toIndex === undefined) {\n    if (to !== undefined) {\n      toIndex = findClosestIndex(x, to);\n    } else {\n      toIndex = x.length - 1;\n    }\n  }\n  return { fromIndex, toIndex };\n}\n","import { getFromToIndex } from '../x/getFromToIndex';\n\nimport { check } from './check';\n\n/**\n * In place modification of the 2 arrays to make X unique and sum the Y if X has the same value\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.from] - First value for integration in the X scale\n * @param {number} [options.fromIndex=0] - First point for integration\n * @param {number} [options.to] - Last value for integration in the X scale\n * @param {number} [options.toIndex=x.length-1] - Last point for integration\n * @return {number} Integration value on the specified range\n */\n\nexport function integration(points = {}, options = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 2) return 0;\n  const { fromIndex, toIndex } = getFromToIndex(x, options);\n  let integration = 0;\n  for (let i = fromIndex; i < toIndex; i++) {\n    integration += ((x[i + 1] - x[i]) * (y[i + 1] + y[i])) / 2;\n  }\n\n  return integration;\n}\n","import { getFromToIndex } from '../x/getFromToIndex';\n\nimport { check } from './check';\n/**\n * Generate a X / Y of the integral\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.from] - First value for integration in the X scale\n * @param {number} [options.fromIndex=0] - First point for integration\n * @param {number} [options.to] - Last value for integration in the X scale\n * @param {number} [options.toIndex=x.length-1] - Last point for integration\n * @param {boolean} [options.reverse=false] - Integrate from the larger value to the smallest value\n * @return {{x:[],y:[]}} An object with the integration function\n */\n\nexport function integral(points = {}, options = {}) {\n  const { reverse = false } = options;\n  check(points);\n  const { x, y } = points;\n  if (x.length < 2) return 0;\n\n  const { fromIndex, toIndex } = getFromToIndex(x, options);\n\n  let integration = 0;\n  let integral;\n  if (reverse) {\n    integral = { x: [x[toIndex]], y: [0] };\n    for (let i = toIndex; i > fromIndex; i--) {\n      integration += ((x[i] - x[i - 1]) * (y[i - 1] + y[i])) / 2;\n      integral.x.push(x[i - 1]);\n      integral.y.push(integration);\n    }\n    integral.x.reverse();\n    integral.y.reverse();\n  } else {\n    integral = { x: [x[fromIndex]], y: [0] };\n    for (let i = fromIndex; i < toIndex; i++) {\n      integration += ((x[i + 1] - x[i]) * (y[i + 1] + y[i])) / 2;\n      integral.x.push(x[i + 1]);\n      integral.y.push(integration);\n    }\n  }\n\n  return integral;\n}\n","import { getFromToIndex } from '../x/getFromToIndex';\n\nimport { check } from './check';\n/**\n * Finds the max value in a zone\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.from] - First value for integration in the X scale\n * @param {number} [options.fromIndex=0] - First point for integration\n * @param {number} [options.to] - Last value for integration in the X scale\n * @param {number} [options.toIndex=x.length-1] - Last point for integration\n * @return {number} Max y on the specified range\n */\n\nexport function maxY(points = {}, options = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 2) return 0;\n\n  const { fromIndex, toIndex } = getFromToIndex(x, options);\n\n  let maxY = y[fromIndex];\n  for (let i = fromIndex; i <= toIndex; i++) {\n    if (y[i] > maxY) maxY = y[i];\n  }\n\n  return maxY;\n}\n","import { getFromToIndex } from '../x/getFromToIndex';\n\nimport { check } from './check';\n/**\n * Finds the max y value in a range and return a {x,y} point\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.from] - First value for integration in the X scale\n * @param {number} [options.fromIndex=0] - First point for integration\n * @param {number} [options.to] - Last value for integration in the X scale\n * @param {number} [options.toIndex=x.length-1] - Last point for integration\n * @return {object}\n */\n\nexport function maxYPoint(points = {}, options = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 2) return 0;\n\n  const { fromIndex, toIndex } = getFromToIndex(x, options);\n\n  let current = { x: x[fromIndex], y: y[fromIndex] };\n  for (let i = fromIndex; i <= toIndex; i++) {\n    if (y[i] > current.y) current = { x: x[i], y: y[i] };\n  }\n\n  return current;\n}\n","import { getFromToIndex } from '../x/getFromToIndex';\n\nimport { check } from './check';\n/**\n * Finds the max y value in a range and return a {x,y} point\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.from] - First value for integration in the X scale\n * @param {number} [options.fromIndex=0] - First point for integration\n * @param {number} [options.to] - Last value for integration in the X scale\n * @param {number} [options.toIndex=x.length-1] - Last point for integration\n * @return {object}\n */\n\nexport function minYPoint(points = {}, options = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 2) return 0;\n\n  const { fromIndex, toIndex } = getFromToIndex(x, options);\n\n  let current = { x: x[fromIndex], y: y[fromIndex] };\n  for (let i = fromIndex; i <= toIndex; i++) {\n    if (y[i] < current.y) current = { x: x[i], y: y[i] };\n  }\n\n  return current;\n}\n","import { findClosestIndex } from '../x/findClosestIndex';\n\n/**\n * Reduce the number of points while keeping the same noise. Practical to\n * display many spectra as SVG\n * @param {array} x\n * @param {array} y\n * @param {object} [options={}]\n * @param {number} [from=x[0]]\n * @param {number} [to=x[x.length-1]]\n * @param {number} [nbPoints=4001] Number of points\n */\n\nexport function reduce(x, y, options = {}) {\n  let { from = x[0], to = x[x.length - 1], nbPoints = 4000 } = options;\n\n  let fromIndex = findClosestIndex(x, from);\n  let toIndex = findClosestIndex(x, to);\n\n  if (fromIndex > 0 && x[fromIndex] > from) fromIndex--;\n  if (toIndex < x.length - 1 && x[toIndex] < to) toIndex++;\n\n  if (toIndex - fromIndex < nbPoints) {\n    return {\n      x: x.slice(fromIndex, toIndex + 1),\n      y: y.slice(fromIndex, toIndex + 1),\n    };\n  }\n\n  let newX = [x[fromIndex]];\n  let newY = [y[fromIndex]];\n  let minY = Number.MAX_VALUE;\n  let maxY = Number.MIN_VALUE;\n  if (nbPoints % 2 === 0) {\n    nbPoints = nbPoints / 2 + 1;\n  } else {\n    nbPoints = (nbPoints - 1) / 2 + 1;\n  }\n\n  let slot = (x[toIndex] - x[fromIndex]) / (nbPoints - 1);\n  let currentX = x[fromIndex] + slot;\n  let first = true;\n  for (let i = fromIndex + 1; i <= toIndex; i++) {\n    if (first) {\n      minY = y[i];\n      maxY = y[i];\n      first = false;\n    } else {\n      if (y[i] < minY) minY = y[i];\n      if (y[i] > maxY) maxY = y[i];\n    }\n\n    if (x[i] >= currentX || i === toIndex) {\n      newX.push(currentX - slot / 2);\n      newY.push(minY);\n      newX.push(currentX);\n      newY.push(maxY);\n      currentX += slot;\n      first = true;\n    }\n  }\n\n  // we will need to make some kind of min / max because there are too many points\n  // we will always keep the first point and the last point\n\n  return { x: newX, y: newY };\n}\n","/**\n * Sort object of array, x has to be monotone.\n * @param {object} data Object of kind {x:[], re:[], im:[]}.\n * @return {SD}\n */\n\nexport function sortX(data) {\n  const { x, y } = data;\n\n  if (x.length !== y.length) {\n    throw TypeError('sortX: length of x and y must be identical');\n  }\n\n  if (x.length < 2 || x[0] < x[1]) return data;\n\n  return {\n    x: x.slice(0).reverse(),\n    y: y.slice(0).reverse(),\n  };\n}\n","import { findClosestIndex } from '../x/findClosestIndex';\n\nimport { check } from './check';\n\n/**\n * Find the closest minimum going down hill\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.target]\n * @param {number} [options.targetIndex=0]\n * @return {{x,y,xIndex}} An object with the x/y value\n */\n\nexport function minClosestYPoint(points, options = {}) {\n  check(points);\n  const { x, y } = points;\n\n  let { target, targetIndex } = options;\n\n  if (targetIndex === undefined) {\n    if (target !== undefined) {\n      targetIndex = findClosestIndex(x, target);\n    } else {\n      targetIndex = 0;\n    }\n  }\n\n  let previousIndex = Number.MIN_SAFE_INTEGER;\n  let currentIndex = targetIndex;\n\n  let minY = y[targetIndex];\n\n  while (currentIndex !== previousIndex) {\n    previousIndex = currentIndex;\n    if (currentIndex > 0 && y[currentIndex - 1] < minY) {\n      currentIndex--;\n    } else if (currentIndex < x.length - 1 && y[currentIndex + 1] < minY) {\n      currentIndex++;\n    }\n    minY = y[currentIndex];\n  }\n  return {\n    x: x[currentIndex],\n    y: y[currentIndex],\n    index: currentIndex,\n  };\n}\n","import { findClosestIndex } from '../x/findClosestIndex';\n\nimport { check } from './check';\n\n/**\n * Find the closest maximum going up hill\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.target]\n * @param {number} [options.targetIndex=0]\n * @return {{x,y,xIndex}} An object with the x/y value\n */\n\nexport function maxClosestYPoint(points, options = {}) {\n  check(points);\n  const { x, y } = points;\n\n  let { target, targetIndex } = options;\n\n  if (targetIndex === undefined) {\n    if (target !== undefined) {\n      targetIndex = findClosestIndex(x, target);\n    } else {\n      targetIndex = 0;\n    }\n  }\n\n  let previousIndex = Number.MIN_SAFE_INTEGER;\n  let currentIndex = targetIndex;\n\n  let maxY = y[targetIndex];\n\n  while (currentIndex !== previousIndex) {\n    previousIndex = currentIndex;\n    if (currentIndex > 0 && y[currentIndex - 1] > maxY) {\n      currentIndex--;\n    } else if (currentIndex < x.length - 1 && y[currentIndex + 1] > maxY) {\n      currentIndex++;\n    }\n    maxY = y[currentIndex];\n  }\n  return {\n    x: x[currentIndex],\n    y: y[currentIndex],\n    index: currentIndex,\n  };\n}\n","import { findClosestIndex } from './findClosestIndex';\n\n/**\n *  Returns the targetIndex\n * @param {array} [x]\n * @param {object} [options={}]\n * @param {number} [options.target]\n * @param {number} [options.targetIndex=0]\n * @param {number}\n */\n\nexport function getTargetIndex(x, options = {}) {\n  let { target, targetIndex } = options;\n  if (targetIndex === undefined) {\n    if (target !== undefined) {\n      return findClosestIndex(x, target);\n    } else {\n      return 0;\n    }\n  }\n  return targetIndex;\n}\n","import { getTargetIndex } from '../x/getTargetIndex';\n\nimport { check } from './check';\n\nexport function realMinYPoint(points, options = {}) {\n  check(points);\n  const { x, y } = points;\n\n  const targetIndex = getTargetIndex(x, options);\n  // interpolation to a sin() function\n  if (\n    y[targetIndex - 1] < 0 &&\n    y[targetIndex + 1] < 0 &&\n    y[targetIndex] <= y[targetIndex - 1] &&\n    y[targetIndex] <= y[targetIndex + 1]\n  ) {\n    let alpha = 20 * Math.log10(-y[targetIndex - 1]);\n    let beta = 20 * Math.log10(-y[targetIndex]);\n    let gamma = 20 * Math.log10(-y[targetIndex + 1]);\n    let p = (0.5 * (alpha - gamma)) / (alpha - 2 * beta + gamma);\n    return {\n      x: x[targetIndex] + (x[targetIndex] - x[targetIndex - 1]) * p,\n      y: y[targetIndex] - 0.25 * (y[targetIndex - 1] - y[targetIndex + 1]) * p,\n      index: targetIndex,\n    };\n  } else {\n    return {\n      x: x[targetIndex],\n      y: y[targetIndex],\n      index: targetIndex,\n    };\n  }\n}\n","import { getTargetIndex } from '../x/getTargetIndex';\n\nimport { check } from './check';\n/**\n * Find the closest minimum going down hill\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.target]\n * @param {number} [options.targetIndex=0]\n * @return {{x,y,xIndex}} An object with the x/y value\n */\n\nexport function realMaxYPoint(points, options = {}) {\n  check(points);\n  const { x, y } = points;\n  const targetIndex = getTargetIndex(x, options);\n  // interpolation to a sin() function\n  if (\n    y[targetIndex - 1] > 0 &&\n    y[targetIndex + 1] > 0 &&\n    y[targetIndex] >= y[targetIndex - 1] &&\n    y[targetIndex] >= y[targetIndex + 1]\n  ) {\n    let alpha = 20 * Math.log10(y[targetIndex - 1]);\n    let beta = 20 * Math.log10(y[targetIndex]);\n    let gamma = 20 * Math.log10(y[targetIndex + 1]);\n    let p = (0.5 * (alpha - gamma)) / (alpha - 2 * beta + gamma);\n    return {\n      x: x[targetIndex] + (x[targetIndex] - x[targetIndex - 1]) * p,\n      y: y[targetIndex] - 0.25 * (y[targetIndex - 1] - y[targetIndex + 1]) * p,\n      index: targetIndex,\n    };\n  } else {\n    return {\n      x: x[targetIndex],\n      y: y[targetIndex],\n      index: targetIndex,\n    };\n  }\n}\n","import { check } from './check';\n/**\n * Finds all the max values\n * If the values are equal the middle\n * of the equal part will be the position of the signal!\n *\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @return {Array} Array of points\n */\n\nexport function maximaY(points = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 3) return [];\n  let maxima = [];\n  let startEqualIndex = -1;\n  for (let i = 1; i < x.length - 1; i++) {\n    if (y[i - 1] < y[i] && y[i + 1] < y[i]) {\n      maxima.push({ x: x[i], y: y[i], index: i });\n    } else if (y[i - 1] < y[i] && y[i + 1] === y[i]) {\n      startEqualIndex = i;\n    } else if (y[i - 1] === y[i] && y[i + 1] < y[i]) {\n      let index = ((i + startEqualIndex) / 2) >> 0;\n      maxima.push({ x: x[index], y: y[index], index });\n    }\n  }\n  return maxima;\n}\n","import { check } from './check';\n/**\n * Finds all the min values\n * If the values are equal the middle\n * of the equal part will be the position of the signal!\n *\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @return {Array} Array of points\n */\n\nexport function minimaY(points = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 3) return [];\n  let maxima = [];\n  let startEqualIndex = -1;\n  for (let i = 1; i < x.length - 1; i++) {\n    if (y[i - 1] > y[i] && y[i + 1] > y[i]) {\n      maxima.push({ x: x[i], y: y[i], index: i });\n    } else if (y[i - 1] > y[i] && y[i + 1] === y[i]) {\n      startEqualIndex = i;\n    } else if (y[i - 1] === y[i] && y[i + 1] > y[i]) {\n      let index = ((i + startEqualIndex) / 2) >> 0;\n      maxima.push({ x: x[index], y: y[index], index });\n    }\n  }\n  return maxima;\n}\n","import { findClosestIndex } from '../x/findClosestIndex';\n\nimport { check } from './check';\n\n/**\n * Returns an information about a signal\n *\n * We expect ordered data and equidistant X axis\n * You can use the method helper if required:\n * ML.ArrayXY.uniqueX\n * ML.ArrayXY.sortX\n * ML.ArrayXY.equallySpaced\n *\n * @param {object} [points={}] - Object of points contains property x (an ordered increasing array) and y (an array)\n * @param {object} [options={}]\n * @param {number} [options.target]\n * @param {number} [options.targetIndex]\n * @return {object} Information about signal\n */\n\nexport function peakInfo(points = {}, options = {}) {\n  check(points);\n  const { x, y } = points;\n  if (x.length < 3) return undefined;\n  let { targetIndex, target } = options;\n  if (targetIndex === undefined) {\n    if (target !== undefined) {\n      targetIndex = findClosestIndex(x, target);\n    }\n  }\n\n  if (targetIndex === undefined) {\n    throw new Error('peakInfo: need to specify target or targetIndex');\n  }\n\n  let i = targetIndex;\n  let currentDiff = y[i] - y[i + 1];\n\n  let multiplier = currentDiff < 0 ? -1 : 1;\n  currentDiff *= multiplier;\n  while (i < x.length - 1) {\n    i++;\n    let newDiff = (y[i] - y[i + 1]) * multiplier;\n    if (newDiff < currentDiff) break;\n    currentDiff = newDiff;\n  }\n  let after = { x: x[i], y: y[i] };\n\n  i = targetIndex;\n  currentDiff = (y[i] - y[i - 1]) * multiplier;\n  while (i > 1) {\n    i--;\n    let newDiff = (y[i] - y[i - 1]) * multiplier;\n    if (newDiff < currentDiff) break;\n    currentDiff = newDiff;\n  }\n  let before = { x: x[i], y: y[i] };\n\n  return {\n    inflectionBefore: before,\n    inflectionAfter: after,\n    extrema: { x: x[targetIndex], y: y[targetIndex] },\n    inflectionMiddle: {\n      x: (before.x + after.x) / 2,\n      y: (before.y + after.y) / 2,\n    },\n    width: Math.abs(before.x - after.x),\n  };\n}\n","import { check } from './check';\nimport { integration } from './integration';\nimport { integral } from './integral';\nimport { maxY } from './maxY';\nimport { maxYPoint } from './maxYPoint';\nimport { minYPoint } from './minYPoint';\nimport { reduce } from './reduce';\nimport { sortX } from './sortX';\nimport { minClosestYPoint } from './minClosestYPoint';\nimport { maxClosestYPoint } from './maxClosestYPoint';\nimport { realMinYPoint } from './realMinYPoint';\nimport { realMaxYPoint } from './realMaxYPoint';\nimport { maximaY } from './maximaY';\nimport { minimaY } from './minimaY';\nimport { peakInfo } from './peakInfo';\n\nexport const XY = {\n  check,\n  integral,\n  integration,\n  maxY,\n  maximaY,\n  maxYPoint,\n  minimaY,\n  minYPoint,\n  reduce,\n  sortX,\n  minClosestYPoint,\n  maxClosestYPoint,\n  realMaxYPoint,\n  realMinYPoint,\n  peakInfo,\n};\n","/**\n * This function make a zero filling to re and im part.\n * @param {object} data Object of kind {x:[], re:[], im:[]}.\n * @param {number} zeroFilling - final number of points\n * @return {SD}\n */\nexport function zeroFilling(data, zeroFilling) {\n  let length = data.x.length;\n  if (zeroFilling === 0 || length === zeroFilling) return data;\n\n  if (length > zeroFilling) {\n    return {\n      x: data.x.slice(0, zeroFilling),\n      re: data.re.slice(0, zeroFilling),\n      im: data.im.slice(0, zeroFilling),\n    };\n  }\n\n  const x = data.x;\n  const re = data.re;\n  const im = data.im;\n\n  const newX = new Float64Array(zeroFilling);\n  const newRE = new Float64Array(zeroFilling);\n  const newIM = new Float64Array(zeroFilling);\n\n  for (let i = 0; i < length; i++) {\n    newX[i] = x[i];\n    newRE[i] = re[i];\n    newIM[i] = im[i];\n  }\n  const deltaX = (x[x.length - 1] - x[0]) / (length - 1);\n  for (let i = length; i < zeroFilling; i++) {\n    newX[i] = newX[i - 1] + deltaX;\n  }\n\n  return {\n    x: newX,\n    re: newRE,\n    im: newIM,\n  };\n}\n","/**\n * Sort object of array, x has to be monotone.\n * @param {object} data Object of kind {x:[], re:[], im:[]}.\n * @return {SD}\n */\n\nexport function sortX(data) {\n  const { x, re, im } = data;\n\n  if (x.length !== re.length || x.length !== im.length) {\n    throw TypeError('sortX: length of x, re and im must be identical');\n  }\n\n  if (x.length < 2 || x[0] < x[1]) return data;\n\n  return {\n    x: x.slice(0).reverse(),\n    re: re.slice(0).reverse(),\n    im: im.slice(0).reverse(),\n  };\n}\n","import { zeroFilling } from './zeroFilling';\nimport { sortX } from './sortX';\n\nexport const XReIm = {\n  zeroFilling,\n  sortX,\n};\n","/**\n * Calculate absolute value of a spectrum\n * @param {object} reim - An object of kind {re:[], im:[]}\n * @return {Float64Array}\n */\nexport function absolute(data) {\n  const length = data.re.length;\n  const re = data.re;\n  const im = data.im;\n  const newArray = new Float64Array(length);\n  for (let i = 0; i < length; i++) {\n    newArray[i] = Math.sqrt(re[i] ** 2 + im[i] ** 2);\n  }\n\n  return newArray;\n}\n","/**\n * Phase correction filter\n * @param {object} reim - An object of kind {re:[], im:[]}\n * @param {number} [phi0 = 0] - value\n * @param {number} [phi1 = 0] - value\n * @return {object} returns a new object {re:[], im:[]}\n */\nexport function phaseCorrection(data, phi0, phi1) {\n  phi0 = Number.isFinite(phi0) ? phi0 : 0;\n  phi1 = Number.isFinite(phi1) ? phi1 : 0;\n\n  const re = data.re.slice(0);\n  const im = data.im.slice(0);\n  const length = data.re.length;\n\n  const delta = phi1 / length;\n  const alpha = 2 * Math.pow(Math.sin(delta / 2), 2);\n  const beta = Math.sin(delta);\n  let cosTheta = Math.cos(phi0);\n  let sinTheta = Math.sin(phi0);\n\n  const newRe = new Float64Array(length);\n  const newIm = new Float64Array(length);\n  for (let i = 0; i < length; i++) {\n    newRe[i] = re[i] * cosTheta - im[i] * sinTheta;\n    newIm[i] = re[i] * sinTheta + im[i] * cosTheta;\n    // calculate angles i+1 from i\n    cosTheta = cosTheta - (alpha * cosTheta + beta * sinTheta);\n    sinTheta = sinTheta - (alpha * sinTheta - beta * cosTheta);\n  }\n\n  return { re: newRe, im: newIm };\n}\n","import { absolute } from './absolute';\nimport { phaseCorrection } from './phaseCorrection';\n\nexport const ReIm = {\n  absolute,\n  phaseCorrection,\n};\n","/**\n\n/**\n * This function add the first array by the second array or a constant value to each element of the first array\n * @param {Array} array1 - the array that will be rotated\n * @param {Array|Number} array2\n * @return {Array}\n */\nexport function add(array1, array2) {\n  let isConstant = false;\n  let constant;\n  if (Array.isArray(array2)) {\n    if (array1.length !== array2.length) {\n      throw new Error('sub: size of array1 and array2 must be identical');\n    }\n  } else {\n    isConstant = true;\n    constant = Number(array2);\n  }\n\n  let array3 = new Array(array1.length);\n  if (isConstant) {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] + constant;\n    }\n  } else {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] + array2[i];\n    }\n  }\n\n  return array3;\n}\n","/**\n * This function subtract the first array by the second array or a constant value from each element of the first array\n * @param {Array} array1 - the array that will be rotated\n * @return {object}\n */\nexport function boxPlot(array) {\n  array = array.slice(0).sort((a, b) => a - b);\n  if (array.length < 5) {\n    throw Error(\n      'boxPlot: can not calculate info if array contains less than 3 elements',\n    );\n  }\n  let info = {\n    Q1: 0.0,\n    Q2: 0.0,\n    Q3: 0.0,\n    min: array[0],\n    max: array[array.length - 1],\n  };\n  let q1max, q3min;\n  if (array.length % 2 === 1) {\n    // odd\n    let middle = (array.length - 1) / 2;\n    info.Q2 = array[middle];\n    q1max = middle - 1;\n    q3min = middle + 1;\n  } else {\n    // even\n    q3min = array.length / 2;\n    q1max = q3min - 1;\n    info.Q2 = (array[q1max] + array[q3min]) / 2;\n  }\n  if (q1max % 2 === 0) {\n    info.Q1 = array[q1max / 2];\n    info.Q3 = array[(array.length + q3min - 1) / 2];\n  } else {\n    info.Q1 = (array[(q1max + 1) / 2] + array[(q1max - 1) / 2]) / 2;\n    let middleOver = (array.length + q3min) / 2;\n    info.Q3 = (array[middleOver] + array[middleOver - 1]) / 2;\n  }\n  return info;\n}\n","/**\n\n/**\n * This function divide the first array by the second array or a constant value to each element of the first array\n * @param {Array} array1 - the array that will be rotated\n * @param {Array|Number} array2\n * @return {Array}\n */\nexport function divide(array1, array2) {\n  let isConstant = false;\n  let constant;\n  if (Array.isArray(array2)) {\n    if (array1.length !== array2.length) {\n      throw new Error('sub: size of array1 and array2 must be identical');\n    }\n  } else {\n    isConstant = true;\n    constant = Number(array2);\n  }\n\n  let array3 = new Array(array1.length);\n  if (isConstant) {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] / constant;\n    }\n  } else {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] / array2[i];\n    }\n  }\n\n  return array3;\n}\n","/**\n\n/**\n * This function multiply the first array by the second array or a constant value to each element of the first array\n * @param {Array} array1 - the array that will be rotated\n * @param {Array|Number} array2\n * @return {Array}\n */\nexport function multiply(array1, array2) {\n  let isConstant = false;\n  let constant;\n  if (Array.isArray(array2)) {\n    if (array1.length !== array2.length) {\n      throw new Error('sub: size of array1 and array2 must be identical');\n    }\n  } else {\n    isConstant = true;\n    constant = Number(array2);\n  }\n\n  let array3 = new Array(array1.length);\n  if (isConstant) {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] * constant;\n    }\n  } else {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] * array2[i];\n    }\n  }\n\n  return array3;\n}\n","/**\n * This function performs a circular shift to a new array\n * Positive values of shifts will shift to the right and negative values will do to the left\n * @example rotate([1,2,3,4],1) -> [4,1,2,3]\n * @example rotate([1,2,3,4],-1) -> [2,3,4,1]\n * @param {Array} array - the array that will be rotated\n * @param {number} shift\n * @return {Array}\n */\nexport function rotate(array, shift) {\n  shift = shift % array.length;\n  if (shift < 0) shift += array.length;\n  return array\n    .slice(array.length - shift)\n    .concat(array.slice(0, array.length - shift));\n}\n","/**\n * This function subtract the first array by the second array or a constant value from each element of the first array\n * @param {Array} array1 - the array that will be rotated\n * @param {Array|Number} array2\n * @return {Array}\n */\nexport function subtract(array1, array2) {\n  let isConstant = false;\n  let constant;\n  if (Array.isArray(array2)) {\n    if (array1.length !== array2.length) {\n      throw new Error('sub: size of array1 and array2 must be identical');\n    }\n  } else {\n    isConstant = true;\n    constant = Number(array2);\n  }\n\n  let array3 = new Array(array1.length);\n  if (isConstant) {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] - constant;\n    }\n  } else {\n    for (let i = 0; i < array1.length; i++) {\n      array3[i] = array1[i] - array2[i];\n    }\n  }\n\n  return array3;\n}\n","/**\n\n/**\n * Calculates the correlation between 2 vectors\n * https://en.wikipedia.org/wiki/Correlation_and_dependence\n *\n * @param {Array} [A] - the array that will be rotated\n * @param {Array} [B]\n * @return {Array}\n */\nexport function correlation(A, B) {\n  let n = A.length;\n  let sumA = 0;\n  let sumA2 = 0;\n  let sumB = 0;\n  let sumB2 = 0;\n  let sumAB = 0;\n  for (let i = 0; i < n; i++) {\n    let a = A[i];\n    let b = B[i];\n    sumA += a;\n    sumA2 += a ** 2;\n    sumB += b;\n    sumB2 += b ** 2;\n    sumAB += a * b;\n  }\n  return (\n    (n * sumAB - sumA * sumB) /\n    (Math.sqrt(n * sumA2 - sumA ** 2) * Math.sqrt(n * sumB2 - sumB ** 2))\n  );\n}\n","import { add } from './add';\nimport { boxPlot } from './boxPlot';\nimport { divide } from './divide';\nimport { findClosestIndex } from './findClosestIndex';\nimport { getTargetIndex } from './getTargetIndex';\nimport { multiply } from './multiply';\nimport { rotate } from './rotate';\nimport { subtract } from './subtract';\nimport { correlation } from './correlation';\n\nexport const X = {\n  add,\n  boxPlot,\n  divide,\n  findClosestIndex,\n  getTargetIndex,\n  multiply,\n  rotate,\n  subtract,\n  correlation,\n};\n","export { XY } from './xy/index.js';\nexport { XReIm } from './xreim/index.js';\nexport { ReIm } from './reim/index.js';\nexport { X } from './x/index.js';\n","import isArray from 'is-any-array';\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\n/**\n * Fill an array with sequential numbers\n * @param {Array<number>} [input] - optional destination array (if not provided a new array will be created)\n * @param {object} [options={}]\n * @param {number} [options.from=0] - first value in the array\n * @param {number} [options.to=10] - last value in the array\n * @param {number} [options.size=input.length] - size of the array (if not provided calculated from step)\n * @param {number} [options.step] - if not provided calculated from size\n * @return {Array<number>}\n */\n\nfunction sequentialFill() {\n  var input = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  if (_typeof(input) === 'object' && !isArray(input)) {\n    options = input;\n    input = [];\n  }\n\n  if (!isArray(input)) {\n    throw new TypeError('input must be an array');\n  }\n\n  var _options = options,\n      _options$from = _options.from,\n      from = _options$from === void 0 ? 0 : _options$from,\n      _options$to = _options.to,\n      to = _options$to === void 0 ? 10 : _options$to,\n      _options$size = _options.size,\n      size = _options$size === void 0 ? input.length : _options$size,\n      step = _options.step;\n\n  if (size && step) {\n    throw new Error('step is defined by the array size');\n  }\n\n  if (!size) {\n    if (step) {\n      size = Math.floor((to - from) / step) + 1;\n    } else {\n      size = to - from + 1;\n    }\n  }\n\n  if (!step && size) {\n    step = (to - from) / (size - 1);\n  }\n\n  if (Array.isArray(input)) {\n    input.length = 0; // only works with normal array\n\n    for (var i = 0; i < size; i++) {\n      input.push(from);\n      from += step;\n    }\n  } else {\n    if (input.length !== size) {\n      throw new Error('sequentialFill typed array must have the correct length');\n    }\n\n    for (var _i = 0; _i < size; _i++) {\n      input[_i] = from;\n      from += step;\n    }\n  }\n\n  return input;\n}\n\nexport default sequentialFill;\n","/**\n * Function that calculates the integral of the line between two\n * x-coordinates, given the slope and intercept of the line.\n * @param {number} x0\n * @param {number} x1\n * @param {number} slope\n * @param {number} intercept\n * @return {number} integral value.\n */\nexport default function integral(x0, x1, slope, intercept) {\n  return (\n    0.5 * slope * x1 * x1 +\n    intercept * x1 -\n    (0.5 * slope * x0 * x0 + intercept * x0)\n  );\n}\n","import integral from './integral';\n\n/**\n * function that retrieves the getEquallySpacedData with the variant \"smooth\"\n *\n * @param {Array<number>} x\n * @param {Array<number>} y\n * @param {number} from - Initial point\n * @param {number} to - Final point\n * @param {number} numberOfPoints\n * @return {Array} - Array of y's equally spaced with the variant \"smooth\"\n */\nexport default function equallySpacedSmooth(x, y, from, to, numberOfPoints) {\n  var xLength = x.length;\n\n  var step = (to - from) / (numberOfPoints - 1);\n  var halfStep = step / 2;\n\n  var output = new Array(numberOfPoints);\n\n  var initialOriginalStep = x[1] - x[0];\n  var lastOriginalStep = x[xLength - 1] - x[xLength - 2];\n\n  // Init main variables\n  var min = from - halfStep;\n  var max = from + halfStep;\n\n  var previousX = Number.MIN_VALUE;\n  var previousY = 0;\n  var nextX = x[0] - initialOriginalStep;\n  var nextY = 0;\n\n  var currentValue = 0;\n  var slope = 0;\n  var intercept = 0;\n  var sumAtMin = 0;\n  var sumAtMax = 0;\n\n  var i = 0; // index of input\n  var j = 0; // index of output\n\n  function getSlope(x0, y0, x1, y1) {\n    return (y1 - y0) / (x1 - x0);\n  }\n\n  main: while (true) {\n    if (previousX <= min && min <= nextX) {\n      add = integral(0, min - previousX, slope, previousY);\n      sumAtMin = currentValue + add;\n    }\n\n    while (nextX - max >= 0) {\n      // no overlap with original point, just consume current value\n      var add = integral(0, max - previousX, slope, previousY);\n      sumAtMax = currentValue + add;\n\n      output[j++] = (sumAtMax - sumAtMin) / step;\n\n      if (j === numberOfPoints) {\n        break main;\n      }\n\n      min = max;\n      max += step;\n      sumAtMin = sumAtMax;\n    }\n\n    currentValue += integral(previousX, nextX, slope, intercept);\n\n    previousX = nextX;\n    previousY = nextY;\n\n    if (i < xLength) {\n      nextX = x[i];\n      nextY = y[i];\n      i++;\n    } else if (i === xLength) {\n      nextX += lastOriginalStep;\n      nextY = 0;\n    }\n\n    slope = getSlope(previousX, previousY, nextX, nextY);\n    intercept = -slope * previousX + previousY;\n  }\n\n  return output;\n}\n","/**\n * function that retrieves the getEquallySpacedData with the variant \"slot\"\n *\n * @param {Array<number>} x\n * @param {Array<number>} y\n * @param {number} from - Initial point\n * @param {number} to - Final point\n * @param {number} numberOfPoints\n * @return {Array} - Array of y's equally spaced with the variant \"slot\"\n */\nexport default function equallySpacedSlot(x, y, from, to, numberOfPoints) {\n  var xLength = x.length;\n\n  var step = (to - from) / (numberOfPoints - 1);\n  var halfStep = step / 2;\n  var lastStep = x[x.length - 1] - x[x.length - 2];\n\n  var start = from - halfStep;\n  var output = new Array(numberOfPoints);\n\n  // Init main variables\n  var min = start;\n  var max = start + step;\n\n  var previousX = -Number.MAX_VALUE;\n  var previousY = 0;\n  var nextX = x[0];\n  var nextY = y[0];\n  var frontOutsideSpectra = 0;\n  var backOutsideSpectra = true;\n\n  var currentValue = 0;\n\n  // for slot algorithm\n  var currentPoints = 0;\n\n  var i = 1; // index of input\n  var j = 0; // index of output\n\n  main: while (true) {\n    if (previousX >= nextX) throw new Error('x must be an increasing serie');\n    while (previousX - max > 0) {\n      // no overlap with original point, just consume current value\n      if (backOutsideSpectra) {\n        currentPoints++;\n        backOutsideSpectra = false;\n      }\n\n      output[j] = currentPoints <= 0 ? 0 : currentValue / currentPoints;\n      j++;\n\n      if (j === numberOfPoints) {\n        break main;\n      }\n\n      min = max;\n      max += step;\n      currentValue = 0;\n      currentPoints = 0;\n    }\n\n    if (previousX > min) {\n      currentValue += previousY;\n      currentPoints++;\n    }\n\n    if (previousX === -Number.MAX_VALUE || frontOutsideSpectra > 1) {\n      currentPoints--;\n    }\n\n    previousX = nextX;\n    previousY = nextY;\n\n    if (i < xLength) {\n      nextX = x[i];\n      nextY = y[i];\n      i++;\n    } else {\n      nextX += lastStep;\n      nextY = 0;\n      frontOutsideSpectra++;\n    }\n  }\n\n  return output;\n}\n","export default function getZones(from, to, numberOfPoints, exclusions = []) {\n  if (from > to) {\n    [from, to] = [to, from];\n  }\n\n  // in exclusions from and to have to be defined\n  exclusions = exclusions.filter(\n    (exclusion) => exclusion.from !== undefined && exclusion.to !== undefined\n  );\n\n  exclusions = JSON.parse(JSON.stringify(exclusions));\n  // we ensure that from before to\n  exclusions.forEach((exclusion) => {\n    if (exclusion.from > exclusion.to) {\n      [exclusion.to, exclusion.from] = [exclusion.from, exclusion.to];\n    }\n  });\n\n  exclusions.sort((a, b) => a.from - b.from);\n\n  // we will rework the exclusions in order to remove overlap and outside range (from / to)\n  exclusions.forEach((exclusion) => {\n    if (exclusion.from < from) exclusion.from = from;\n    if (exclusion.to > to) exclusion.to = to;\n  });\n  for (let i = 0; i < exclusions.length - 1; i++) {\n    if (exclusions[i].to > exclusions[i + 1].from) {\n      exclusions[i].to = exclusions[i + 1].from;\n    }\n  }\n  exclusions = exclusions.filter((exclusion) => exclusion.from < exclusion.to);\n\n  if (!exclusions || exclusions.length === 0) {\n    return [{ from, to, numberOfPoints }];\n  }\n\n  // need to deal with overlapping exclusions and out of bound exclusions\n\n  let toRemove = exclusions.reduce(\n    (previous, exclusion) => (previous += exclusion.to - exclusion.from),\n    0\n  );\n  let total = to - from;\n  let unitsPerPoint = (total - toRemove) / numberOfPoints;\n  let zones = [];\n  let currentFrom = from;\n  let totalPoints = 0;\n  for (let exclusion of exclusions) {\n    let currentNbPoints = Math.round(\n      (exclusion.from - currentFrom) / unitsPerPoint\n    );\n    totalPoints += currentNbPoints;\n    if (currentNbPoints > 0) {\n      zones.push({\n        from: currentFrom,\n        to: exclusion.from,\n        numberOfPoints: currentNbPoints\n      });\n    }\n\n    currentFrom = exclusion.to;\n  }\n  if (numberOfPoints - totalPoints > 0) {\n    zones.push({\n      from: currentFrom,\n      to: to,\n      numberOfPoints: numberOfPoints - totalPoints\n    });\n  }\n\n  return zones;\n}\n","import sequentialFill from 'ml-array-sequential-fill';\n\nimport equallySpacedSmooth from './equallySpacedSmooth';\nimport equallySpacedSlot from './equallySpacedSlot';\nimport getZones from './getZones';\n\n/**\n * Function that returns a Number array of equally spaced numberOfPoints\n * containing a representation of intensities of the spectra arguments x\n * and y.\n *\n * The options parameter contains an object in the following form:\n * from: starting point\n * to: last point\n * numberOfPoints: number of points between from and to\n * variant: \"slot\" or \"smooth\" - smooth is the default option\n *\n * The slot variant consist that each point in the new array is calculated\n * averaging the existing points between the slot that belongs to the current\n * value. The smooth variant is the same but takes the integral of the range\n * of the slot and divide by the step size between two points in the new array.\n *\n * @param {object} [arrayXY={}] - object containing 2 properties x and y (both an array)\n * @param {object} [options={}]\n * @param {number} [options.from=x[0]]\n * @param {number} [options.to=x[x.length-1]]\n * @param {string} [options.variant='smooth']\n * @param {number} [options.numberOfPoints=100]\n * @param {Array} [options.exclusions=[]] array of from / to that should be skipped for the generation of the points\n * @return {object<x: Array, y:Array>} new object with x / y array with the equally spaced data.\n */\n\nexport default function equallySpaced(arrayXY = {}, options = {}) {\n  let { x, y } = arrayXY;\n  let xLength = x.length;\n  let reverse = false;\n  if (x.length > 1 && x[0] > x[1]) {\n    x = x.slice().reverse();\n    y = y.slice().reverse();\n    reverse = true;\n  }\n\n  let {\n    from = x[0],\n    to = x[xLength - 1],\n    variant = 'smooth',\n    numberOfPoints = 100,\n    exclusions = []\n  } = options;\n\n  if (xLength !== y.length) {\n    throw new RangeError(\"the x and y vector doesn't have the same size.\");\n  }\n\n  if (typeof from !== 'number' || isNaN(from)) {\n    throw new RangeError(\"'from' option must be a number\");\n  }\n\n  if (typeof to !== 'number' || isNaN(to)) {\n    throw new RangeError(\"'to' option must be a number\");\n  }\n\n  if (typeof numberOfPoints !== 'number' || isNaN(numberOfPoints)) {\n    throw new RangeError(\"'numberOfPoints' option must be a number\");\n  }\n\n  let zones = getZones(from, to, numberOfPoints, exclusions);\n\n  let xResult = [];\n  let yResult = [];\n  for (let zone of zones) {\n    let zoneResult = processZone(\n      x,\n      y,\n      zone.from,\n      zone.to,\n      zone.numberOfPoints,\n      variant,\n      reverse\n    );\n    xResult.push(...zoneResult.x);\n    yResult.push(...zoneResult.y);\n  }\n\n  if (reverse) {\n    if (from < to) {\n      return { x: xResult.reverse(), y: yResult.reverse() };\n    } else {\n      return { x: xResult, y: yResult };\n    }\n  } else {\n    if (from < to) {\n      return { x: xResult, y: yResult };\n    } else {\n      return { x: xResult.reverse(), y: yResult.reverse() };\n    }\n  }\n}\n\nfunction processZone(x, y, from, to, numberOfPoints, variant) {\n  if (numberOfPoints < 1) {\n    throw new RangeError('the number of points must be at least 1');\n  }\n\n  var output =\n    variant === 'slot'\n      ? equallySpacedSlot(x, y, from, to, numberOfPoints)\n      : equallySpacedSmooth(x, y, from, to, numberOfPoints);\n\n  return {\n    x: sequentialFill({\n      from,\n      to,\n      size: numberOfPoints\n    }),\n    y: output\n  };\n}\n","export { default as maybeToPrecision } from './maybeToPrecision';\nexport { default as checkArrayLength } from './checkArrayLength';\n\nexport default class BaseRegression {\n  constructor() {\n    if (new.target === BaseRegression) {\n      throw new Error('BaseRegression must be subclassed');\n    }\n  }\n\n  predict(x) {\n    if (typeof x === 'number') {\n      return this._predict(x);\n    } else if (Array.isArray(x)) {\n      const y = [];\n      for (let i = 0; i < x.length; i++) {\n        y.push(this._predict(x[i]));\n      }\n      return y;\n    } else {\n      throw new TypeError('x must be a number or array');\n    }\n  }\n\n  _predict() {\n    throw new Error('_predict must be implemented');\n  }\n\n  train() {\n    // Do nothing for this package\n  }\n\n  toString() {\n    return '';\n  }\n\n  toLaTeX() {\n    return '';\n  }\n\n  /**\n   * Return the correlation coefficient of determination (r) and chi-square.\n   * @param {Array<number>} x\n   * @param {Array<number>} y\n   * @return {object}\n   */\n  score(x, y) {\n    if (!Array.isArray(x) || !Array.isArray(y) || x.length !== y.length) {\n      throw new Error('x and y must be arrays of the same length');\n    }\n\n    const n = x.length;\n    const y2 = new Array(n);\n    for (let i = 0; i < n; i++) {\n      y2[i] = this._predict(x[i]);\n    }\n\n    let xSum = 0;\n    let ySum = 0;\n    let chi2 = 0;\n    let rmsd = 0;\n    let xSquared = 0;\n    let ySquared = 0;\n    let xY = 0;\n    for (let i = 0; i < n; i++) {\n      xSum += y2[i];\n      ySum += y[i];\n      xSquared += y2[i] * y2[i];\n      ySquared += y[i] * y[i];\n      xY += y2[i] * y[i];\n      if (y[i] !== 0) {\n        chi2 += ((y[i] - y2[i]) * (y[i] - y2[i])) / y[i];\n      }\n      rmsd += (y[i] - y2[i]) * (y[i] - y2[i]);\n    }\n\n    const r =\n      (n * xY - xSum * ySum) /\n      Math.sqrt((n * xSquared - xSum * xSum) * (n * ySquared - ySum * ySum));\n\n    return {\n      r: r,\n      r2: r * r,\n      chi2: chi2,\n      rmsd: Math.sqrt(rmsd / n)\n    };\n  }\n}\n","export default function checkArraySize(x, y) {\n  if (!Array.isArray(x) || !Array.isArray(y)) {\n    throw new TypeError('x and y must be arrays');\n  }\n  if (x.length !== y.length) {\n    throw new RangeError('x and y arrays must have the same length');\n  }\n}\n","export default function maybeToPrecision(value, digits) {\n  if (value < 0) {\n    value = 0 - value;\n    if (typeof digits === 'number') {\n      return `- ${value.toPrecision(digits)}`;\n    } else {\n      return `- ${value.toString()}`;\n    }\n  } else {\n    if (typeof digits === 'number') {\n      return value.toPrecision(digits);\n    } else {\n      return value.toString();\n    }\n  }\n}\n","import BaseRegression, {\n  checkArrayLength,\n  maybeToPrecision\n} from 'ml-regression-base';\n\nexport default class SimpleLinearRegression extends BaseRegression {\n  constructor(x, y) {\n    super();\n    if (x === true) {\n      this.slope = y.slope;\n      this.intercept = y.intercept;\n      this.coefficients = [y.intercept, y.slope];\n    } else {\n      checkArrayLength(x, y);\n      regress(this, x, y);\n    }\n  }\n\n  toJSON() {\n    return {\n      name: 'simpleLinearRegression',\n      slope: this.slope,\n      intercept: this.intercept\n    };\n  }\n\n  _predict(x) {\n    return this.slope * x + this.intercept;\n  }\n\n  computeX(y) {\n    return (y - this.intercept) / this.slope;\n  }\n\n  toString(precision) {\n    let result = 'f(x) = ';\n    if (this.slope !== 0) {\n      const xFactor = maybeToPrecision(this.slope, precision);\n      result += `${xFactor === '1' ? '' : `${xFactor} * `}x`;\n      if (this.intercept !== 0) {\n        const absIntercept = Math.abs(this.intercept);\n        const operator = absIntercept === this.intercept ? '+' : '-';\n        result += ` ${operator} ${maybeToPrecision(absIntercept, precision)}`;\n      }\n    } else {\n      result += maybeToPrecision(this.intercept, precision);\n    }\n    return result;\n  }\n\n  toLaTeX(precision) {\n    return this.toString(precision);\n  }\n\n  static load(json) {\n    if (json.name !== 'simpleLinearRegression') {\n      throw new TypeError('not a SLR model');\n    }\n    return new SimpleLinearRegression(true, json);\n  }\n}\n\nfunction regress(slr, x, y) {\n  const n = x.length;\n  let xSum = 0;\n  let ySum = 0;\n\n  let xSquared = 0;\n  let xY = 0;\n\n  for (let i = 0; i < n; i++) {\n    xSum += x[i];\n    ySum += y[i];\n    xSquared += x[i] * x[i];\n    xY += x[i] * y[i];\n  }\n\n  const numerator = n * xY - xSum * ySum;\n  slr.slope = numerator / (n * xSquared - xSum * xSum);\n  slr.intercept = (1 / n) * ySum - slr.slope * (1 / n) * xSum;\n  slr.coefficients = [slr.intercept, slr.slope];\n}\n","import isArray from 'is-any-array';\n\n/**\n * Computes the minimum of the given values\n * @param {Array<number>} input\n * @return {number}\n */\n\nfunction min(input) {\n  if (!isArray(input)) {\n    throw new TypeError('input must be an array');\n  }\n\n  if (input.length === 0) {\n    throw new TypeError('input must not be empty');\n  }\n\n  var minValue = input[0];\n\n  for (var i = 1; i < input.length; i++) {\n    if (input[i] < minValue) minValue = input[i];\n  }\n\n  return minValue;\n}\n\nexport default min;\n","import max from 'ml-array-max';\nimport min from 'ml-array-min';\nimport isArray from 'is-any-array';\n\nfunction rescale(input) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  if (!isArray(input)) {\n    throw new TypeError('input must be an array');\n  } else if (input.length === 0) {\n    throw new TypeError('input must not be empty');\n  }\n\n  var output;\n\n  if (options.output !== undefined) {\n    if (!isArray(options.output)) {\n      throw new TypeError('output option must be an array if specified');\n    }\n\n    output = options.output;\n  } else {\n    output = new Array(input.length);\n  }\n\n  var currentMin = min(input);\n  var currentMax = max(input);\n\n  if (currentMin === currentMax) {\n    throw new RangeError('minimum and maximum input values are equal. Cannot rescale a constant array');\n  }\n\n  var _options$min = options.min,\n      minValue = _options$min === void 0 ? options.autoMinMax ? currentMin : 0 : _options$min,\n      _options$max = options.max,\n      maxValue = _options$max === void 0 ? options.autoMinMax ? currentMax : 1 : _options$max;\n\n  if (minValue >= maxValue) {\n    throw new RangeError('min option must be smaller than max option');\n  }\n\n  var factor = (maxValue - minValue) / (currentMax - currentMin);\n\n  for (var i = 0; i < input.length; i++) {\n    output[i] = (input[i] - currentMin) * factor + minValue;\n  }\n\n  return output;\n}\n\nexport default rescale;\n","export default function getZones(from, to, exclusions = []) {\n  if (from > to) {\n    [from, to] = [to, from];\n  }\n\n  // in exclusions from and to have to be defined\n  exclusions = exclusions.filter(\n    (exclusion) => exclusion.from !== undefined && exclusion.to !== undefined\n  );\n\n  exclusions = JSON.parse(JSON.stringify(exclusions));\n  // we ensure that from before to\n  exclusions.forEach((exclusion) => {\n    if (exclusion.from > exclusion.to) {\n      [exclusion.to, exclusion.from] = [exclusion.from, exclusion.to];\n    }\n  });\n\n  exclusions.sort((a, b) => a.from - b.from);\n\n  // we will rework the exclusions in order to remove overlap and outside range (from / to)\n  exclusions.forEach((exclusion) => {\n    if (exclusion.from < from) exclusion.from = from;\n    if (exclusion.to > to) exclusion.to = to;\n  });\n  for (let i = 0; i < exclusions.length - 1; i++) {\n    if (exclusions[i].to > exclusions[i + 1].from) {\n      exclusions[i].to = exclusions[i + 1].from;\n    }\n  }\n  exclusions = exclusions.filter((exclusion) => exclusion.from < exclusion.to);\n\n  if (!exclusions || exclusions.length === 0) {\n    return [{ from, to }];\n  }\n\n  let zones = [];\n  let currentFrom = from;\n  for (let exclusion of exclusions) {\n    if (currentFrom < exclusion.from) {\n      zones.push({\n        from: currentFrom,\n        to: exclusion.from\n      });\n    }\n\n    currentFrom = exclusion.to;\n  }\n  if (currentFrom < to) {\n    zones.push({\n      from: currentFrom,\n      to: to\n    });\n  }\n\n  return zones;\n}\n","import getZones from './getZones';\n\n/**\n * Filter an array x/y based on various criteria\n * x points are expected to be sorted\n *\n * @param {object} points\n * @param {object} [options={}]\n * @param {array} [options.from]\n * @param {array} [options.to]\n * @param {array} [options.exclusions=[]]\n * @return {{x: Array<number>, y: Array<number>}}\n */\n\nexport default function filterX(points, options = {}) {\n  const { x, y } = points;\n  const { from = x[0], to = x[x.length - 1], exclusions = [] } = options;\n\n  let zones = getZones(from, to, exclusions);\n\n\n  let currentZoneIndex = 0;\n  let newX = [];\n  let newY = [];\n  let position = 0;\n  while (position < x.length) {\n    if (\n      x[position] <= zones[currentZoneIndex].to &&\n      x[position] >= zones[currentZoneIndex].from\n    ) {\n      newX.push(x[position]);\n      newY.push(y[position]);\n    } else {\n      if (x[position] > zones[currentZoneIndex].to) {\n        currentZoneIndex++;\n        if (!zones[currentZoneIndex]) break;\n      }\n    }\n    position++;\n  }\n\n  return {\n    x: newX,\n    y: newY\n  };\n}\n","import isArray from 'is-any-array';\n\n/**\n * Computes the mean of the given values\n * @param {Array<number>} input\n * @return {number}\n */\n\nfunction sum(input) {\n  if (!isArray(input)) {\n    throw new TypeError('input must be an array');\n  }\n\n  if (input.length === 0) {\n    throw new TypeError('input must not be empty');\n  }\n\n  var sumValue = 0;\n\n  for (var i = 0; i < input.length; i++) {\n    sumValue += input[i];\n  }\n\n  return sumValue;\n}\n\nexport default sum;\n","import max from 'ml-array-max';\nimport sum from 'ml-array-sum';\n\n/**\n * Computes the norm of the given values\n * @param {Array<number>} input\n * @param {object} [options={}]\n * @param {string} [options.algorithm='absolute'] absolute, sum or max\n * @return {number}\n */\n\nfunction norm(input) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var _options$algorithm = options.algorithm,\n      algorithm = _options$algorithm === void 0 ? 'absolute' : _options$algorithm;\n\n  if (!Array.isArray(input)) {\n    throw new Error('input must be an array');\n  }\n\n  if (input.length === 0) {\n    throw new Error('input must not be empty');\n  }\n\n  switch (algorithm.toLowerCase()) {\n    case 'absolute':\n      {\n        var absoluteSumValue = absoluteSum(input);\n        if (absoluteSumValue === 0) return input.slice(0);\n        return input.map(function (element) {\n          return element / absoluteSumValue;\n        });\n      }\n\n    case 'max':\n      {\n        var maxValue = max(input);\n        if (maxValue === 0) return input.slice(0);\n        return input.map(function (element) {\n          return element / maxValue;\n        });\n      }\n\n    case 'sum':\n      {\n        var sumValue = sum(input);\n        if (sumValue === 0) return input.slice(0);\n        return input.map(function (element) {\n          return element / sumValue;\n        });\n      }\n\n    default:\n      throw new Error(\"norm: unknown algorithm: \".concat(algorithm));\n  }\n}\n\nfunction absoluteSum(input) {\n  var sumValue = 0;\n\n  for (var i = 0; i < input.length; i++) {\n    sumValue += Math.abs(input[i]);\n  }\n\n  return sumValue;\n}\n\nexport default norm;\n"],"sourceRoot":""}